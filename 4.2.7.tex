\documentclass[dvipdfmx]{jsarticle}
\setcounter{section}{2}
\setcounter{subsection}{6}
\usepackage{xr}
\externaldocument{4.2.6}
\input{macro}
\begin{document}
%\hypertarget{taylorux306eux5b9aux7406}{%
\subsection{Taylorの定理}%\label{taylorux306eux5b9aux7406}}
%\hypertarget{mux6b21ux5faeux5206}{%
\subsubsection{$m$次微分}%\label{mux6b21ux5faeux5206}}
\begin{thm}\label{4.2.7.1}
$\forall k \in \mathbb{N}$に対し、開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{k}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。次式のように関数$g$と
\begin{align*}
g:\mathbb{R} \rightarrow \mathbb{R}^{n};t \rightarrow \mathbf{x} + t\mathbf{h}
\end{align*}
その$n$次元数空間$\mathbb{R}^{n}$の2点$\mathbf{x}$、$\mathbf{x} + \mathbf{h}$を結ぶ線分$L$が与えられたとき、
\begin{align*}
L = \left\{ \mathbf{x} + t\mathbf{h} \in \mathbb{R}^{n} \middle| t \in [ 0,1] \right\}
\end{align*}
ここで、その実数$\left\| \mathbf{h} \right\|$が十分に小さければ、開集合の定義より$L \subseteq U$が成り立つことができる。$L \subseteq U$が成り立つとき、その合成関数$f \circ g$はその閉区間$[ 0,1]$上で$C^{k}$級で、$\forall m \in \varLambda_{k}\forall t \in [ 0,1]$に対し、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれると、その合成関数$f \circ g$の$m$次導関数$\partial^{m}(f \circ g)$は次式を満たす。
\begin{align*}
\partial^{m}(f \circ g)(t) = \sum_{\forall j \in \varLambda_{m}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{m}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)\prod_{j \in \varLambda_{m}} h_{i_{j}}}
\end{align*}
\end{thm}
\begin{dfn}
上の式はいわゆる$m$次同次多項式で、$\forall\mathbf{x} \in U$に対し、次式で与えられる式$\left( d^{m}f \right)_{\mathbf{x}}\left( \mathbf{h} \right)$、即ち、上の式の実数$t$を$t = 0$としたものをその関数$f$のその点$x$における$m$次微分などといい$d^{m}f$などとも書く。特に、$m = 1$のとき、$df$とも書く。
\begin{align*}
\left( d^{m}f \right)_{\mathbf{x}}\left( \mathbf{h} \right) = \sum_{\forall j \in \varLambda_{m}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{m}\cdots i_{2}i_{1}}f\left( \mathbf{x} \right)\prod_{j \in \varLambda_{m}} h_{i_{j}}}
\end{align*}
\end{dfn}\par
例えば、$d\mathbf{x} = \left( dx_{i} \right)_{i \in \varLambda_{n}}$とおかれれば、$m = 1$のとき、次のようになるし、
\begin{align*}
(df)_{\mathbf{a}}\left( d\mathbf{x} \right) &= \partial_{1}f\left( \mathbf{a} \right)dx_{1} + \partial_{2}f\left( \mathbf{a} \right)dx_{2} + \cdots + \partial_{n}f\left( \mathbf{a} \right)dx_{n}\\
&= \begin{pmatrix}
\partial_{1}f\left( \mathbf{a} \right) & \partial_{2}f\left( \mathbf{a} \right) & \cdots & \partial_{n}f\left( \mathbf{a} \right) \\
\end{pmatrix}\begin{pmatrix}
dx_{1} \\
dx_{2} \\
 \vdots \\
dx_{n} \\
\end{pmatrix}
\end{align*}
$m = 2$のとき、次のようになる。
\begin{align*}
\left( d^{2}f \right)_{\mathbf{a}}\left( d\mathbf{x} \right) &= \begin{matrix}
\  & \partial_{11}f\left( \mathbf{a} \right)dx_{1}dx_{1} & + & \partial_{12}f\left( \mathbf{a} \right)dx_{1}dx_{2} & + & \cdots & + & \partial_{1n}f\left( \mathbf{a} \right)dx_{1}dx_{n} \\
 + & \partial_{21}f\left( \mathbf{a} \right)dx_{2}dx_{1} & + & \partial_{22}f\left( \mathbf{a} \right)dx_{2}dx_{2} & + & \cdots & + & \partial_{2n}f\left( \mathbf{a} \right)dx_{2}dx_{n} \\
\  & \  & \  & \vdots & \  & \  & \  & \  \\
 + & \partial_{n1}f\left( \mathbf{a} \right)dx_{n}dx_{1} & + & \partial_{n2}f\left( \mathbf{a} \right)dx_{n}dx_{2} & + & \cdots & + & \partial_{nn}f\left( \mathbf{a} \right)dx_{n}dx_{n} \\
\end{matrix}\\
&= \begin{pmatrix}
dx_{1} & dx_{2} & \cdots & dx_{n} \\
\end{pmatrix}\begin{pmatrix}
\partial_{11}f\left( \mathbf{a} \right) & \partial_{21}f\left( \mathbf{a} \right) & \cdots & \partial_{n1}f\left( \mathbf{a} \right) \\
\partial_{12}f\left( \mathbf{a} \right) & \partial_{22}f\left( \mathbf{a} \right) & \cdots & \partial_{n2}f\left( \mathbf{a} \right) \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{1n}f\left( \mathbf{a} \right) & \partial_{2n}f\left( \mathbf{a} \right) & \cdots & \partial_{nn}f\left( \mathbf{a} \right) \\
\end{pmatrix}\begin{pmatrix}
dx_{1} \\
dx_{2} \\
 \vdots \\
dx_{n} \\
\end{pmatrix}
\end{align*}
\begin{proof}
$\forall k \in \mathbb{N}$に対し、開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{k}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。次式のように関数$g$と
\begin{align*}
g:\mathbb{R} \rightarrow \mathbb{R}^{n};t \rightarrow \mathbf{x} + t\mathbf{h}
\end{align*}
その$n$次元数空間$\mathbb{R}^{n}$の2点$\mathbf{x}$、$\mathbf{x} + \mathbf{h}$を結ぶ線分$L$が与えられ、
\begin{align*}
L = \left\{ \mathbf{x} + t\mathbf{h} \in \mathbb{R}^{n} \middle| t \in [ 0,1] \right\}
\end{align*}
$L \subseteq U$が成り立つとき、その集合$\mathbb{R}$は稠密順序集合であるので、次式のような線分$L'$が
\begin{align*}
L' = \left\{ \mathbf{x} + t\mathbf{h} \in \mathbb{R}^{n} \middle| t \in I_{\varepsilon} = ( - \varepsilon,1 + \varepsilon) \right\}
\end{align*}
$L' \subseteq U$を満たすような正の実数$\varepsilon$が存在し、さらに、その関数$g$はその開区間$I_{\varepsilon}$上で$C^{\infty}$級である。したがって、その合成関数$f \circ g$はその閉区間$[ 0,1]$上で$C^{k}$級である。\par
ここで$\forall t \in [ 0,1]$に対し、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれると、$m = 1$のとき、連鎖律より次式が成り立つ。
\begin{align*}
\partial(f \circ g)(t) &={}^{t}\left( \mathrm{grad}f \circ g \right)\partial g(t) ={}^{t}\mathrm{grad}f\left( g(t) \right)\mathbf{h}\\
&={}^{t}\left( \partial_{i}\left( \mathbf{x} + t\mathbf{h} \right) \right)_{i \in \varLambda_{n}}\left( h_{i} \right)_{i \in \varLambda_{n}} = \sum_{i_{1} \in \varLambda_{n}} {\partial_{i_{1}}\left( \mathbf{x} + t\mathbf{h} \right)h_{i_{1}}}
\end{align*}\par
$m = l$のとき、次式が成り立つと仮定しよう。
\begin{align*}
\partial^{l}(f \circ g)(t) = \sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)\prod_{j \in \varLambda_{l}} h_{i_{j}}}
\end{align*}\par
$m = l + 1$のとき、次のようになる。
\begin{align*}
\partial^{l + 1}(f \circ g)(t) &= \partial\partial^{l}(f \circ g)(t)\\
&= \partial\sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)\prod_{j \in \varLambda_{l}} h_{i_{j}}}\\
&= \sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {\partial\left( \partial_{i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right) \right)\prod_{j \in \varLambda_{l}} h_{i_{j}}}
\end{align*}
連鎖律よりしたがって、次のようになる。
\begin{align*}
\partial^{l + 1}(f \circ g)(t) &= \sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {{}^{t}\mathrm{grad}{\partial_{i_{l}\cdots i_{2}i_{1}}f}\left( \mathbf{x} + t\mathbf{h} \right)\partial g(t)\prod_{j \in \varLambda_{l}} h_{i_{j}}}\\
&= \sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {{}^{t}\left( \partial_{i_{l + 1}}\partial_{i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right) \right)_{i_{l + 1} \in \varLambda_{n}} \cdot \left( \frac{d}{dt}\left( x_{i_{l + 1}} + th_{i_{l + 1}} \right) \right)_{i_{l + 1} \in \varLambda_{n}}\prod_{j \in \varLambda_{l}} h_{i_{j}}}\\
&= \sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {{}^{t}\left( \partial_{i_{l + 1}i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right) \right)_{i_{l + 1} \in \varLambda_{n}}\left( h_{i_{l + 1}} \right)_{i_{l + 1} \in \varLambda_{n}}\prod_{j \in \varLambda_{l}} h_{i_{j}}}\\
&= \sum_{\forall j \in \varLambda_{l}\left[ i_{j} \in \varLambda_{n} \right]} {\sum_{i_{l + 1} \in \varLambda_{n}} {\partial_{i_{l + 1}i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)h_{i_{l + 1}}}\prod_{j \in \varLambda_{l}} h_{i_{j}}}\\
&= \sum_{\forall j \in \varLambda_{l + 1}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{l + 1}i_{l}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)\prod_{j \in \varLambda_{l + 1}} h_{i_{j}}}
\end{align*}\par
以上より数学的帰納法によって$\forall m \in \varLambda_{k}\forall t \in [ 0,1]$に対し、次式が得られた。
\begin{align*}
\partial^{m}(f \circ g)(t) = \sum_{\forall j \in \varLambda_{m}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{m}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)\prod_{j \in \varLambda_{m}} h_{i_{j}}}
\end{align*}
\end{proof}
%\hypertarget{taylorux306eux5b9aux7406-1}{%
\subsubsection{Taylorの定理}%\label{taylorux306eux5b9aux7406-1}}
\begin{thm}[多変数のTaylorの定理]\label{4.2.7.2}
$\forall k \in \mathbb{N}$に対し、開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{k}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。その$n$次元数空間$\mathbb{R}^{n}$の2点$\mathbf{x}$、$\mathbf{x} + \mathbf{h}$を結ぶ線分$L$が与えられ$L \subseteq U$が成り立つとき、次式が成り立つような実数$c$が開区間$(0,1)$に存在する。
\begin{align*}
f\left( \mathbf{x} + \mathbf{h} \right) = f\left( \mathbf{x} \right) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\left( d^{m}f \right)_{\mathbf{x}}\left( \mathbf{h} \right)} + \frac{1}{k!}\left( d^{k}f \right)_{\mathbf{x} + c\mathbf{h}}\left( \mathbf{h} \right)
\end{align*}
この定理を多変数のTaylorの定理という。
\end{thm}
\begin{dfn}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{\infty}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。その$n$次元数空間$\mathbb{R}^{n}$の2点$\mathbf{x}$、$\mathbf{x} + \mathbf{h}$を結ぶ線分$L$が与えられ$L \subseteq U$が成り立つとき、多変数のTaylorの定理における$c \in (0,1)$なる実数$c$を用いて次式が成り立つなら、
\begin{align*}
\lim_{k \rightarrow \infty}{\frac{1}{k!}\left( d^{k}f \right)_{\mathbf{x} + c\mathbf{h}}\left( \mathbf{h} \right)} = 0
\end{align*}
次式が得られる。
\begin{align*}
f\left( \mathbf{x} + \mathbf{h} \right) = f\left( \mathbf{x} \right) + \sum_{m \in \mathbb{N}} {\frac{1}{m!}\left( d^{m}f \right)_{\mathbf{x}}\left( \mathbf{h} \right)}
\end{align*}
この式をその関数$f$のその点$\mathbf{x}$のまわりの多変数Taylor展開などという。特に、$\mathbf{x} = \mathbf{0}$としたものをその関数$f$の多変数Maclaurin展開などという。このように、$\forall\mathbf{x} \in U$に対し、次式が成り立つとき、
\begin{align*}
\lim_{k \rightarrow \infty}{\frac{1}{k!}\left( d^{k}f \right)_{\mathbf{x} + c\mathbf{h}}\left( \mathbf{h} \right)} = 0
\end{align*}
即ち、多変数Taylor展開ができるとき、その関数$f$はその開集合$U$で$C^{\omega}$級である、解析的であるという。その開集合$U$で解析的であるような関数全体の集合を$C^{\omega}\left( U,\mathbb{R}^{n} \right)$と書くことがある。
\end{dfn}
\begin{proof}
$\forall k \in \mathbb{N}$に対し、開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{k}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。次式のように関数$g$と
\begin{align*}
g:\mathbb{R} \rightarrow \mathbb{R}^{n};t \rightarrow \mathbf{x} + t\mathbf{h}
\end{align*}
その$n$次元数空間$\mathbb{R}^{n}$の2点$\mathbf{x}$、$\mathbf{x} + \mathbf{h}$を結ぶ線分$L$が与えられ、
\begin{align*}
L = \left\{ \mathbf{x} + t\mathbf{h} \in \mathbb{R}^{n} \middle| t \in [ 0,1] \right\}
\end{align*}
$L \subseteq U$が成り立つとき、その集合$\mathbb{R}$は稠密順序集合であるので、次式のような線分$L'$が
\begin{align*}
L' = \left\{ \mathbf{x} + t\mathbf{h} \in \mathbb{R}^{n} \middle| t \in I_{\varepsilon} = ( - \varepsilon,1 + \varepsilon) \right\}
\end{align*}
$L' \subseteq U$を満たすような正の実数$\varepsilon$が存在し、さらに、その関数$g$はその開区間$I_{\varepsilon}$上で$C^{\infty}$級である。したがって、その合成関数$f \circ g$はその閉区間$[ 0,1]$上で$C^{k}$級である。\par
このとき、Taylorの定理より次式が成り立つような実数$c$がその開区間$(0,1)$に存在する。
\begin{align*}
f \circ g(1) = f \circ g(0) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\partial^{m}(f \circ g)(0)(1 - 0)^{m}} + \frac{1}{k!}\partial^{k}(f \circ g)(c)(1 - 0)^{k}
\end{align*}
したがって、次のようになる。
\begin{align*}
f\left( \mathbf{x} + \mathbf{h} \right) &= f\left( g(1) \right) = f \circ g(1)\\
&= f \circ g(0) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\partial^{m}(f \circ g)(0)(1 - 0)^{m}} + \frac{1}{k!}\partial^{k}(f \circ g)(c)(1 - 0)^{k}\\
&= f\left( g(0) \right) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\partial^{m}(f \circ g)(0)} + \frac{1}{k!}\partial^{k}(f \circ g)(c)\\
&= f\left( \mathbf{x} \right) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\partial^{m}(f \circ g)(0)} + \frac{1}{k!}\partial^{k}(f \circ g)(c)
\end{align*}
ここで、$\forall m \in \varLambda_{k}\forall t \in [ 0,1]$に対し、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれると、次式が成り立つので、
\begin{align*}
\partial^{m}(f \circ g)(t) = \sum_{\forall j \in \varLambda_{m}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{m}\cdots i_{2}i_{1}}f\left( \mathbf{x} + t\mathbf{h} \right)\prod_{j \in \varLambda_{m}} h_{i_{j}}}
\end{align*}
次のようになる。
\begin{align*}
f\left( \mathbf{x} + \mathbf{h} \right) &= f\left( \mathbf{x} \right) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\sum_{\forall j \in \varLambda_{m}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{m}\cdots i_{2}i_{1}}f\left( \mathbf{x} \right)\prod_{j \in \varLambda_{m}} h_{i_{j}}}} \\
&\quad + \frac{1}{k!}\sum_{\forall j \in \varLambda_{k}\left[ i_{j} \in \varLambda_{n} \right]} {\partial_{i_{k}\cdots i_{2}i_{1}}f\left( \mathbf{x} + c\mathbf{h} \right)\prod_{j \in \varLambda_{k}} h_{i_{j}}}
\end{align*}
ここで、$m$次微分の定義より次のようになる。
\begin{align*}
f\left( \mathbf{x} + \mathbf{h} \right) = f\left( \mathbf{x} \right) + \sum_{m \in \varLambda_{k - 1}} {\frac{1}{m!}\left( d^{m}f \right)_{\mathbf{x}}\left( \mathbf{h} \right)} + \frac{1}{k!}\left( d^{k}f \right)_{\mathbf{x} + c\mathbf{h}}\left( \mathbf{h} \right)
\end{align*}
\end{proof}
%\hypertarget{ux6b21ux5faeux5206}{%
\subsubsection{1次微分}%\label{ux6b21ux5faeux5206}}\par
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{1}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。ここでは$\mathbf{x} \in U$なる1次微分$(df)_{\mathbf{x}}$について考えよう。
\begin{thm}\label{4.2.7.3}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{1}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとき、定義より明らかに、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれると、次式のような関数$(df)_{\mathbf{x}}$が定義されることができる。
\begin{align*}
(df)_{\mathbf{x}}:\mathbb{R}^{n} \rightarrow \mathbb{R};\mathbf{h} \mapsto \sum_{i \in \varLambda_{n}} {\partial_{i}f\left( \mathbf{x} \right)h_{i}}
\end{align*}
このとき、次式が成り立つ。
\begin{align*}
(df)_{\mathbf{x}}\left( \mathbf{h} \right) ={}^{t}\mathrm{grad}f\left( \mathbf{x} \right)\mathbf{h}
\end{align*}
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{1}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。$\forall\mathbf{x} \in U$に対し、定義より明らかに、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれ次式のような関数$(df)_{\mathbf{x}}$が定義されるとき、
\begin{align*}
(df)_{\mathbf{x}}:\mathbb{R}^{n} \rightarrow \mathbb{R};\mathbf{h} \mapsto \sum_{i \in \varLambda_{n}} {\partial_{i}f\left( \mathbf{x} \right)h_{i}}
\end{align*}
次のようになる。
\begin{align*}
(df)_{\mathbf{x}}\left( \mathbf{h} \right) = \sum_{i \in \varLambda_{n}} {\partial_{i}f\left( \mathbf{x} \right)h_{i}} = \begin{pmatrix}
\partial_{1}f\left( \mathbf{x} \right) & \partial_{2}f\left( \mathbf{x} \right) & \cdots & \partial_{n}f\left( \mathbf{x} \right) \\
\end{pmatrix}\begin{pmatrix}
h_{1} \\
h_{2} \\
 \vdots \\
h_{n} \\
\end{pmatrix} ={}^{t}\mathrm{grad}f\left( \mathbf{x} \right)\mathbf{h}
\end{align*}
\end{proof}
\begin{dfn}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{1}$級の関数$f:D(f) \rightarrow \mathbb{R}^{n}$が与えられ次式のように関数$(df)_{\mathbf{x}}$が定義されたとしても、$n = 1$のとき、${}^{t}\mathrm{grad}f = J_{f}$が成り立つのであったので、先ほどの定義での関数$(df)_{\mathbf{x}}$と一致する\footnote{ここで、$f=\left(f_i\right)_{i\in \varLambda_{n}}$、$d\mathbf{x}=\left(d x_i\right)_{i\in \varLambda_{m}} $とおかれれば$k\in \varLambda_m $として、$\forall i\in \varLambda_n $に対し、次式が成り立つ。
\begin{align*}
\left( df\right)_{\mathbf{a}} \left(d\mathbf{x} \right) &=\partial_k f_i \left( \mathbf{a} \right) dx_k \\
&=\left. \frac{\partial }{\partial x_1} f_i \left(\mathbf{x}\right) \right|_{\mathbf{x}=\mathbf{a}} dx_1+\left. \frac{\partial }{\partial x_2} f_i \left(\mathbf{x}\right) \right|_{\mathbf{x}=\mathbf{a}} dx_2+\cdots +\left. \frac{\partial }{\partial x_n} f_i \left(\mathbf{x}\right) \right|_{\mathbf{x}=\mathbf{a}} dx_n
\end{align*}}。
\begin{align*}
(df)_{\mathbf{x}}:\mathbb{R}^{m} \rightarrow \mathbb{R}^{n};\mathbf{h} \mapsto J_{f}\left( \mathbf{x} \right)\mathbf{h}
\end{align*}
\end{dfn}
\begin{thm}\label{4.2.7.4}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{1}$級の関数$f:D(f) \rightarrow \mathbb{R}^{n}$が与えられたとき、その関数$(df)_{\mathbf{x}}$は線形的である、即ち、$\forall k,l \in \mathbb{R}\forall\mathbf{g},\mathbf{h} \in \mathbb{R}^{m}$に対し、次式が成り立つ。
\begin{align*}
(df)_{\mathbf{x}}\left( k\mathbf{g} + l\mathbf{h} \right) = k(df)_{\mathbf{x}}\left( \mathbf{g} \right) + l(df)_{\mathbf{x}}\left( \mathbf{h} \right)
\end{align*}
\end{thm}\par
線形写像をよく知っている人は、vector空間たち$\mathbb{R}^{m}$、$\mathbb{R}^{n}$の間の任意の線形写像は行列とvectorとの積に書き換えられることができるので、その定理が導かれることができると予想できるのだろう。
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{1}$級の関数$f:D(f) \rightarrow \mathbb{R}^{n}$が与えられたとする。\par
$\forall\mathbf{x} \in U$に対し、次式のような関数$(df)_{\mathbf{x}}$が定義されるとき、
\begin{align*}
(df)_{\mathbf{x}}:\mathbb{R}^{m} \rightarrow \mathbb{R}^{n};\mathbf{h} \mapsto J_{f}\left( \mathbf{x} \right)\mathbf{h}
\end{align*}
$\forall k,l \in \mathbb{R}$に対し、次のようになる。
\begin{align*}
(df)_{\mathbf{x}}\left( k\mathbf{g} + l\mathbf{h} \right) &= J_{f}\left( \mathbf{x} \right)\left( k\mathbf{g} + l\mathbf{h} \right)\\
&= kJ_{f}\left( \mathbf{x} \right)\mathbf{g} + lJ_{f}\left( \mathbf{x} \right)\mathbf{l}\\
&= k(df)_{\mathbf{x}}\left( \mathbf{g} \right) + l(df)_{\mathbf{x}}\left( \mathbf{h} \right)
\end{align*}\par
以上より、その関数$(df)_{\mathbf{x}}$は線形的である。
\end{proof}
\begin{thm}\label{4.2.7.5} さらに、次のことが成り立つ。
\begin{itemize}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{1}$級の関数たち$f:D(f) \rightarrow \mathbb{R}^{n}$、$g:D(g) \rightarrow \mathbb{R}^{n}$について、$\forall\mathbf{x} \in U\forall k,l \in \mathbb{R}$に対し、次式が成り立つ。
\begin{align*}
\left( d(kf + lg) \right)_{\mathbf{x}} = k(df)_{\mathbf{x}} + l(dg)_{\mathbf{x}}:\mathbb{R}^{m} \rightarrow \mathbb{R}^{n}
\end{align*}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{1}$級の関数たち$f:D(f) \rightarrow \mathbb{R}^{n}$、$g:D(g) \rightarrow \mathbb{R}^{n}$について、$\forall\mathbf{x} \in U$に対し、次式が成り立つ。
\begin{align*}
\left( d\left({}^{t}fg \right) \right)_{\mathbf{x}} ={}^{t}g\left( \mathbf{x} \right)(df)_{\mathbf{x}} +{}^{t}f\left( \mathbf{x} \right)(dg)_{\mathbf{x}}:\mathbb{R}^{m} \rightarrow \mathbb{R}^{n}
\end{align*}
\item
  開集合たち$U、V$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$V \subseteq D(g) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{1}$級の関数たち$f:D(f) \rightarrow \mathbb{R}^{n}$、$g:D(g) \rightarrow \mathbb{R}^{o}$が合成可能でその合成関数$g \circ f$が存在するとき、$\forall\mathbf{x} \in U$に対し、次式が成り立つ。
\begin{align*}
\left( d(g \circ f) \right)_{\mathbf{x}} = J_{g} \circ f\left( \mathbf{x} \right)(df)_{\mathbf{x}}:\mathbb{R}^{m} \rightarrow \mathbb{R}^{n}
\end{align*}
\end{itemize}
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{1}$級の関数たち$f:D(f) \rightarrow \mathbb{R}^{n}$、$g:D(g) \rightarrow \mathbb{R}^{n}$について、$\forall\mathbf{x} \in U\forall\mathbf{h} \in \mathbb{R}^{m}\forall k,l \in \mathbb{R}$に対し、次のようになる。
\begin{align*}
\left( d(kf + lg) \right)_{\mathbf{x}}\left( \mathbf{h} \right) &= J_{kf + lg}\left( \mathbf{x} \right)\mathbf{h} = \left( kJ_{f}\left( \mathbf{x} \right) + lJ_{g}\left( \mathbf{x} \right) \right)\mathbf{h}\\
&= kJ_{f}\left( \mathbf{x} \right)\mathbf{h} + lJ_{g}\left( \mathbf{x} \right)\mathbf{h} = k(df)_{\mathbf{x}}\left( \mathbf{h} \right) + l(dg)_{\mathbf{x}}\left( \mathbf{h} \right)\\
\left( d\left({}^{t}fg \right) \right)_{\mathbf{x}}\left( \mathbf{h} \right) &= J_{{}^{t}fg}\left( \mathbf{x} \right)\mathbf{h} ={}^{t}\left({}^{t}J_{f}\left( \mathbf{x} \right)g\left( \mathbf{x} \right) +{}^{t}J_{g}\left( \mathbf{x} \right)f\left( \mathbf{x} \right) \right)\mathbf{h}\\
&={}^{t}g\left( \mathbf{x} \right)J_{f}\left( \mathbf{x} \right)\mathbf{h} +{}^{t}f\left( \mathbf{x} \right)J_{g}\left( \mathbf{x} \right)\mathbf{h}\\
&={}^{t}g\left( \mathbf{x} \right)(df)_{\mathbf{x}}\left( \mathbf{h} \right) +{}^{t}f\left( \mathbf{x} \right)(dg)_{\mathbf{x}}\left( \mathbf{h} \right)
\end{align*}
開集合たち$U$、$V$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$V \subseteq D(g) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{1}$級の関数たち$f:D(f) \rightarrow \mathbb{R}^{n}$、$g:D(g) \rightarrow \mathbb{R}^{o}$が合成可能でその合成関数$g \circ f$が存在するとき、$\forall\mathbf{x} \in U\forall\mathbf{h} \in \mathbb{R}^{m}$に対し、連鎖律より次のようになる。
\begin{align*}
\left( d(g \circ f) \right)_{\mathbf{x}}\left( \mathbf{h} \right) &= J_{g \circ f}\left( \mathbf{x} \right)\mathbf{h}\\
&= \left( \left( J_{g} \circ f \right)J_{f} \right)\left( \mathbf{x} \right)\mathbf{h}\\
&= \left( J_{g} \circ f \right)\left( \mathbf{x} \right)(df)_{\mathbf{x}}\left( \mathbf{h} \right)
\end{align*}
\end{proof}
%\hypertarget{hesseux884cux5217}{%
\subsubsection{Hesse行列}%\label{hesseux884cux5217}}
\begin{dfn}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なる関数$f:D(f) \rightarrow \mathbb{R}$が与えられ、その関数$f$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、次式のように与えられる行列$H_{f}\left( \mathbf{a} \right)$をその関数$f$のその点$\mathbf{a}$におけるHesse行列という。
\begin{align*}
H_{f}\left( \mathbf{a} \right) = \begin{pmatrix}
\partial_{11}f\left( \mathbf{a} \right) & \partial_{21}f\left( \mathbf{a} \right) & \cdots & \partial_{n1}f\left( \mathbf{a} \right) \\
\partial_{12}f\left( \mathbf{a} \right) & \partial_{22}f\left( \mathbf{a} \right) & \cdots & \partial_{n2}f\left( \mathbf{a} \right) \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{1n}f\left( \mathbf{a} \right) & \partial_{2n}f\left( \mathbf{a} \right) & \cdots & \partial_{nn}f\left( \mathbf{a} \right) \\
\end{pmatrix}
\end{align*}
さらに、その関数$f$の各成分がその開集合$U$で2階微分可能であるとき、次式のように与えられる関数$H_{f}$をその関数$f$のHesse関数という。
\begin{align*}
H_{f} = \begin{pmatrix}
\partial_{11}f & \partial_{21}f & \cdots & \partial_{n1}f \\
\partial_{12}f & \partial_{22}f & \cdots & \partial_{n2}f \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{1n}f & \partial_{2n}f & \cdots & \partial_{nn}f \\
\end{pmatrix}:U \rightarrow M_{nn}\left( \mathbb{R} \right);\mathbf{x} \mapsto \begin{pmatrix}
\partial_{11}f\left( \mathbf{x} \right) & \partial_{21}f\left( \mathbf{x} \right) & \cdots & \partial_{n1}f\left( \mathbf{x} \right) \\
\partial_{12}f\left( \mathbf{x} \right) & \partial_{22}f\left( \mathbf{x} \right) & \cdots & \partial_{n2}f\left( \mathbf{x} \right) \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{1n}f\left( \mathbf{x} \right) & \partial_{2n}f\left( \mathbf{x} \right) & \cdots & \partial_{nn}f\left( \mathbf{x} \right) \\
\end{pmatrix}
\end{align*}
\end{dfn}
\begin{thm}\label{4.2.7.6}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{2}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとき、その関数$f$のHesse行列$H_{f}$は対称行列である。
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{2}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとき、その関数$f$のHesse行列$H_{f}$について、定理\ref{4.2.3.6}より$\forall(i,j) \in \varLambda_{n}^{2}$に対し、$\partial_{ji}f = \partial_{ij}f$が成り立つので、たしかにその関数$f$のHesse行列$H_{f}$は対称行列である。
\end{proof}
\begin{thm}\label{4.2.7.7}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なる関数$f:D(f) \rightarrow \mathbb{R}$が与えられ、その関数$f$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、次式が成り立つ。
\begin{align*}
H_{f}\left( \mathbf{a} \right) ={}^{t}J_{\mathrm{grad}f}\left( \mathbf{a} \right)
\end{align*}\par
特に、その関数$f$の各成分がその開集合$U$で2階微分可能であるとき、次式が成り立つ。
\begin{align*}
H_{f} ={}^{t}J_{\mathrm{grad}f}:U \rightarrow M_{nn}\left( \mathbb{R} \right)
\end{align*}
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なる関数$f:D(f) \rightarrow \mathbb{R}$が与えられ、その関数$f$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、次のようになる。
\begin{align*}
H_{f}\left( \mathbf{a} \right) &= \begin{pmatrix}
\partial_{11}f\left( \mathbf{a} \right) & \partial_{21}f\left( \mathbf{a} \right) & \cdots & \partial_{n1}f\left( \mathbf{a} \right) \\
\partial_{12}f\left( \mathbf{a} \right) & \partial_{22}f\left( \mathbf{a} \right) & \cdots & \partial_{n2}f\left( \mathbf{a} \right) \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{1n}f\left( \mathbf{a} \right) & \partial_{2n}f\left( \mathbf{a} \right) & \cdots & \partial_{nn}f\left( \mathbf{a} \right) \\
\end{pmatrix}\\
&= \begin{pmatrix}
\partial_{1}\partial_{1}f\left( \mathbf{a} \right) & \partial_{1}\partial_{2}f\left( \mathbf{a} \right) & \cdots & \partial_{1}\partial_{n}f\left( \mathbf{a} \right) \\
\partial_{2}\partial_{1}f\left( \mathbf{a} \right) & \partial_{2}\partial_{2}f\left( \mathbf{a} \right) & \cdots & \partial_{2}\partial_{n}f\left( \mathbf{a} \right) \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{n}\partial_{1}f\left( \mathbf{a} \right) & \partial_{n}\partial_{2}f\left( \mathbf{a} \right) & \cdots & \partial_{n}\partial_{n}f\left( \mathbf{a} \right) \\
\end{pmatrix}\\
&={}^{t}J_{\mathrm{grad}f}\left( \mathbf{a} \right)
\end{align*}
\end{proof}
\begin{thm}\label{4.2.7.8} Hesse行列について、次のことが成り立つ。
\begin{itemize}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なる関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、それらの関数たち$f$、$g$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、$\forall k,l \in \mathbb{R}$に対し、次式が成り立つ。
\begin{align*}
H_{kf + lg}\left( \mathbf{a} \right) = kH_{f}\left( \mathbf{a} \right) + lH_{g}\left( \mathbf{a} \right)
\end{align*}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なる関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、それらの関数たち$f$、$g$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、次式が成り立つ。
\begin{align*}
H_{fg}\left( \mathbf{a} \right) = H_{f}\left( \mathbf{a} \right)g\left( \mathbf{a} \right) + f\left( \mathbf{a} \right)H_{g}\left( \mathbf{a} \right) + \mathrm{grad}f\left( \mathbf{a} \right){}^{t}\mathrm{grad}g\left( \mathbf{a} \right) + \mathrm{grad}g\left( \mathbf{a} \right){}^{t}\mathrm{grad}f\left( \mathbf{a} \right)
\end{align*}
\end{itemize}\par
特に、次のことが成り立つ。
\begin{itemize}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なる関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、それらの関数たち$f$、$g$の各成分がその開集合$U$で2階微分可能であるとき、$\forall k,l \in \mathbb{R}$に対し、次式が成り立つ。
\begin{align*}
H_{kf + lg} = kH_{f} + lH_{g}:U \rightarrow M_{nn}\left( \mathbb{R} \right)
\end{align*}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なる関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、それらの関数たち$f$、$g$の各成分がその開集合$U$で2階微分可能であるとき、次式が成り立つ。
\begin{align*}
H_{fg} = H_{f}g + fH_{g} + \mathrm{grad}f{}^{t}\mathrm{grad}g + \mathrm{grad}g{}^{t}\mathrm{grad}f:U \rightarrow M_{nn}\left( \mathbb{R} \right)
\end{align*}
\end{itemize}
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なる関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、それらの関数たち$f$、$g$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、$\forall k,l \in \mathbb{R}$に対し、その関数$kf + lg$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能で定理\ref{4.2.6.4}、定理\ref{4.2.6.6}、定理\ref{4.2.7.7}より次のようになる。
\begin{align*}
H_{kf + lg}\left( \mathbf{a} \right) &={}^{t}J_{\mathrm{grad}(kf + lg)}\left( \mathbf{a} \right)\\
&={}^{t}J_{k\mathrm{grad}f + l\mathrm{grad}g}\left( \mathbf{a} \right)\\
&= k{}^{t}J_{\mathrm{grad}f}\left( \mathbf{a} \right) + l{}^{t}J_{\mathrm{grad}g}\left( \mathbf{a} \right)\\
&= kH_{f}\left( \mathbf{a} \right) + lH_{g}\left( \mathbf{a} \right)
\end{align*}\par
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なる$C^{2}$級の関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、それらの関数たち$f$、$g$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能であるとき、その関数$fg$の各成分が$\mathbf{a} \in U$なる点$\mathbf{a}$で2階微分可能で定理\ref{4.2.6.4}、定理\ref{4.2.6.6}、定理\ref{4.2.6.10}、定理\ref{4.2.7.7}より次のようになる。
\begin{align*}
H_{fg}\left( \mathbf{a} \right) &={}^{t}J_{\mathrm{grad}{fg}}\left( \mathbf{a} \right)\\
&={}^{t}J_{\mathrm{grad}fg + f\mathrm{grad}g}\left( \mathbf{a} \right)\\
&={}^{t}J_{\mathrm{grad}fg}\left( \mathbf{a} \right) +{}^{t}J_{f\mathrm{grad}g}\left( \mathbf{a} \right)\\
&={}^{t}\left( \mathrm{grad}f\left( \mathbf{a} \right){}^{t}\mathrm{grad}g\left( \mathbf{a} \right) + g\left( \mathbf{a} \right)J_{\mathrm{grad}f}\left( \mathbf{a} \right) \right) +{}^{t}\left( \mathrm{grad}g\left( \mathbf{a} \right){}^{t}\mathrm{grad}f\left( \mathbf{a} \right) + f\left( \mathbf{a} \right)J_{\mathrm{grad}g}\left( \mathbf{a} \right) \right)\\
&= \mathrm{grad}g\left( \mathbf{a} \right){}^{t}\mathrm{grad}f\left( \mathbf{a} \right) + g\left( \mathbf{a} \right){}^{t}J_{\mathrm{grad}f}\left( \mathbf{a} \right) + \mathrm{grad}f\left( \mathbf{a} \right){}^{t}\mathrm{grad}g\left( \mathbf{a} \right) + f\left( \mathbf{a} \right){}^{t}J_{\mathrm{grad}g}\left( \mathbf{a} \right)\\
&={}^{t}J_{\mathrm{grad}f}\left( \mathbf{a} \right)g\left( \mathbf{a} \right) + f\left( \mathbf{a} \right){}^{t}J_{\mathrm{grad}g}\left( \mathbf{a} \right) + \mathrm{grad}f\left( \mathbf{a} \right){}^{t}\mathrm{grad}g\left( \mathbf{a} \right) + \mathrm{grad}g\left( \mathbf{a} \right){}^{t}\mathrm{grad}f\left( \mathbf{a} \right)\\
&= H_{f}\left( \mathbf{a} \right)g\left( \mathbf{a} \right) + f\left( \mathbf{a} \right)H_{g}\left( \mathbf{a} \right) + \mathrm{grad}f\left( \mathbf{a} \right){}^{t}\mathrm{grad}g\left( \mathbf{a} \right) + \mathrm{grad}g\left( \mathbf{a} \right){}^{t}\mathrm{grad}f\left( \mathbf{a} \right)
\end{align*}
\end{proof}
%\hypertarget{ux6b21ux5faeux5206-1}{%
\subsubsection{2次微分}%\label{ux6b21ux5faeux5206-1}}\par
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{2}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとする。ここでは$\mathbf{x} \in U$なる2次微分$\left( d^{2}f \right)_{\mathbf{x}}\left( \mathbf{h} \right)$について考えよう。
\begin{thm}\label{4.2.7.9}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{2}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとき、$\forall\mathbf{x} \in U$に対し、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれるとき、2次微分$\left( d^{2}f \right)_{\mathbf{x}}$について、次式が成り立つ。
\begin{align*}
\left( d^{2}f \right)_{\mathbf{x}}\left( \mathbf{h} \right) ={}^{t}\mathbf{h}H_{f}\left( \mathbf{x} \right)\mathbf{h}:\mathbb{R}^{n} \rightarrow \mathbb{R}
\end{align*}
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{n}$なるその開集合$U$上で$C^{2}$級の関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとき、$\forall\mathbf{x} \in U$に対し、定義より明らかに、vector$\mathbf{h}$が$\left( h_{i} \right)_{i \in \varLambda_{n}}$とおかれ次式のような関数$\left( d^{2}f \right)_{\mathbf{x}}$が定義されるとき、
\begin{align*}
\left( d^{2}f \right)_{\mathbf{x}}:\mathbb{R}^{n} \rightarrow \mathbb{R};\mathbf{h} \mapsto \sum_{i,j \in \varLambda_{n}} {\partial_{ji}f\left( \mathbf{x} \right)h_{i}h_{j}}
\end{align*}
次のようになる。
\begin{align*}
\left( d^{2}f \right)_{\mathbf{x}}\left( \mathbf{h} \right) &= \sum_{i,j \in \varLambda_{n}} {\partial_{ji}f\left( \mathbf{x} \right)h_{i}h_{j}}\\
&= \begin{pmatrix}
h_{1} & h_{2} & \cdots & h_{n} \\
\end{pmatrix}\begin{pmatrix}
\partial_{11}f\left( \mathbf{x} \right)h_{1} + \partial_{21}f\left( \mathbf{x} \right)h_{2} + \cdots + \partial_{n1}f\left( \mathbf{x} \right)h_{n} \\
\partial_{12}f\left( \mathbf{x} \right)h_{1} + \partial_{22}f\left( \mathbf{x} \right)h_{2} + \cdots + \partial_{n2}f\left( \mathbf{x} \right)h_{n} \\
 \vdots \\
\partial_{1n}f\left( \mathbf{x} \right)h_{1} + \partial_{2n}f\left( \mathbf{x} \right)h_{2} + \cdots + \partial_{nn}f\left( \mathbf{x} \right)h_{n} \\
\end{pmatrix}\\
&= \begin{pmatrix}
h_{1} & h_{2} & \cdots & h_{n} \\
\end{pmatrix}\begin{pmatrix}
\partial_{11}f\left( \mathbf{x} \right) & \partial_{12}f\left( \mathbf{x} \right) & \cdots & \partial_{1n}f\left( \mathbf{x} \right) \\
\partial_{21}f\left( \mathbf{x} \right) & \partial_{22}f\left( \mathbf{x} \right) & \cdots & \partial_{2n}f\left( \mathbf{x} \right) \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{n1}f\left( \mathbf{x} \right) & \partial_{n2}f\left( \mathbf{x} \right) & \cdots & \partial_{nn}f\left( \mathbf{x} \right) \\
\end{pmatrix}\begin{pmatrix}
h_{1} \\
h_{2} \\
 \vdots \\
h_{n} \\
\end{pmatrix}\\
&={}^{t}\mathbf{h}H_{f}\left( \mathbf{x} \right)\mathbf{h}
\end{align*}
\end{proof}
\begin{thm}\label{4.2.7.10} 2次微分について、次のことが成り立つ。
\begin{itemize}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{2}$級の関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、$\forall\mathbf{x} \in U\forall k,l \in \mathbb{R}$に対し、次式が成り立つ。
\end{itemize}
\begin{align*}
\left( d^{2}(kf + lg) \right)_{\mathbf{x}} = k\left( d^{2}f \right)_{\mathbf{x}} + l\left( d^{2}g \right)_{\mathbf{x}}:\mathbb{R}^{n} \rightarrow \mathbb{R}
\end{align*}
\begin{itemize}
\item
  開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{2}$級の関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、$\forall\mathbf{x} \in U$に対し、次式が成り立つ。
\end{itemize}
\begin{align*}
\left( d^{2}(fg) \right)_{\mathbf{x}} = g\left( \mathbf{x} \right)\left( d^{2}f \right)_{\mathbf{x}} + 2{}^{t}(df)_{\mathbf{x}}(dg)_{\mathbf{x}} + f\left( \mathbf{x} \right)\left( d^{2}g \right)_{\mathbf{x}}:\mathbb{R}^{n} \rightarrow \mathbb{R}
\end{align*}
\end{thm}
\begin{proof}
開集合$U$を用いて$U \subseteq D(f) \subseteq \mathbb{R}^{m}$かつ$U \subseteq D(g) \subseteq \mathbb{R}^{m}$なるその開集合$U$上で$C^{2}$級の関数たち$f:D(f) \rightarrow \mathbb{R}$、$g:D(g) \rightarrow \mathbb{R}$について、$\forall\mathbf{x} \in U\forall\mathbf{h} \in \mathbb{R}^{m}\forall k,l \in \mathbb{R}$に対し、定理\ref{4.2.7.8}、定理\ref{4.2.7.9}より次のようになる。
\begin{align*}
\left( d^{2}(kf + lg) \right)_{\mathbf{x}}\left( \mathbf{h} \right) &={}^{t}\mathbf{h}H_{kf + lg}\left( \mathbf{x} \right)\mathbf{h}\\
&={}^{t}\mathbf{h}\left( kH_{f}\left( \mathbf{x} \right) + lH_{g}\left( \mathbf{x} \right) \right)\mathbf{h}\\
&= k{}^{t}\mathbf{h}H_{f}\left( \mathbf{x} \right)\mathbf{h} + l{}^{t}\mathbf{h}H_{g}\left( \mathbf{x} \right)\mathbf{h}\\
&= k\left( d^{2}f \right)_{\mathbf{x}}\left( \mathbf{h} \right) + l\left( d^{2}g \right)_{\mathbf{x}}\left( \mathbf{h} \right)\\
&= \left( k\left( d^{2}f \right)_{\mathbf{x}} + l\left( d^{2}g \right)_{\mathbf{x}} \right)\left( \mathbf{h} \right)\\
\left( d^{2}(fg) \right)_{\mathbf{x}}\left( \mathbf{h} \right) &={}^{t}\mathbf{h}H_{fg}\left( \mathbf{x} \right)\mathbf{h}\\
&={}^{t}\mathbf{h}\left( H_{f}\left( \mathbf{x} \right)g\left( \mathbf{x} \right) + f\left( \mathbf{x} \right)H_{g}\left( \mathbf{x} \right) \right. \\
&\quad \left. + \mathrm{grad}f\left( \mathbf{x} \right){}^{t}\mathrm{grad}g\left( \mathbf{x} \right) + \mathrm{grad}g\left( \mathbf{x} \right){}^{t}\mathrm{grad}f\left( \mathbf{x} \right) \right)\mathbf{h}\\
&={}^{t}\mathbf{h}H_{f}\left( \mathbf{x} \right)\mathbf{h}g\left( \mathbf{x} \right) + f\left( \mathbf{x} \right){}^{t}\mathbf{h}H_{g}\left( \mathbf{x} \right)\mathbf{h} \\
&\quad +{}^{t}\mathbf{h}\mathrm{grad}f\left( \mathbf{x} \right){}^{t}\mathrm{grad}g\left( \mathbf{x} \right)\mathbf{h} +{}^{t}\mathbf{h}\mathrm{grad}g\left( \mathbf{x} \right){}^{t}\mathrm{grad}f\left( \mathbf{x} \right)\mathbf{h}\\
&= g\left( \mathbf{x} \right){}^{t}\mathbf{h}H_{f}\left( \mathbf{x} \right)\mathbf{h} + f\left( \mathbf{x} \right){}^{t}\mathbf{h}H_{g}\left( \mathbf{x} \right)\mathbf{h} \\
&\quad +{}^{t}\left({}^{t}\mathrm{grad}f\left( \mathbf{x} \right)\mathbf{h} \right){}^{t}\mathrm{grad}g\left( \mathbf{x} \right)\mathbf{h} +{}^{t}\left({}^{t}\mathrm{grad}g\left( \mathbf{x} \right)\mathbf{h} \right){}^{t}\mathrm{grad}f\left( \mathbf{x} \right)\mathbf{h}\\
&= g\left( \mathbf{x} \right)\left( d^{2}f \right)_{\mathbf{x}}\left( \mathbf{h} \right) + f\left( \mathbf{x} \right)\left( d^{2}g \right)_{\mathbf{x}}\left( \mathbf{h} \right) \\
&\quad +{}^{t}(df)_{\mathbf{x}}\left( \mathbf{h} \right)(dg)_{\mathbf{x}}\left( \mathbf{h} \right) +{}^{t}(dg)_{\mathbf{x}}\left( \mathbf{h} \right)(df)_{\mathbf{x}}\left( \mathbf{h} \right)\\
&= \left( g\left( \mathbf{x} \right)\left( d^{2}f \right)_{\mathbf{x}} + f\left( \mathbf{x} \right)\left( d^{2}g \right)_{\mathbf{x}} \right. \\
&\quad \left. +{}^{t}(df)_{\mathbf{x}}(dg)_{\mathbf{x}} +{}^{t}(dg)_{\mathbf{x}}(df)_{\mathbf{x}} \right)\left( \mathbf{h} \right)\\
&= \left( g\left( \mathbf{x} \right)\left( d^{2}f \right)_{\mathbf{x}} + 2{}^{t}(df)_{\mathbf{x}}(dg)_{\mathbf{x}} + f\left( \mathbf{x} \right)\left( d^{2}g \right)_{\mathbf{x}} \right)\left( \mathbf{h} \right)
\end{align*}
\end{proof}
\begin{thebibliography}{50}
  \bibitem{1}
  杉浦光夫, 解析入門I, 東京大学出版社, 1985. 第34刷 p146-149 ISBN978-4-13-062005-5
\end{thebibliography}
\end{document}
