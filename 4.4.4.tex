\documentclass[dvipdfmx]{jsarticle}
\setcounter{section}{4}
\setcounter{subsection}{3}
\usepackage{xr}
\externaldocument{4.4.1}
\externaldocument{4.4.3}
\input{macro}
\begin{document}
%\hypertarget{lagrangeux306eux672aux5b9aux4e57ux6570ux6cd5}{%
\subsection{Lagrangeの未定乗数法}%\label{lagrangeux306eux672aux5b9aux4e57ux6570ux6cd5}}
%\hypertarget{lagrangeux306eux672aux5b9aux4e57ux6570ux6cd5-1}{%
\subsubsection{Lagrangeの未定乗数法}%\label{lagrangeux306eux672aux5b9aux4e57ux6570ux6cd5-1}}
\begin{dfn}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$、その開集合$U$の部分集合$M$が与えられたとき、$\mathbf{a} \in M$なる点$\mathbf{a}$のある近傍$V$が存在して、$f\left( \mathbf{a} \right) = \max{f|\mathrm{int}V \cap M}$が成り立つようなその点$\mathbf{a}$をその関数$f$のその部分集合$M$上の極大点といいその値$f\left( \mathbf{a} \right)$をその関数$f$のその部分集合$M$上の極大値という。\par
同様にして、$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$、その開集合$U$の部分集合$M$が与えられたとき、$\mathbf{a} \in M$なる点$\mathbf{a}$のある近傍$V$が存在して、$f\left( \mathbf{a} \right) = \min{f|\mathrm{int}V \cap M}$が成り立つようなその点$\mathbf{a}$をその関数$f$のその部分集合$M$上の極小点といいその値$f\left( \mathbf{a} \right)$をその関数$f$のその部分集合$M$上の極小値という。
\end{dfn}
\begin{dfn}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$、その開集合$U$の部分集合$M$が与えられたとき、その関数$f$のその部分集合$M$上の極大値または極小値のことをその関数$f$のその部分集合$M$上の極値という。
\end{dfn}
\begin{dfn}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$、その開集合$U$の部分集合$M$が与えられたとき、$\mathbf{a} \in M$なる点$\mathbf{a}$のある近傍$V$が存在して、$f\left( \mathbf{a} \right) = \max{f|\mathrm{int}V \cap M}$が成り立つその関数$f$のその部分集合$M$上の極大点$\mathbf{a}$のうち、$\forall\mathbf{x} \in \mathrm{int}V$に対し、$\mathbf{x} \neq \mathbf{a}$が成り立つなら、$f\left( \mathbf{x} \right) < f\left( \mathbf{a} \right)$が成り立つようなものをその関数$f$のその部分集合$M$上の狭義の極大点といいその値$f\left( \mathbf{a} \right)$をその関数$f$のその部分集合$M$上の狭義の極大値という。\par
同様にして、$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$、その開集合$U$の部分集合$M$が与えられたとき、$\mathbf{a} \in M$なる点$\mathbf{a}$のある近傍$V$が存在して、$f\left( \mathbf{a} \right) = \min{f|\mathrm{int}V \cap M}$が成り立つその関数$f$のその部分集合$M$上の極大点$\mathbf{a}$のうち、$\forall\mathbf{x} \in \mathrm{int}V$に対し、$\mathbf{x} \neq \mathbf{a}$が成り立つなら、$f\left( \mathbf{x} \right) > f\left( \mathbf{a} \right)$が成り立つようなものをその関数$f$のその部分集合$M$上の狭義の極小点といいその値$f\left( \mathbf{a} \right)$をその関数$f$のその部分集合$M$上の狭義の極小値という。
\end{dfn}
\begin{thm}\label{4.4.4.1}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$が与えられたとき、値$f\left( \mathbf{a} \right)$がその関数$f$の極大値となるならそのときに限り、それぞれその値$f\left( \mathbf{a} \right)$はその関数$f$のその集合$U$上の極大値である。同様に、値$f\left( \mathbf{a} \right)$がその関数$f$の極小値となるならそのときに限り、それぞれその値$f\left( \mathbf{a} \right)$はその関数$f$のその集合$U$上の極小値である。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}$が与えられたとき、値$f\left( \mathbf{a} \right)$がその関数$f$の極大値となるなら、$\mathbf{a} \in \mathbb{R}^{n}$なる点$\mathbf{a}$のある$\varepsilon$近傍$U\left( \mathbf{a},\varepsilon \right)$がその定義域$U$の部分集合となるようにその点$\mathbf{a}$をとったとき、値$f\left( \mathbf{a} \right)$が最大値$\max{V\left( f|U\left( \mathbf{a},\varepsilon \right) \right)}$に等しい、即ち、その関数$fのその集合U\left( \mathbf{a},\varepsilon \right)$での最大値となることになる。そこで、そのような点$a$全体の集合がまさしくその開核$\mathrm{int}U$であり、その定義域$U$が開集合なので、$U = \mathrm{int}U$が成り立つかつ、$U\left( \mathbf{a},\varepsilon \right) \subseteq U$より$U\left( \mathbf{a},\varepsilon \right) \cap U = U\left( \mathbf{a},\varepsilon \right)$が成り立つかつ、その$\varepsilon$近傍$U\left( \mathbf{a},\varepsilon \right)$はその点$\mathbf{a}$の近傍でもあることに注意すれば、$\mathbf{a} \in \mathrm{int}U = U$なる点$\mathbf{a}$のある近傍$U\left( \mathbf{a},\varepsilon \right)$が存在して、次式が成り立つ。
\begin{align*}
f\left( \mathbf{a} \right) = \max{V\left( f|U\left( \mathbf{a},\varepsilon \right) \right)} = \max{f|U\left( \mathbf{a},\varepsilon \right)} = \max{f|U\left( \mathbf{a},\varepsilon \right) \cap U}
\end{align*}
ゆえに、その値$f\left( \mathbf{a} \right)$はその関数$f$のその集合$U$上の極大値である。\par
逆に、その値$f\left( \mathbf{a} \right)$がその関数$f$のその集合$U$上の極大値であるなら、$\mathbf{a} \in U$なる点$\mathbf{a}$のある近傍$V$が存在して、$f\left( \mathbf{a} \right) = \max{f|\mathrm{int}V \cap U}$が成り立つ。そこで、集合$\mathrm{int}V \cap U$は開集合なので、ある正の実数$\varepsilon$が存在して、$U\left( \mathbf{a},\varepsilon \right) \subseteq \mathrm{int}V \cap U$が成り立つようにすることができる。このとき、もちろん、次式が成り立つ。
\begin{align*}
f\left( \mathbf{a} \right) = \max{f|\mathrm{int}V \cap U} = \max{f|U\left( \mathbf{a},\varepsilon \right)} = \max{V\left( f|U\left( \mathbf{a},\varepsilon \right) \right)}
\end{align*}
ゆえに、その値$f\left( \mathbf{a} \right)$はその関数$f$の極大値となる。\par
極小値についても同様にして示される。
\end{proof}
\begin{thm}\label{4.4.4.2}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$S = \left\{ \mathbf{x} \in U \middle| g\left( \mathbf{x} \right) = \mathbf{0} \right\}$において、その関数$f$がその集合$S$上の極値$f\left( \mathbf{a} \right)$をとるかつ、$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} = n$が成り立つなら、$\exists\mathbf{l} = \left( l_{i} \right)_{i \in \varLambda_{n}} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}f\left( \mathbf{a} \right) ={}^t J_{g}\left( \mathbf{a} \right)\mathbf{l}$が成り立つ。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数たち$f:U \rightarrow \mathbb{R}$、$g = \left( g_{i} \right)_{i \in \varLambda_{n}}:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$S = \left\{ \mathbf{x} \in U \middle| g\left( \mathbf{x} \right) = \mathbf{0} \right\}$において、その関数$f$がその集合$S$上の極値$f\left( \mathbf{a} \right)$をとるかつ、$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} = n$が成り立つなら、$n \leq m$が成り立つことになり、添数を適切におくことにより、$\nabla^{*} = \left( \partial_{i} \right)_{i \in \varLambda_{m - n}}$、$\nabla_{*} = \left( \partial_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{m - n}}$とおくと、$\det{{}^t \left( \nabla_{*}{}^t g \right)}\left( \mathbf{a} \right) \neq 0$が成り立つとしてもよい。さらに、$\mathbf{a}^{*} = \left( a_{i} \right)_{i \in \varLambda_{m - n}}$、$\mathbf{a}_{*} = \left( a_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{m - n}}$、$\mathbf{x}^{*} = \left( x_{i} \right)_{i \in \varLambda_{m - n}}$、$\mathbf{x}_{*} = \left( x_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{m - n}}$とおくと、定理\ref{4.4.1.3}、即ち、よりよい陰関数定理よりそれらの点々$\mathbf{a}_{1}$、$\mathbf{a}_{2}$のある近傍たち$V$、$W$と$C^{1}$級関数$\varphi:V \rightarrow W$が存在して、$V \times W \subseteq U$で、$\forall\mathbf{x} \in V \times W$に対し、次式が成り立ち、
\begin{align*}
\mathbf{x} = \begin{pmatrix}
\mathbf{x}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} \in S \Leftrightarrow g\left( \mathbf{x} \right) = \mathbf{0} \Leftrightarrow \mathbf{x}_{*} = \varphi\left( \mathbf{x}^{*} \right)
\end{align*}
さらに、$\varphi_{\downarrow}:V \rightarrow U;\mathbf{x}^{*} \mapsto \begin{pmatrix}
\mathbf{x}^{*} \\
\varphi\left( \mathbf{x}^{*} \right) \\
\end{pmatrix}$とすれば、その陰関数$\varphi$はその近傍$V$で次式を満たす。
\begin{align*}
J_{\varphi} = - \left({}^t \left( \nabla_{*}{}^t g \right)^{- 1}{}^{t}\left( \nabla^{*}{}^{t}g \right) \right) \circ \varphi_{\downarrow}
\end{align*}\par
$F = f \circ \varphi_{\downarrow}:V \rightarrow \mathbb{R}$のように関数$F$が定義されると、その関数$F$は$V \subseteq \mathbb{R}^{m - n}$なる開集合$V$を定義域とする$C^{1}$級の関数であり、仮定より$\mathbf{x} = \mathbf{a}$のときその集合$S$上の極値をとるので、$\mathbf{x}^{*} = \mathbf{a}^{*}$のとき、その関数$F$は極値をとる。そこで、定理\ref{4.4.3.1}より$\mathrm{grad}F\left( \mathbf{a}^{*} \right) = \mathbf{0}$が成り立つ。したがって、次のようになり、
\begin{align*}
\mathrm{grad}F &={}^t J_{F} ={}^t J_{f \circ \varphi_{\downarrow}}\\
&={}^t \left( \left( J_{f} \circ \varphi_{\downarrow} \right)J_{\varphi_{\downarrow}} \right)\\
&={}^t J_{\varphi_{\downarrow}}{}^t \left( J_{f} \circ \varphi_{\downarrow} \right)\\
&={}^t \begin{pmatrix}
I_{m - n} \\
J_{\varphi} \\
\end{pmatrix}\left( \mathrm{grad}f \circ \varphi_{\downarrow} \right)\\
&= \begin{pmatrix}
{}^t I_{m - n} &{}^t J_{\varphi} \\
\end{pmatrix}\left( \mathrm{grad}f \circ \varphi_{\downarrow} \right)\\
&= \begin{pmatrix}
I_{m - n} &{}^t J_{\varphi} \\
\end{pmatrix}\begin{pmatrix}
\nabla^{*}f \circ \varphi_{\downarrow} \\
\nabla_{*}f \circ \varphi_{\downarrow} \\
\end{pmatrix}\\
&= \nabla^{*}f \circ \varphi_{\downarrow} +{}^t J_{\varphi}\left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\\
&= \nabla^{*}f \circ \varphi_{\downarrow} -{}^t \left( \left({}^t \left( \nabla_{*}{}^t g \right)^{- 1}{}^t \left( \nabla^{*}{}^t g \right) \right) \circ \varphi_{\downarrow} \right)\left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\\
&= \nabla^{*}f \circ \varphi_{\downarrow} - \left( \nabla^{*}{}^t g \circ \varphi_{\downarrow} \right)\left( \left( \nabla_{*}{}^t g \right)^{- 1} \circ \varphi_{\downarrow} \right)\left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\\
&= \nabla^{*}f \circ \varphi_{\downarrow} - \left( \nabla^{*}{}^t g \circ \varphi_{\downarrow} \right){}^t \left( \left({}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\left({}^t \left( \nabla_{*}{}^{t}g \right)^{- 1} \circ \varphi_{\downarrow} \right) \right)\\
&= \nabla^{*}f \circ \varphi_{\downarrow} - \left( \nabla^{*}{}^t g \circ \varphi_{\downarrow} \right){}^t \left( \left({}^t \nabla_{*}f{}^t \left( \nabla_{*}{}^{t}g \right)^{- 1} \right) \circ \varphi_{\downarrow} \right)
\end{align*}
そこで、次式のようにvector$\mathbf{l}$がおかれれば、
\begin{align*}
\mathbf{l} &={}^t \left( \left({}^t \nabla_{*}f{}^t \left( \nabla_{*}{}^{t}g \right)^{- 1} \right) \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) \right)\\
&={}^t \left({}^t \nabla_{*}f{}^t \left( \nabla_{*}{}^{t}g \right)^{- 1} \right) \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\\
&= \left( \left( \nabla_{*}{}^t g \right)^{- 1}\nabla_{*}f \right) \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\\
&= \left( \nabla_{*}{}^t g \right)^{- 1} \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\nabla_{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)
\end{align*}
次式が成り立つ。
\begin{align*}
\mathrm{grad}F\left( \mathbf{a}^{*} \right) &= \nabla^{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) - \nabla^{*}{}^t g \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right){}^t \left( \left({}^t \nabla_{*}f{}^t \left( \nabla_{*}{}^t g \right)^{- 1} \right) \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) \right)\\
&= \nabla^{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) - \nabla^{*}{}^t g \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\mathbf{l} = \mathbf{0}
\end{align*}
以上より、次式が得られる。
\begin{align*}
\nabla^{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) = \nabla^{*}{}^t g \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\mathbf{l},\ \ \nabla_{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) = \nabla_{*}{}^t g \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\mathbf{l}
\end{align*}
これにより、次のようになる。
\begin{align*}
\mathrm{grad}f\left( \mathbf{a} \right) &= \begin{pmatrix}
\nabla^{*}f \\
\nabla_{*}f \\
\end{pmatrix}\left( \mathbf{a} \right)\\
&= \begin{pmatrix}
\nabla^{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) \\
\nabla_{*}f \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) \\
\end{pmatrix}\\
&= \begin{pmatrix}
\nabla^{*}{}^t g \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\mathbf{l} \\
\nabla_{*}{}^t g \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\mathbf{l} \\
\end{pmatrix}\\
&= \begin{pmatrix}
\nabla^{*}{}^t g \\
\nabla_{*}{}^t g \\
\end{pmatrix} \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right)\mathbf{l}\\
&= \left({}^t \begin{pmatrix}
{}^t \nabla^{*}{}^t g &{}^t \nabla_{*}{}^t g \\
\end{pmatrix} \circ \varphi_{\downarrow}\left( \mathbf{a}^{*} \right) \right)\mathbf{l}\\
&={}^t J_{g}\left( \mathbf{a} \right)\mathbf{l}
\end{align*}
\end{proof}
\begin{thm}[Lagrangeの未定乗数法]\label{4.4.4.3}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$S = \left\{ \mathbf{x} \in U \middle| g\left( \mathbf{x} \right) = \mathbf{0} \right\}$において、その関数$f$がその集合$S$上の極値$f\left( \mathbf{a} \right)$をとるなら、次のいづれかが成り立つ。
\begin{itemize}
\item
  次式のような関数$\varPhi$が用いられれば、
\begin{align*}
\varPhi:U \times \mathbb{R}^{n} \rightarrow \mathbb{R};\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} \mapsto f\left( \mathbf{x} \right) -{}^t \mathbf{y}g\left( \mathbf{x} \right)
\end{align*}
$\exists\mathbf{l} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}\varPhi\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} = \mathbf{0}$が成り立つ。
\item
  $\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} < n$が成り立つ。
\end{itemize}
この定理をLagrangeの未定乗数法といい、そのvector$\mathbf{l}$をLagrange乗数という。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$S = \left\{ \mathbf{x} \in U \middle| g\left( \mathbf{x} \right) = \mathbf{0} \right\}$において、その関数$f$がその集合$S$上の極値$f\left( \mathbf{a} \right)$をとるなら、$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} < n$が成り立たないとき、$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} \leq \min\left\{ m,n \right\}$より$m < n$が成り立つとすれば、$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} \leq m < n \leq \mathrm{rank}{J_{g}\left( \mathbf{a} \right)}$が成り立つことになり、これは矛盾している。ゆえに、$n \leq m$が成り立つことになり、このとき、$n \leq \mathrm{rank}{J_{g}\left( \mathbf{a} \right)} \leq n$が得られるので、$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} = n$が成り立つ。したがって、定理\ref{4.4.4.2}より$\exists\mathbf{l} = \left( l_{i} \right)_{i \in \varLambda_{n}} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}f\left( \mathbf{a} \right) ={}^t J_{g}\left( \mathbf{a} \right)\mathbf{l}$が成り立つ。そこで、$\mathbf{a} \in S$より$g\left( \mathbf{a} \right) = \mathbf{0}$が成り立つことに注意すれば、次のようにして
\begin{align*}
\varPhi = f \circ 1^{*} -{}^t 1_{*}\left( g \circ 1^{*} \right):U \times \mathbb{R}^{n} &\rightarrow \mathbb{R}\begin{pmatrix}
  \mathbf{x} \\
  \mathbf{y} \\
\end{pmatrix} \mapsto f\left( \mathbf{x} \right) -{}^t \mathbf{y}g\left( \mathbf{x} \right)\\
1^{*}:\mathbb{R}^{m} \times \mathbb{R}^{n} \rightarrow \mathbb{R}^{n};\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} \mapsto \mathbf{x}&,\ \ 
1_{*}:\mathbb{R}^{m} \times \mathbb{R}^{n} \rightarrow \mathbb{R}^{n};\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} \mapsto \mathbf{y} 
\end{align*}
したがって、次のようになり、
\begin{align*}
\mathrm{grad}\varPhi &= \mathrm{grad}{f \circ 1^{*}} - \mathrm{grad}\left({}^t 1_{*}\left( g \circ 1^{*} \right) \right)\\
&= \mathrm{grad}\left( f \circ 1^{*} \right) -{}^t J_{1_{*}}\left( g \circ 1^{*} \right) -{}^{t}J_{g \circ 1^{*}}1_{*}\\
&={}^t J_{1^{*}}\left( \mathrm{grad}f \circ 1^{*} \right) -{}^t J_{1_{*}}\left( g \circ 1^{*} \right) -{}^{t}J_{1^{*}}{}^t \left( J_{g} \circ 1^{*} \right)1_{*}\\
&= \begin{pmatrix}
I \\
O \\
\end{pmatrix}\left( \mathrm{grad}f \circ 1^{*} \right) - \begin{pmatrix}
O \\
I \\
\end{pmatrix}\left( g \circ 1^{*} \right) - \begin{pmatrix}
I \\
O \\
\end{pmatrix}{}^t \left( J_{g} \circ 1^{*} \right)1_{*}\\
&= \begin{pmatrix}
\mathrm{grad}f \circ 1^{*} \\
O \\
\end{pmatrix} - \begin{pmatrix}
O \\
g \circ 1^{*} \\
\end{pmatrix} - \begin{pmatrix}
{}^t \left( J_{g} \circ 1^{*} \right)1_{*} \\
O \\
\end{pmatrix}\\
&= \begin{pmatrix}
\mathrm{grad}f \circ 1^{*} -{}^t \left( J_{g} \circ 1^{*} \right)1_{*} \\
 - g \circ 1^{*} \\
\end{pmatrix}
\end{align*}
したがって、次のようになる。
\begin{align*}
\mathrm{grad}\varPhi\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} &= \begin{pmatrix}
\mathrm{grad}f \circ 1^{*} -{}^t \left( J_{g} \circ 1^{*} \right)1_{*} \\
 - g \circ 1^{*} \\
\end{pmatrix}\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix}\\
&= \begin{pmatrix}
\mathrm{grad}f \circ 1^{*}\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} -{}^t \left( J_{g} \circ 1^{*} \right)\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix}1_{*}\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} \\
 - g \circ 1^{*}\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} \\
\end{pmatrix}\\
&= \begin{pmatrix}
\mathrm{grad}f\left( \mathbf{a} \right) - \mathrm{grad}f\left( \mathbf{a} \right) \\
 - g\left( \mathbf{a} \right) \\
\end{pmatrix}\\
&= \begin{pmatrix}
\mathbf{0} \\
\mathbf{- 0} \\
\end{pmatrix} = \mathbf{0}
\end{align*}
よって、$\exists\mathbf{l} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}\varPhi\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} = \mathbf{0}$が成り立つ。\par
あとは明らかであろう。
\end{proof}
%\hypertarget{ux6975ux5024ux306eux8a08ux7b97ux4f8b}{%
\subsubsection{極値の計算例}%\label{ux6975ux5024ux306eux8a08ux7b97ux4f8b}}\par
極値を求める際に便利な定理たちを挙げよう。
\begin{dfn*}[定義\ref{首座小行列}の再掲]
行列$B$が$B = \left( b_{ij} \right)_{(i,j) \in \varLambda_{n}^{2}}$と与えられたとき、$\forall k \in \varLambda_{n}$に対し、次のような写像$P_{k}$によるその行列$B$の像を$k$次首座小行列という。
\begin{align*}
P_{k}:M_{nn}\left( \mathbb{R} \right) \rightarrow M_{kk}\left( \mathbb{R} \right);B \mapsto \left( b_{ij} \right)_{(i,j) \in \varLambda_{k}^{2}}
\end{align*}
\end{dfn*}
\begin{thm*}[定理\ref{4.4.3.1}の再掲]
$D(f) \subseteq \mathbb{R}^{n}$なる関数$f:D(f) \rightarrow \mathbb{R}$が与えられたとき、その集合$D(f)の内点\mathbf{a}$で極値をとりその関数$f$がその点$\mathbf{a}$で微分可能であるなら、$\forall i \in \varLambda_{n}$に対し、次式が成り立つ。
\begin{align*}
\partial_{i}f\left( \mathbf{a} \right) = 0
\end{align*}\par
これにより、その点$\mathbf{a}$はその関数$f$の停留点であり、さらに、$(df)_{\mathbf{a}} = 0$が成り立つ。
\end{thm*}
\begin{thm*}[定理\ref{4.4.3.11}の再掲]
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{2}$級の関数$f:U \rightarrow \mathbb{R}$の停留点$\mathbf{a}$が与えられたとき、次のことが成り立つ。
\begin{itemize}
\item
  2次形式$\left( d^{2}f \right)_{\mathbf{a}}$が正値であるなら、その点$\mathbf{a}$はその関数$f$の狭義の極小点である。
\item
  2次形式$\left( d^{2}f \right)_{\mathbf{a}}$が負値であるなら、その点$\mathbf{a}$はその関数$f$の狭義の極大点である。
\item
  2次形式$\left( d^{2}f \right)_{\mathbf{a}}$が不定符号であるなら、その点$\mathbf{a}$はその関数$f$の極小点でも極大点でもない。
\end{itemize}
\end{thm*}
\begin{thm*}[定理\ref{4.4.3.12}の再掲]
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{2}$級の関数$f:U \rightarrow \mathbb{R}$の停留点$\mathbf{a}$が与えられたとき、$k \in \varLambda_{n}$として、次式のように関数$D_{k}$が定義されれば、
\begin{align*}
D_{k}:U \rightarrow \mathbb{R};\mathbf{x} \mapsto \det{\left( P_{k} \circ H_{f} \right)\left( \mathbf{x} \right)}
\end{align*}
次のことが成り立つ。
\begin{itemize}
\item
  $\forall k \in \varLambda_{n}$に対し、$0 < D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極小点である。
\item
  $\forall k \in \varLambda_{n}$に対し、$0 < ( - 1)^{k}D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極大点である。
\item
  $D_{n}\left( \mathbf{a} \right) \neq 0$が成り立つかつ、$\exists k \in \varLambda_{n}$に対し、$0 \geq D_{k}\left( \mathbf{a} \right)$が成り立つかつ、$\exists k \in \varLambda_{n}$に対し、$0 \geq ( - 1)^{k}D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の極小点でも極大点でもない。
\end{itemize}
\end{thm*}
\begin{thm*}[定理\ref{4.4.3.13}の再掲]
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{2}$級の関数$f:U \rightarrow \mathbb{R}$の正則停留点$\mathbf{a}$が与えられたとき、$k \in \varLambda_{n}$として、次式のように関数$D_{k}$が定義されれば、
\begin{align*}
D_{k}:U \rightarrow \mathbb{R};\mathbf{x} \mapsto \det{\left( P_{k} \circ H_{f} \right)\left( \mathbf{x} \right)}
\end{align*}
次のことが成り立つ。
\begin{itemize}
\item
  $\forall k \in \varLambda_{n}$に対し、$0 < D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極小点である。
\item
  $\forall k \in \varLambda_{n}$に対し、$0 < ( - 1)^{k}D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極大点である。
\item
  上のこといずれも満たさないなら、その点$\mathbf{a}$はその関数$f$の極小点でも極大点でもない。
\end{itemize}
\end{thm*}
\begin{thm*}[定理\ref{4.4.4.3}の再掲]
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級の関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$S = \left\{ \mathbf{x} \in U \middle| g\left( \mathbf{x} \right) = \mathbf{0} \right\}$において、その関数$f$がその集合$S$上の極値$f\left( \mathbf{a} \right)$をとるなら、次のいづれかが成り立つ。
\begin{itemize}
\item
  次式のような関数$\varPhi$が用いられれば、
\begin{align*}
\varPhi:U \times \mathbb{R}^{n} \rightarrow \mathbb{R};\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} \mapsto f\left( \mathbf{x} \right) -{}^t \mathbf{y}g\left( \mathbf{x} \right)
\end{align*}
$\exists\mathbf{l} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}\varPhi\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} = \mathbf{0}$が成り立つ。
\item
  $\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} < n$が成り立つ。
\end{itemize}
\end{thm*}\par
そこで、補題として次のようなものを挙げておこう。
\begin{thm}\label{4.4.4.4}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級の関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられており、さらに、よりよい陰関数定理での仮定が満たされており、ある近傍$V \times W \subseteq \mathbb{R}^{n} \times \mathbb{R}^{m - n}$とある関数$\varphi:V \rightarrow W$が存在して、次式が成り立つようにすることができるとして、
\begin{align*}
\mathbf{x} = \begin{pmatrix}
\mathbf{x}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} \in S \Leftrightarrow g\left( \mathbf{x} \right) = \mathbf{0} \Leftrightarrow \mathbf{x}_{*} = \varphi\left( \mathbf{x}^{*} \right)
\end{align*}
次のようにおくと、
\begin{align*}
\nabla^{*} = \left( \partial_{i} \right)_{i \in \varLambda_{n}}&,\ \ \nabla_{*} = \left( \partial_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{n}} \\
{}^t \partial_{j}\varphi\left( \nabla_{*}{}^t \nabla_{*} \otimes g \right)\partial_{i}\varphi &= \left({}^t \partial_{j}\varphi\left( \nabla_{*}{}^t \nabla_{*}g_{k} \right)\partial_{i}\varphi \right)_{k \in \varLambda_{n}} \\
\varphi_{\downarrow}:V &\rightarrow U;\mathbf{x}^{*} \mapsto \begin{pmatrix}
\mathbf{x}^{*} \\
\varphi\left( \mathbf{x}^{*} \right) \\
\end{pmatrix}
\end{align*}
次のことが成り立つ。
\begin{itemize}
\item
  次式が成り立つ。
\begin{align*}
J_{\varphi} ={}^t \left( \nabla^{*}{}^t \varphi \right) = - \left({}^t \left( \nabla_{*}{}^{t}g \right)^{- 1}{}^{t}\left( \nabla^{*}{}^t g \right) \right) \circ \varphi_{\downarrow}
\end{align*}
\item
  $\forall(i,j) \in \varLambda_{n}^{2}$に対し、次式が成り立つ。
\begin{align*}
\partial_{ji}\varphi &= - \left( J_{g} \circ \varphi_{\downarrow} \right)^{- 1}\left( \partial_{ji}g \circ \varphi_{\downarrow} + \left( \partial_{j}J_{g} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi \right. \\
&\quad \left. + \left( \partial_{i}J_{g} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi +{}^t \partial_{j}\varphi\left( \nabla_{*}{}^{t}\nabla_{*} \otimes g \right)\partial_{i}\varphi \right)
\end{align*}
\end{itemize}
さらに、$F = f \circ \varphi_{\downarrow}:V \rightarrow \mathbb{R}$と関数$F$が定義されるとき、次のようにおくと、
\begin{align*}
{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\left( \nabla^{*}{}^t \nabla^{*} \otimes \varphi \right) = \left({}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi \right)_{(i,j) \in \varLambda_{n}^{2}}
\end{align*}
次のことが成り立つ。
\begin{itemize}
\item
  $\forall i \in \varLambda_{n}$に対し、次式が成り立つ。
\begin{align*}
\partial_{i}F = \partial_{i}f \circ \varphi_{\downarrow} +{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi
\end{align*}
\item
  次式が成り立つ。
\begin{align*}
J_{F} ={}^t \left( \nabla^{*}{}^t F \right) = \nabla^{*}f \circ \varphi_{\downarrow} + \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\nabla^{*}\varphi
\end{align*}
\item
  $\forall(i,j) \in \varLambda_{n}^{2}$に対し、次式が成り立つ。
\begin{align*}
\partial_{ji}F &= \partial_{ji}f \circ \varphi_{\downarrow} +{}^t \left( \partial_{i}\nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi +{}^t \left( \nabla_{*}\partial_{j}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi \\
&\quad +{}^t \partial_{i}\varphi\left( \nabla_{*}{}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi +{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi
\end{align*}
\item
  次式が成り立つ。
\begin{align*}
H_{F} &= \nabla^{*}{}^t \nabla^{*}f \circ \varphi_{\downarrow} + \left( \nabla^{*}{}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\nabla^{*}\varphi + \nabla^{*}\varphi\left( \nabla_{*}{}^t \nabla^{*}f \circ \varphi_{\downarrow} \right) \\
&\quad +{}^t \left( \nabla^{*}{}^t \varphi \right)\left( \nabla_{*}{}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\left( \nabla^{*}{}^t \varphi \right) +{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\left( \nabla^{*}{}^t \nabla^{*} \otimes \varphi \right)
\end{align*}
\end{itemize}
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられており、さらに、よりよい陰関数定理での仮定が満たされており、ある近傍$V \times W \subseteq \mathbb{R}^{n} \times \mathbb{R}^{m - n}$とある関数$\varphi = \left( \varphi_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{n}}:V \rightarrow W$が存在して、次式が成り立つようにすることができるとする。
\begin{align*}
\mathbf{x} = \begin{pmatrix}
\mathbf{x}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} \in S \Leftrightarrow g\left( \mathbf{x} \right) = \mathbf{0} \Leftrightarrow \mathbf{x}_{*} = \varphi\left( \mathbf{x}^{*} \right)
\end{align*}
以下ここでは、記法の煩雑さを避けるため、Einstein縮約記法を用い、即ち、同じ添数が2回現れたとき、その添数が属する添数集合だけ和をとることに約束し、添数集合$\varLambda_{n}$の添数として、$\alpha^{*}$、$\beta^{*}$、$\gamma^{*}$、添数集合$\varLambda_{m} \setminus \varLambda_{n}$の添数として、$\alpha$、$\beta$、$\gamma$、$\delta$を用いることにする。\par
さて、次のようにおくと、
\begin{align*}
\nabla^{*} = \left( \partial_{i} \right)_{i \in \varLambda_{n}}&,\ \ \nabla_{*} = \left( \partial_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{n}} \\
\left({}^t \partial_{i}\varphi\nabla_{*}{}^t \nabla_{*}\partial_{j}\varphi \right) \otimes g &= \left({}^t \partial_{i}\varphi\left( \nabla_{*}{}^t \nabla_{*}g_{k} \right)\partial_{j}\varphi \right)_{k \in \varLambda_{n}} \\
\varphi_{\downarrow} = \left( \varphi_{i}^{\downarrow} \right)_{i \in \varLambda_{m}}:V &\rightarrow U;\mathbf{x}^{*} \mapsto \begin{pmatrix}
\mathbf{x}^{*} \\
\varphi\left( \mathbf{x}^{*} \right) \\
\end{pmatrix}
\end{align*}
その関数$\varphi$のJacobi行列はよりよい陰関数定理より次のようになる。
\begin{align*}
J_{\varphi} ={}^t \left( \nabla^{*}{}^t \varphi \right) = - \left({}^t \left( \nabla_{*}{}^{t}g \right)^{- 1}{}^{t}\left( \nabla^{*}{}^t g \right) \right) \circ \varphi_{\downarrow}
\end{align*}
実際、$g \circ \varphi_{\downarrow}:V \rightarrow \mathbb{R}^{n} = 0$より、${}^t \left( \nabla_{*}{}^t g \right)^{- 1} = \left( \left( \partial_{j}g_{i} \right)^{- 1} \right)_{(i,j) \in \left( \varLambda_{m} \setminus \varLambda_{n} \right)^{2}}$とおかれれば、$\forall(i,j) \in \left( \varLambda_{m} \setminus \varLambda_{n} \right) \times \varLambda_{n}$に対し、次のようになることから従う\footnote{次のようにしても示すことができる。
\begin{align*}
0 &= J_{g \circ \varphi_{\downarrow}} = \left( J_{g} \circ \varphi_{\downarrow} \right)J_{\varphi_{\downarrow}} \\
&= \begin{pmatrix}
  {}^t \left( \nabla^{*}{}^t g \right) \circ \varphi_{\downarrow} &{}^{t}\left( \nabla_{*}{}^{t}g \right) \circ \varphi_{\downarrow} \\
\end{pmatrix}\begin{pmatrix}
  I_{n} \\
  J_{\varphi} \\
\end{pmatrix}\\ 
&={}^t \left( \nabla^{*}{}^t g \right) \circ \varphi_{\downarrow} +{}^t \left( \nabla_{*}{}^{t}g \right) \circ \varphi_{\downarrow}J_{\varphi}
\end{align*}}。
\begin{align*}
\partial_{j}\varphi_{i} &= \delta_{i\alpha}\partial_{j}\varphi_{\alpha}\\
&= \left( \left( \partial_{\alpha}g_{i} \right)^{- 1}\partial_{\beta}g_{\alpha} \right) \circ \varphi_{\downarrow}\partial_{j}\varphi_{\beta}\\
&= \left( \partial_{\alpha}g_{i} \right)^{- 1} \circ \varphi_{\downarrow}\left( \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} + \left( \partial_{\beta}g_{\alpha} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} - \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\alpha}g_{i} \right)^{- 1} \circ \varphi_{\downarrow}\left( \left( \partial_{\beta^{*}}g_{\alpha} \circ \varphi_{\downarrow} \right)\delta_{\beta^{*}j} + \left( \partial_{\beta}g_{\alpha} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} - \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\alpha}g_{i} \right)^{- 1} \circ \varphi_{\downarrow}\left( \left( \partial_{\beta^{*}}g_{\alpha} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta^{*}} + \left( \partial_{\beta}g_{\alpha} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} - \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\alpha}g_{i} \right)^{- 1} \circ \varphi_{\downarrow}\left( \partial_{j}\left( g_{\alpha} \circ \varphi_{\downarrow} \right) - \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\alpha}g_{i} \right)^{- 1} \circ \varphi_{\downarrow}\left( - \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} \right)\\
&= - \left( \left( \partial_{\alpha}g_{i} \right)^{- 1} \circ \varphi_{\downarrow} \right)\left( \partial_{j}g_{\alpha} \circ \varphi_{\downarrow} \right)
\end{align*}\par
一方で、$g \circ \varphi_{\downarrow}:V \rightarrow \mathbb{R}^{n} = 0$が成り立つので、$\forall(i,j) \in \varLambda_{n}^{2}$に対し、第$k$成分でみれば次のようになる。
\begin{align*}
0 &= \partial_{ji}\left( g_{k} \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\beta^{*}\alpha^{*}}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha^{*}}^{\downarrow}\partial_{j}\varphi_{\beta^{*}}^{\downarrow} + \left( \partial_{\beta\alpha^{*}}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha^{*}}^{\downarrow}\partial_{j}\varphi_{\beta}^{\downarrow} \\
&\quad + \left( \partial_{\beta^{*}\alpha}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}^{\downarrow}\partial_{j}\varphi_{\beta^{*}}^{\downarrow} + \left( \partial_{\beta\alpha}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}^{\downarrow}\partial_{j}\varphi_{\beta}^{\downarrow} \\
&\quad + \left( \partial_{\gamma^{*}}g_{k} \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma^{*}}^{\downarrow} + \left( \partial_{\gamma}g_{k} \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}^{\downarrow}\\
&= \left( \partial_{\beta^{*}\alpha^{*}}g_{k} \circ \varphi_{\downarrow} \right)\delta_{\alpha^{*}i}\delta_{\beta^{*}j} + \left( \partial_{\beta\alpha^{*}}g_{k} \circ \varphi_{\downarrow} \right)\delta_{\alpha^{*}i}\partial_{j}\varphi_{\beta} \\
&\quad + \left( \partial_{\beta^{*}\alpha}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\delta_{\beta^{*}j} + \left( \partial_{\beta\alpha}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} \\
&\quad + \left( \partial_{\gamma}g_{k} \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}\\
&= \partial_{ji}g_{k} \circ \varphi_{\downarrow} + \left( \partial_{\beta i}g_{k} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} + \left( \partial_{j\alpha}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} \\
&\quad + \left( \partial_{\beta\alpha}g_{k} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} + \left( \partial_{\gamma}g_{k} \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}
\end{align*}
これにより、次のようになる。
\begin{align*}
\partial_{ji}\varphi_{k} &= \delta_{k\gamma}\partial_{ji}\varphi_{\gamma}\\
&= \left( \left( \partial_{\delta}g_{k} \right)^{- 1}\partial_{\gamma}g_{\delta} \right) \circ \varphi_{\downarrow}\partial_{ji}\varphi_{\gamma}\\
&= \left( \left( \partial_{\delta}g_{k} \right)^{- 1} \circ \varphi_{\downarrow} \right)\left( \partial_{\gamma}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}\\
&= \left( \partial_{\delta}g_{k} \right)^{- 1} \circ \varphi_{\downarrow}\left( \partial_{ji}g_{\delta} \circ \varphi_{\downarrow} + \left( \partial_{\beta i}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} \right. \\
&\quad + \left( \partial_{j\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} + \left( \partial_{\beta\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} + \left( \partial_{\gamma}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma} \\
&\quad - \partial_{ji}g_{\delta} \circ \varphi_{\downarrow} - \left( \partial_{\beta i}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} \\
&\quad \left. - \left( \partial_{j\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} - \left( \partial_{\beta\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} \right)\\
&= \left( \partial_{\delta}g_{k} \right)^{- 1} \circ \varphi_{\downarrow}\left( - \partial_{ji}g_{\delta} \circ \varphi_{\downarrow} - \left( \partial_{\beta i}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} \right. \\
&\quad \left. - \left( \partial_{j\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} - \left( \partial_{\beta\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} \right)\\
&= - \left( \partial_{\delta}g_{k} \right)^{- 1} \circ \varphi_{\downarrow}\left( \partial_{ji}g_{\delta} \circ \varphi_{\downarrow} + \left( \partial_{\beta i}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} \right. \\
&\quad \left. + \left( \partial_{j\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} + \left( \partial_{\beta\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} \right)\\
&= - \left( \partial_{\delta}g_{k} \right)^{- 1} \circ \varphi_{\downarrow}\left( \partial_{ji}g_{\delta} \circ \varphi_{\downarrow} + \left( \partial_{\beta i}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} \right. \\
&\quad \left. + \left( \partial_{j\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} + \left( \partial_{\beta\alpha}g_{\delta} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} \right)
\end{align*}
これにより、次式が成り立つ。
\begin{align*}
\partial_{ji}\varphi &= - \left( J_{g} \circ \varphi_{\downarrow} \right)^{- 1}\left( \partial_{ji}g \circ \varphi_{\downarrow} + \left( \partial_{j}J_{g} \circ \varphi_{\downarrow} \right)\partial_{i}\varphi \right. \\
&\quad \left. + \left( \partial_{i}J_{g} \circ \varphi_{\downarrow} \right)\partial_{j}\varphi + \left({}^t \partial_{j}\varphi\nabla_{*}{}^{t}\nabla_{*}\partial_{i}\varphi \right) \otimes g \right)
\end{align*}\par
さらに、$F = f \circ \varphi_{\downarrow}:V \rightarrow \mathbb{R}$と関数$F$が定義されるとき、$\forall i \in \varLambda_{n}$に対し、次のようになる。
\begin{align*}
\partial_{i}F &= \partial_{i}\left( f \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\alpha^{*}}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha^{*}}^{\downarrow} + \left( \partial_{\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}^{\downarrow}\\
&= \left( \partial_{\alpha^{*}}f \circ \varphi_{\downarrow} \right)\delta_{\alpha^{*}i} + \left( \partial_{\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\\
&= \partial_{i}f \circ \varphi_{\downarrow} + \left( \partial_{\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\\
&= \partial_{i}f \circ \varphi_{\downarrow} +{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi
\end{align*}
したがって、次式が成り立つ。
\begin{align*}
J_{F} ={}^t \left( \nabla^{*}{}^t F \right) = \nabla^{*}f \circ \varphi_{\downarrow} + \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\nabla^{*}\varphi
\end{align*}\par
次のようにおくと、
\begin{align*}
{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\left( \nabla^{*}{}^t \nabla^{*} \otimes \varphi \right) = \left({}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi \right)_{(i,j) \in \varLambda_{n}^{2}}
\end{align*}
$\forall(i,j) \in \varLambda_{n}^{2}$に対し、次のようになる。
\begin{align*}
\partial_{ji}F &= \partial_{ji}\left( f \circ \varphi_{\downarrow} \right)\\
&= \left( \partial_{\beta^{*}\alpha^{*}}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha^{*}}^{\downarrow}\partial_{j}\varphi_{\beta^{*}}^{\downarrow} + \left( \partial_{\beta\alpha^{*}}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha^{*}}^{\downarrow}\partial_{j}\varphi_{\beta}^{\downarrow} \\
&\quad + \left( \partial_{\beta^{*}\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}^{\downarrow}\partial_{j}\varphi_{\beta^{*}}^{\downarrow} + \left( \partial_{\beta\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}^{\downarrow}\partial_{j}\varphi_{\beta}^{\downarrow} \\
&\quad + \left( \partial_{\gamma^{*}}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma^{*}}^{\downarrow} + \left( \partial_{\gamma}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}^{\downarrow}\\
&= \left( \partial_{\beta^{*}\alpha^{*}}f \circ \varphi_{\downarrow} \right)\delta_{\alpha^{*}i}\delta_{\beta^{*}j} + \left( \partial_{\beta\alpha^{*}}f \circ \varphi_{\downarrow} \right)\delta_{\alpha^{*}i}\partial_{j}\varphi_{\beta} \\
&\quad + \left( \partial_{\beta^{*}\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\delta_{\beta^{*}j} + \left( \partial_{\beta\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} \\
&\quad + \left( \partial_{\gamma}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}\\
&= \partial_{ji}f \circ \varphi_{\downarrow} + \left( \partial_{\beta i}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} + \left( \partial_{j\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} \\
&\quad + \left( \partial_{\beta\alpha}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha}\partial_{j}\varphi_{\beta} + \left( \partial_{\gamma}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}\\
&= \partial_{ji}f \circ \varphi_{\downarrow} + \left( \partial_{i}\partial_{\beta}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} + \left( \partial_{\alpha}\partial_{j}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi_{\alpha} \\
&\quad + \partial_{i}\varphi_{\alpha}\left( \partial_{\beta\alpha}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi_{\beta} + \left( \partial_{\gamma}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi_{\gamma}\\
&= \partial_{ji}f \circ \varphi_{\downarrow} +{}^t \left( \partial_{i}\nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi +{}^t \left( \nabla_{*}\partial_{j}f \circ \varphi_{\downarrow} \right)\partial_{i}\varphi \\
&\quad +{}^t \partial_{i}\varphi\left( \nabla_{*}{}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{j}\varphi +{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\partial_{ji}\varphi
\end{align*}
したがって、次式が成り立つ。
\begin{align*}
H_{F} &= \nabla^{*}{}^t \nabla^{*}f \circ \varphi_{\downarrow} + \left( \nabla^{*}{}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\nabla^{*}\varphi + \nabla^{*}\varphi\left( \nabla_{*}{}^t \nabla^{*}f \circ \varphi_{\downarrow} \right) \\
&\quad +{}^t \left( \nabla^{*}{}^t \varphi \right)\left( \nabla_{*}{}^t \nabla_{*}f \circ \varphi_{\downarrow} \right)\left( \nabla^{*}{}^t \varphi \right) +{}^t \left( \nabla_{*}f \circ \varphi_{\downarrow} \right)\left( \nabla^{*}{}^t \nabla^{*} \otimes \varphi \right)
\end{align*}
\end{proof}\par
この定理から、$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{2}$級関数$f:U \rightarrow \mathbb{R}$が与えられたとき、その関数$f$の極値を求めてみよう。これは次の手順で求められる。
\begin{enumerate}
\item
  $\forall i,j \in \varLambda_{n}$に対し、偏導関数たち$\partial_{i}f$、$\partial_{ji}f$を求めておく。
\item
  $\mathrm{grad}f\left( \mathbf{a} \right) = \mathbf{0}$なる点$\mathbf{a}$を1.
  を用いて求める。これが停留点となる。
\item
  $k \in \varLambda_{n}$として、次式のように関数$D_{k}$を定義してこれを1.
  を用いて求めておく。
\begin{align*}
D_{k}:U \rightarrow \mathbb{R};\mathbf{x} \mapsto \det\left( \partial_{ji}f\left( \mathbf{x} \right) \right)_{(i,j) \in \varLambda_{k}^{2}}
\end{align*}
\item
  上で求めた停留点のうち、$\forall k \in \varLambda_{n}$に対し、$0 < D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極小点であることが定理\ref{4.4.3.12}より分かる。
\item
  上で求めた停留点のうち、$\forall k \in \varLambda_{n}$に対し、$0 < ( - 1)^{k}D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極大点であることが定理\ref{4.4.3.12}より分かる。
\item
  $D_{n}\left( \mathbf{a} \right) \neq 0$が成り立つとき、4. 、5. いづれも満たさなければ、定理\ref{4.4.3.13}よりその点$\mathbf{a}$はその関数$f$の極小点でも極大点でもないことが分かる。
\item
  $D_{n}\left( \mathbf{a} \right) = 0$が成り立つとき、2次形式$\left( d^{2}f \right)_{\mathbf{a}}$が不定符号であるなら、定理\ref{4.4.3.11}よりその点$\mathbf{a}$はその関数$f$の極小点でも極大点でもないことが分かる。
\item
  $D_{n}\left( \mathbf{a} \right) = 0$が成り立つとき、2次形式$\left( d^{2}f \right)_{\mathbf{a}}$が不定符号でないなら、その点$\mathbf{a}$はその関数$f$の極値をとる点なのかどうかは今までの議論で判断できないことが分かる。
\end{enumerate}\par
この定理から、$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数たち$f:U \rightarrow \mathbb{R}$、$g:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$g\left( \mathbf{x} \right) = \mathbf{0}$の条件の下でその関数$f$の極値を求めてみよう。これは次の手順で求められる。
\begin{enumerate}
\item
  $\forall i,j \in \varLambda_{m}$に対し、偏導関数たち$\partial_{i}f$、$\partial_{ji}f$、$\partial_{i}g$、$\partial_{ji}g$を求めておく。
\item
  $\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} < n$が成り立つような点$\mathbf{a}$を求める。
\item
  上で求めた点$\mathbf{a}$のうち$g\left( \mathbf{a} \right) = \mathbf{0}$が成り立つようなものが極値をとる点でありうる。
\item
  次式のような関数$\varPhi$を用いて
\begin{align*}
\varPhi:U \times \mathbb{R}^{n} \rightarrow \mathbb{R};\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} \mapsto f\left( \mathbf{x} \right) -{}^t \mathbf{y}g\left( \mathbf{x} \right)
\end{align*}
$\exists\mathbf{l} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}\varPhi\begin{pmatrix}
\mathbf{a} \\
\mathbf{l} \\
\end{pmatrix} = \mathbf{0}$が成り立つような点$\mathbf{a}$を求める。
\item
  上で求めた点$\mathbf{a}$のうち$g\left( \mathbf{a} \right) = \mathbf{0}$が成り立つようなものが極値をとる点でありうる。
\item
  3. 、5. よりこれで極値をとりうる点がすべて求まった。
\item
  陰関数定理より次式が成り立つようにすることができるので、
\begin{align*}
\mathbf{x} = \begin{pmatrix}
\mathbf{x}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} \in S \Leftrightarrow g\left( \mathbf{x} \right) = \mathbf{0} \Leftrightarrow \mathbf{x}_{*} = \varphi\left( \mathbf{x}^{*} \right)
\end{align*}
次式のように関数$F$が定義されると、
\begin{align*}
F:V \rightarrow \mathbb{R};\mathbf{x}^{*} \mapsto f\begin{pmatrix}
\mathbf{x}^{*} \\
\varphi\left( \mathbf{x}^{*} \right) \\
\end{pmatrix}
\end{align*}
$\mathbf{x} = \mathbf{a} = \begin{pmatrix}
\mathbf{a}^{*} \\
\mathbf{a}_{*} \\
\end{pmatrix}$のときその関数$f$はその集合$S$上の極値をとるので、$\mathbf{x}^{*} = \mathbf{a}^{*}$のとき、その関数$F$は極値をとることに注意する。
\item
  定理\ref{4.4.4.4}より6. における極値の候補となっている点$\mathbf{a}$でのその陰関数$\varphi$のJacobi行列$J_{\varphi}$とHesse行列$H_{\varphi}$の値を求める。
\item
  定理\ref{4.4.4.4}より6. における極値の候補となっている点$\mathbf{a}$でのその関数$F$のJacobi行列$J_{F}$とHesse行列$H_{F}$の値を8. を用いて求める。
\item
  あとは関数$F$の極値を前述した手順で求める。
\end{enumerate}\par
まず、簡単な例から考えよう。関数$f\begin{pmatrix}
x \\
y \\
\end{pmatrix} = x^{3} + y^{3} + 3xy + 2$の極値を求めてみよう。次のようになることから\footnote{1. の「$\forall i,j \in \varLambda_{n}$に対し、偏導関数たち$\partial_{i}f$、$\partial_{ji}f$を求めておく。」にあたります。}、
\begin{align*}
\frac{\partial f}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 3x^{2} + 3y,\ \ \frac{\partial f}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 3y^{2} + 3x,
\end{align*}
\begin{align*}
\frac{\partial^{2}f}{{\partial x}^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 6x,\ \ \frac{\partial^{2}f}{\partial x\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 3,\ \ \frac{\partial^{2}f}{{\partial y}^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 6y
\end{align*}
$\mathrm{grad}f\begin{pmatrix}
x \\
y \\
\end{pmatrix} = \begin{pmatrix}
3x^{2} + 3y \\
3y^{2} + 3x \\
\end{pmatrix}$より$x^{2} + y = y^{2} + x = 0$なる点$\begin{pmatrix}
x \\
y \\
\end{pmatrix}$が停留点である。なお、偏微分の順序の入れ替えができることに注意されたい。これを求めると、点々$\begin{pmatrix}
 - 1 \\
 - 1 \\
\end{pmatrix}$、$\begin{pmatrix}
0 \\
0 \\
\end{pmatrix}$が得られる\footnote{2. の「$\mathrm{grad}f\left( \mathbf{a} \right) = \mathbf{0}$なる点$\mathbf{a}$を1. を用いて求める。これが停留点となる。」にあたります。}。このとき、次のようになることから\footnote{3. の「$k \in \varLambda_{n}$として、次式のように関数$D_{k}$を定義してこれを1. を用いて求めておく。」にあたります。
\begin{align*}
D_{k}:U \rightarrow \mathbb{R};\mathbf{x} \mapsto \det\left( \partial_{ji}f\left( \mathbf{x} \right) \right)_{(i,j) \in \varLambda_{k}^{2}}
\end{align*}}、
\begin{align*}
D_{1}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = \left| \frac{\partial^{2}f}{{\partial x}^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} \right| = 6x,
\end{align*}
\begin{align*}
D_{2}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = \left| \begin{matrix}
\frac{\partial^{2}f}{{\partial x}^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} & \frac{\partial^{2}f}{\partial x\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} \\
\frac{\partial^{2}f}{\partial y\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} & \frac{\partial^{2}f}{{\partial y}^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} \\
\end{matrix} \right| = \left| \begin{matrix}
6x & 3 \\
3 & 6y \\
\end{matrix} \right| = 9\left| \begin{matrix}
2x & 1 \\
1 & 2y \\
\end{matrix} \right| = 9(4xy - 1)
\end{align*}
次のようになる。
\begin{align*}
D_{1}\begin{pmatrix}
0 \\
0 \\
\end{pmatrix} = 0,\ \ D_{2}\begin{pmatrix}
0 \\
0 \\
\end{pmatrix} = - 9,\ \ D_{1}\begin{pmatrix}
 - 1 \\
 - 1 \\
\end{pmatrix} = - 6,\ \ D_{2}\begin{pmatrix}
 - 1 \\
 - 1 \\
\end{pmatrix} = 27
\end{align*}
ゆえに、$D_{2}\begin{pmatrix}
 - 1 \\
 - 1 \\
\end{pmatrix} = 27 > 0$、$- D_{1}\begin{pmatrix}
 - 1 \\
 - 1 \\
\end{pmatrix} = 6 > 0$が成り立つので、点$\begin{pmatrix}
 - 1 \\
 - 1 \\
\end{pmatrix}$でその関数$f$は極大値をとる\footnote{5. の「上で求めた停留点のうち、$\forall k \in \varLambda_{n}$に対し、$0 < ( - 1)^{k}D_{k}\left( \mathbf{a} \right)$が成り立つなら、その点$\mathbf{a}$はその関数$f$の狭義の極大点であることが定理\ref{4.4.3.12}より分かる。」にあたります。}。一方で、$D_{2}\begin{pmatrix}
0 \\
0 \\
\end{pmatrix} \neq 0$で$D_{1}\begin{pmatrix}
0 \\
0 \\
\end{pmatrix} = 0$が成り立つので、点$\begin{pmatrix}
0 \\
0 \\
\end{pmatrix}$でその関数$f$は極値をとらない\footnote{6. の「$D_{n}\left( \mathbf{a} \right) \neq 0$が成り立つとき、4. 、5. いづれも満たさなければ、定理\ref{4.4.3.13}よりその点$\mathbf{a}$はその関数$f$の極小点でも極大点でもないことが分かる。」にあたります。}。\par
次に少し難しい例で考えよう。$x^{2} + y^{2} = 1$が成り立つとき、関数$f\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2xy$の極値を求めてみよう。$g\begin{pmatrix}
x \\
y \\
\end{pmatrix} = x^{2} + y^{2} - 1$とおくと、次のようになる\footnote{1. の「$\forall i,j \in \varLambda_{n}$に対し、偏導関数たち$\partial_{i}f$、$\partial_{ji}f$、$\partial_{i}g$、$\partial_{ji}g$を求めておく。」にあたります。}。なお、偏微分の順序の入れ替えができることに注意されたい。
\begin{align*}
\frac{\partial f}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2y&,\ \ \frac{\partial f}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2x,\\
\frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 0,\ \ \frac{\partial^{2}f}{\partial x\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} &= 2,\ \ \frac{\partial^{2}f}{\partial y^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 0,\\
\frac{\partial g}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2x&,\ \ \frac{\partial g}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2y,\\
\frac{\partial^{2}g}{\partial x^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2,\ \ \frac{\partial^{2}g}{\partial x\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} &= 0,\ \ \frac{\partial^{2}g}{\partial y^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 2
\end{align*}
$\mathrm{rank}{J_{g}\begin{pmatrix}
x \\
y \\
\end{pmatrix}} < 1$なる点を求めると、次のようになることから、
\begin{align*}
J_{g}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = \begin{pmatrix}
\frac{\partial g}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} & \frac{\partial g}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} \\
\end{pmatrix} = \begin{pmatrix}
2x & 2y \\
\end{pmatrix}
\end{align*}
点$\begin{pmatrix}
0 \\
0 \\
\end{pmatrix}$が得られる\footnote{2. の「$\mathrm{rank}{J_{g}\left( \mathbf{a} \right)} < n$が成り立つような点$\mathbf{a}$を求める。」にあたります。}。しかしながら、$g\begin{pmatrix}
0 \\
0 \\
\end{pmatrix} \neq 0$となっているので、この点$\begin{pmatrix}
0 \\
0 \\
\end{pmatrix}$は極値をとりうる点ではない\footnote{3. の「上で求めた点$\mathbf{a}$のうち$g\left( \mathbf{a} \right) = \mathbf{0}$が成り立つようなものが極値をとる点でありうる。」にあたります。}。以下、$\begin{pmatrix}
x \\
y \\
\end{pmatrix} \neq \begin{pmatrix}
0 \\
0 \\
\end{pmatrix}$とおきLagrangeの未定乗数法より$\exists\lambda \in \mathbb{R}$に対し、次を満たす点を求めていくと、
\begin{align*}
x^{2} + y^{2} = 1,\ \ \frac{\partial f}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} - \lambda\frac{\partial g}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 0,\ \ \frac{\partial f}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} - \lambda\frac{\partial g}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 0
\end{align*}
実数$\lambda$を消去して点々$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$が得られる\footnote{4. の「次式のような関数$\varPhi$を用いて
\begin{align*}
\varPhi:U \times \mathbb{R}^{n} \rightarrow \mathbb{R};\begin{pmatrix}
  \mathbf{x} \\
  \mathbf{y} \\
\end{pmatrix} \mapsto f\left( \mathbf{x} \right) -{}^t \mathbf{y}g\left( \mathbf{x} \right)
\end{align*}
  $\exists\mathbf{l} \in \mathbb{R}^{n}$に対し、$\mathrm{grad}\varPhi\begin{pmatrix}
  \mathbf{a} \\
  \mathbf{l} \\
  \end{pmatrix} = \mathbf{0}$が成り立つような点$\mathbf{a}$を求める。」にあたります。}。さらに、$g\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} = g\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} = g\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} = g\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} = 0$も成り立つ\footnote{5. の「上で求めた点$\mathbf{a}$のうち$g\left( \mathbf{a} \right) = \mathbf{0}$が成り立つようなものが極値をとる点でありうる。」にあたります。}。これにより、それらの点々$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$が極値をとりうる点でありうる。さて、$g\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 0 \Leftrightarrow y = \varphi(x)$とおくと、次のようになることから、
\begin{align*}
\frac{\partial g}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} &= \frac{\partial g}{\partial\begin{pmatrix}
x \\
y \\
\end{pmatrix}}\begin{pmatrix}
x \\
y \\
\end{pmatrix}\frac{\partial}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix}\\
&= \begin{pmatrix}
\frac{\partial g}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} & \frac{\partial g}{\partial y}\begin{pmatrix}
x \\
y \\
\end{pmatrix} \\
\end{pmatrix}\begin{pmatrix}
\frac{\partial x}{\partial x} \\
\frac{\partial\varphi}{\partial x}(x) \\
\end{pmatrix}\\
&= \begin{pmatrix}
2x & 2y \\
\end{pmatrix}\begin{pmatrix}
1 \\
\frac{\partial\varphi}{\partial x}(x) \\
\end{pmatrix}\\
&= 2x + 2y\frac{\partial\varphi}{\partial x}(x) = 0\\
\frac{\partial^{2}g}{\partial x^{2}}\begin{pmatrix}
x \\
y \\
\end{pmatrix} &= \frac{\partial}{\partial x}\frac{\partial g}{\partial x}\begin{pmatrix}
x \\
y \\
\end{pmatrix} = \frac{\partial}{\partial x}\left( 2x + 2y\frac{\partial\varphi}{\partial x}(x) \right) = 2 + 2\frac{\partial}{\partial x}\left( y\frac{\partial\varphi}{\partial x}(x) \right)\\
&= 2 + 2\left( \frac{\partial\varphi}{\partial x}(x) \right)^{2} + 2y\frac{\partial^{2}\varphi}{\partial x^{2}}(x)\\
&= 2 + 2\left( - \frac{x}{y} \right)^{2} + 2y\frac{\partial^{2}\varphi}{\partial x^{2}}(x)\\
&= 2 + \frac{2x^{2}}{y^{2}} + 2y\frac{\partial^{2}\varphi}{\partial x^{2}}(x) = 0
\end{align*}
次式が得られる。
\begin{align*}
\frac{\partial\varphi}{\partial x}(x) = - \frac{x}{y},\ \ \frac{\partial^{2}\varphi}{\partial x^{2}}(x) = - \frac{x^{2} + y^{2}}{y^{3}}
\end{align*}
したがって、それらの点々$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$それぞれ次のようになる\footnote{8. の「定理\ref{4.4.4.4}より6. における極値の候補となっている点$\mathbf{a}$でのその陰関数$\varphi$のJacobi行列$J_{\varphi}$とHesse行列$H_{\varphi}$の値を求める。」にあたります。}。
\begin{align*}
\frac{\partial\varphi}{\partial x}\left( - \frac{1}{\sqrt{2}} \right) = - 1&,\ \ \frac{\partial\varphi}{\partial x}\left( - \frac{1}{\sqrt{2}} \right) = 1,\\
\frac{\partial\varphi}{\partial x}\left( \frac{1}{\sqrt{2}} \right) = 1&,\ \ \frac{\partial\varphi}{\partial x}\left( \frac{1}{\sqrt{2}} \right) = - 1,\\
\frac{\partial^{2}\varphi}{\partial x^{2}}\left( - \frac{1}{\sqrt{2}} \right) = 2\sqrt{2}&,\ \ \frac{\partial^{2}\varphi}{\partial x^{2}}\left( - \frac{1}{\sqrt{2}} \right) = - 2\sqrt{2},\\
\frac{\partial^{2}\varphi}{\partial x^{2}}\left( \frac{1}{\sqrt{2}} \right) = 2\sqrt{2}&,\ \ \frac{\partial^{2}\varphi}{\partial x^{2}}\left( \frac{1}{\sqrt{2}} \right) = - 2\sqrt{2}
\end{align*}
次に、次のようになることから、
\begin{align*}
\frac{\partial f}{\partial x}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix} &= \frac{\partial g}{\partial\begin{pmatrix}
x \\
y \\
\end{pmatrix}}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix}\frac{\partial}{\partial x}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix} \\
&= \begin{pmatrix}
\frac{\partial f}{\partial x}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix} & \frac{\partial f}{\partial y}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix} \\
\end{pmatrix}\begin{pmatrix}
\frac{\partial x}{\partial x} \\
\frac{\partial\varphi}{\partial x}(x) \\
\end{pmatrix}\\
&= \begin{pmatrix}
2y & 2x \\
\end{pmatrix}\begin{pmatrix}
1 \\
\frac{\partial\varphi}{\partial x}(x) \\
\end{pmatrix} \\
&= 2y + 2x\frac{\partial\varphi}{\partial x}(x)\\
\frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix} &= \frac{\partial}{\partial x}\frac{\partial f}{\partial x}\begin{pmatrix}
x \\
\varphi(x) \\
\end{pmatrix} \\
&= \frac{\partial}{\partial x}\left( 2y + 2x\frac{\partial\varphi}{\partial x}(x) \right) \\
&= 2\frac{\partial\varphi}{\partial x}(x) + 2\frac{\partial}{\partial x}\left( x\frac{\partial\varphi}{\partial x}(x) \right)\\
&= 4\frac{\partial\varphi}{\partial x}(x) + 2x\frac{\partial^{2}\varphi}{\partial x^{2}}(x)
\end{align*}
したがって、次のようになる\footnote{9. の「定理\ref{4.4.4.4}より6. における極値の候補となっている点$\mathbf{a}$でのその関数$F$のJacobi行列$J_{F}$とHesse行列$H_{F}$の値を8. を用いて求める。」にあたります。}。
\begin{align*}
\frac{\partial f}{\partial x}\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} = \frac{\partial f}{\partial x}\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} &= \frac{\partial f}{\partial x}\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} = \frac{\partial f}{\partial x}\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} = 0,\\
\frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} = - 8,\ \ \frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} = 8&,\ \ \frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} = 8,\ \ \frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} = - 8
\end{align*}
もちろん、これらの点々$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$は停留点であることもわかり次式が成り立つので、
\begin{align*}
\frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} < 0,\ \ \frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} > 0,\ \ \frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix} > 0,\ \ \frac{\partial^{2}f}{\partial x^{2}}\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix} < 0
\end{align*}
これらの点々$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
 - {1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
 - {1}/{\sqrt{2}} \\
\end{pmatrix}$、$\begin{pmatrix}
{1}/{\sqrt{2}} \\
{1}/{\sqrt{2}} \\
\end{pmatrix}$はそれぞれその条件$g\begin{pmatrix}
x \\
y \\
\end{pmatrix} = 0$の下でその関数$f$が極大値、極小値、極小値、極大値をとる点々である\footnote{10. の「あとは関数$F$の極値を前述した手順で求める。」にあたります。}。
\begin{thebibliography}{50}
\bibitem{1}
  杉浦光夫, 解析入門I, 東京大学出版社, 1980. 第34刷 p149-161 ISBN978-4-13-062005-5
\bibitem{2}
  杉浦光夫, 解析入門II, 東京大学出版社, 1985. 第22刷 p30-37 ISBN978-4-13-062006-2
\bibitem{3}
  和達三樹, 微分積分, 岩波書店, 1988. 新装版第3刷 p128-135 ISBN978-4-00-029883-4
\end{thebibliography}
\end{document}
