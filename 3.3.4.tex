\documentclass[dvipdfmx]{jsarticle}
\setcounter{section}{3}
\setcounter{subsection}{2}
\usepackage{xr}
\externaldocument{3.3.2}
\externaldocument{3.3.3}
\input{macro}
\begin{document}
%%\hypertarget{ux7d20ux5143}{%
\subsection{素元}%\label{ux7d20ux5143}}
%%\hypertarget{ux5272ux308aux5207ux308cux308b}{%
\subsubsection{割り切れる}%\label{ux5272ux308aux5207ux308cux308b}}
\begin{dfn}
整域$R$の元々$a$、$b$が与えられ$a = bq$なるその整域$R$の元$q$が存在するとき、その元$a$はその元$b$で割り切られる、整除されるなどといい、$b|a$と書く。さらに、その元$a$をその元$b$の倍元、その元$b$をその元$a$の約元という。
\end{dfn}
\begin{thm}\label{3.3.4.1}
整域$R$が与えられたとき、$\forall a,b,c$に対し、次のことが成り立つ。
\begin{itemize}
\item
  $a|a$が成り立つ。
\item
  $a|0$が成り立つ。
\item
  $1|a$が成り立つ。
\item
  $a \neq 0$が成り立つなら、$0|a$が成り立たない。
\item
  その元$b$が可逆元であるなら、$b|a$が成り立つ。
\item
  $b|a$かつ$c|b$が成り立つなら、$c|a$が成り立つ。
\item
  $c|a$かつ$c|b$が成り立つなら、$c|a + b$が成り立つ。
\item
  $b|a$が成り立つなら、$b|ac$が成り立つ。
\end{itemize}
\end{thm}
\begin{proof}
整域$R$が与えられたとき、$\forall a,b,c$に対し、$a = a1$、$0 = a0$、$a = 1a$が成り立つことから、$a|a$、$a|0$、$1|a$が成り立つ。\par
$a \neq 0$が成り立つかつ、$0|a$が成り立つと仮定すると、$a = 0q$となる元$q$がその整域$R$に存在することになるが、$0q = 0$より$a \neq 0$が成り立つことに矛盾している。よって、$a \neq 0$が成り立つなら、$0|a$が成り立たない。\par
その元$b$が可逆元であるなら、$bb^{-1} = 1$なる元$b^{-1}$がその整域$R$に存在するので、$a = 1a = bb^{-1}a $より$b|a$が成り立つ。\par
$b|a$かつ$c|b$が成り立つなら、$a = bq$、$b = cr$なる元々$q$、$r$がその整域$R$に存在することになる。このとき、$a = bq = crq$より$c|a$が成り立つ。\par
$c|a$かつ$c|b$が成り立つなら、$a = cq$、$b = cr$なる元々$q$、$r$がその整域$R$に存在することになる。ここで、$a + b = cq + cr = c(q + r)$より$c|a + b$が成り立つ。\par
$b|a$が成り立つなら、$a = bq$なる元$q$がその整域$R$に存在することになる。このとき、$ac = bqc$より$b|ac$が成り立つ。
\end{proof}
\begin{thm}\label{3.3.4.2}
整域$R$が与えられたとき、$\forall a \in R$に対し、$a|1$が成り立つならそのときに限り、その元$a$は可逆元である。
\end{thm}
\begin{proof}
整域$R$が与えられたとき、$\forall a \in R$に対し、$a|1$が成り立つなら、$1 = aa'$なるその整域$R$の元$a'$が存在する。このとき、その環$R$は整域なので、$aa' = a'a = 1$が成り立つので、その元$a$は可逆元である。逆に、その元$a$が可逆元であるなら、これの逆元$a^{-1}$がその整域$R$に存在して$1 = aa^{-1}$が成り立つので、$a|1$が成り立つ。
\end{proof}
\begin{dfn}
整域$R$が与えられたとき、$b|a$かつ$a|b$が成り立つことをそれらの元々$a$、$b$は同伴であるといい、$aAb$と書くことにする。
\end{dfn}
\begin{thm}\label{3.3.4.3} その関係$A$は同値関係である。
\end{thm}
\begin{proof}
整域$R$が与えられたとき、$b|a$かつ$a|b$が成り立つことを$aAb$と書くことにする。このとき、もちろん、$\forall a \in R$に対し、$a|a$かつ$a|a$が成り立つので、$aAa$が成り立つ。$\forall a,b \in R$に対し、$b|a$かつ$a|b$が成り立つなら、もちろん、$a|b$かつ$b|a$が成り立つので、$aAb$が成り立つなら、$bAa$が成り立つ。$\forall a,b,c$に対し、$a|b$かつ$b|c$が成り立つなら、$a|c$が成り立つので、$aAb$かつ$bAc$が成り立つなら、$a|b$かつ$b|a$かつ$b|c$かつ$c|b$が成り立つので、$a|c$かつ$c|a$が成り立ち、したがって、$aAc$が成り立つ。\par
よって、その関係$A$は同値関係である。
\end{proof}
\begin{thm}\label{3.3.4.4}
整域$R$が与えられたとき、$\forall a,b \in R$に対し、$aAb$が成り立つならそのときに限り、ある可逆元$q$がその整域$R$に存在して$a = bq$が成り立つ。
\end{thm}\par
これにより、例えば、$\forall a,b \in \mathbb{Z}$に対し、$aAb$が成り立つならそのときに限り、可逆元である整数が$\pm 1$のみであるから、$a = \pm b$が成り立つ。$\forall a,b \in \mathbb{Q}$に対し、$aAb$が成り立つならそのときに限り、可逆元である有理数が$0$以外の有理数すべてであるから、$\exists q \in \mathbb{Q} \setminus \left\{ 0 \right\}$に対し、$a = bq$が成り立つ。
\begin{proof}
整域$R$が与えられたとき、$\forall a,b \in R$に対し、$aAb$が成り立つなら、$a = bq$かつ$b = ar$なる元々$a$、$b$がその整域$R$に存在することになる。このとき、$a = bq = arq$が成り立つので、定理\ref{3.3.4.1}より$a \neq 0$が成り立つことによりこれの逆元$a^{-1}$がその整域$R$に存在して$1 = a^{-1}a = a^{-1}arq = rq$が成り立つ。ここで、その整域$R$は乗法について可換的であるので、それらの元々$q$、$r$は可逆元である。よって、ある可逆元$q$がその整域$R$に存在して$a = bq$が成り立つ。\par
逆に、ある可逆元$q$がその整域$R$に存在して$a = bq$が成り立つなら、ある元$q^{-1}$が存在して$b = bqq^{-1} = aq^{-1}$が成り立つ。以上より、$b|a$かつ$a|b$が成り立つので、$aAb$が成り立つ。
\end{proof}
%%\hypertarget{ux7d20ux5143-1}{%
\subsubsection{素元}%\label{ux7d20ux5143-1}}
\begin{dfn}
整域$R$の元$p$が与えられたとき、次のことを満たすとき、その元$p$を素元という。
\begin{itemize}
\item
  その元$p$は$0$でない。
\item
  その元$p$は可逆元でない。
\item
  $q|p$が成り立つなら、$qA1$または$qAp$が成り立つ。
\end{itemize}
\end{dfn}\par
例えば、素元な整数は素数かこれの符号を変えたものである。
\begin{thm}\label{3.3.4.5}
整域$R$の素元$p$が与えられたとき、これに同伴な元も素元である。
\end{thm}
\begin{proof}
整域$R$の素元$p$が与えられたとき、$pAq$なる元$q$について、定理\ref{3.3.4.1}より$q \neq 0$が成り立つ。また、その元$q$が可逆元であると仮定すると、定理\ref{3.3.4.4}よりある可逆元$r$がその整域$R$に存在して$p = qr$が成り立つ。ここで、次のようになることから、
\begin{align*}
pr^{-1}q^{-1} = qrr^{-1}q^{-1} = q1q^{-1} = qq^{-1} = 1
\end{align*}
その元$p$も可逆元であるが、これは素元の定義に矛盾する。したがって、その元$q$は可逆元でない。$r|q$が成り立つなら、定理\ref{3.3.4.4}よりある可逆元$a$が存在して$q = ar$が成り立つことになる。ここで、定理\ref{3.3.4.1}より$r|p$が成り立つので、$rA1$または$rAp$が成り立つ。ここで、その関係$A$は同値関係であるから、$rA1$または$rAq$が成り立つ。よって、その元$q$も素元である。
\end{proof}
\begin{dfn}
添数集合$\varLambda_{n}$によって添数づけられた整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、これの任意の元が割り切られるその整域$R$の元をその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の公約元という。さらに、その整域$R$の元$d$がその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の公約元でその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の任意の公約元$e$に対し、$e|d$が成り立つとき、その公約元$d$をその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元という。
\end{dfn}
\begin{thm}\label{3.3.4.6}
添数集合$\varLambda_{n}$によって添数づけられた整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、この族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元$d$が存在すれば、$\forall e \in R$に対し、$eAd$が成り立つならそのときに限り、その元$e$もその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元である。
\end{thm}
\begin{proof}
添数集合$\varLambda_{n}$によって添数づけられた整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、この族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元$d$が存在するとする。$\forall e \in R$に対し、$eAd$が成り立つなら、ある可逆元$q$が存在して$d = eq$が成り立つ。このとき、$\forall i \in \varLambda_{n}$に対し、$d|a_{i}$が成り立ち、$\exists d_{i} \in R$に対し、$a_{i} = dd_{i} = eqd_{i}$が成り立つので、その元$e$もその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の公約元である。さらに、その族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の任意の公約元$c$に対し、$c|d$が成り立つので、$\exists d_{c} \in R$に対し、$d = cd_{c}$が成り立ち、したがって、$e = eqq^{-1} = dq^{-1} = c{d_{c}}q^{-1}$が成り立つ。これにより、その元$e$もその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元でもある。\par
逆に、その整域$R$の元$e$もその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元であるなら、最大公約元の定義より$d|e$かつ$e|d$が成り立つので、$eAd$が成り立つ。
\end{proof}
\begin{thm}\label{3.3.4.7}
添数集合$\varLambda_{n}$によって添数づけられた単項ideal整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、この族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元$d$は存在して$Rd = \sum_{i \in \varLambda_{n}} {Ra_{i}}$が成り立つ。
\end{thm}
\begin{proof}
添数集合$\varLambda_{n}$によって添数づけられた単項ideal整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、定理\ref{3.3.2.3}より集合$\sum_{i \in \varLambda_{n}} {Ra_{i}}$はその整域$R$のidealであるので、その整域$R$のある元$d$が存在して$Rd = \sum_{i \in \varLambda_{n}} {Ra_{i}}$が成り立つ。ここで、もちろん、$d \in Rd$が成り立つので、その整域$R$のある元々$r_{i}$を用いて$d = \sum_{i \in \varLambda_{n}} {r_{i}a_{i}}$が成り立つ。これにより、$\forall i \in \varLambda_{n}$に対し、$a_{i} \in Rd = \sum_{i \in \varLambda_{n}} {Ra_{i}}$が成り立つので、その元$a_{i}$はその元$d$の倍元となり、したがって、その元$d$がその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の公約元でもある。ここで、その族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の任意の公約元$e$が与えられたとき、$\forall i \in \varLambda_{n}$に対し、$a_{i} = ee_{i}$なるその整域$R$の元$e_{i}$が存在するので、次のようになる。
\begin{align*}
d = \sum_{i \in \varLambda_{n}} {r_{i}a_{i}} = \sum_{i \in \varLambda_{n}} {r_{i}ee_{i}} = e\sum_{i \in \varLambda_{n}} {r_{i}e_{i}}
\end{align*}
これにより、$e|d$が成り立つので、その元$d$がその族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元となる。よって、この族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$の最大公約元$d$は存在して$Rd = \sum_{i \in \varLambda_{n}} {Ra_{i}}$が成り立つ。
\end{proof}
\begin{dfn}
単項ideal整域$R$の部分集合$\left\{ a,b \right\}$が与えられたとき、$1$がこの集合$\left\{ a,b \right\}$の最大公約元であるとき、それらの元々$a$、$b$は互いに素であるという。
\end{dfn}
\begin{thm}\label{3.3.4.8}
単項ideal整域$R$の素元$p$が与えられたとき、$\forall a \in R$に対し、$p|a$が成り立たないなら、それらの元々$p$、$a$は互いに素である。
\end{thm}
\begin{proof}
単項ideal整域$R$の素元$p$が与えられたとき、$\forall a \in R$に対し、$p|a$が成り立たないなら、集合$\left\{ p,a \right\}$の最大公約元$d$は$d|p$を満たすので、素元の定義より$dA1$または$dAp$が成り立つ。ここで、$dAp$が成り立つとすれば、$d|a$が成り立つので、$p|d$が成り立つことと定理\ref{3.3.4.1}より$p|a$が成り立つことになるが、これは仮定に矛盾する。したがって、$dA1$が成り立つことになる。このとき、定理\ref{3.3.4.6}より$1$もその集合$\left\{ p,a \right\}$の最大公約元であるから、それらの元々$p$、$a$は互いに素である。
\end{proof}
\begin{thm}\label{3.3.4.9}
単項ideal整域$R$の素元$p$と添数集合$\varLambda_{n}$によって添数づけられたその整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、$p|\prod_{i \in \varLambda_{n}} a_{i}$が成り立つなら、$\exists i \in \varLambda_{n}$に対し、$p|a_{i}$が成り立つ。
\end{thm}
\begin{proof}
単項ideal整域$R$の素元$p$と添数集合$\varLambda_{n}$によって添数づけられたその整域$R$の元の族$\left\{ a,b \right\}$が与えられたとき、$p|ab$が成り立つかつ、$p|a$が成り立たないなら、定理\ref{3.3.4.8}よりそれらの元々$p$、$a$は互いに素であるので、定理\ref{3.3.4.7}より$R = Rp + Ra$が成り立ち、したがって、$\exists r,s \in R$に対し、$1 = rp + sa$が成り立つ。このとき、$\exists c \in R$に対し、$ab = pc$が成り立って次のようになるので、
\begin{align*}
b &= (rp + sa)b\\
&= rpb + sab\\
&= rpb + spc\\
&= (rb + sc)p
\end{align*}
$p|b$が成り立つ。以上より、$p|ab$が成り立つなら、$p|a$または$p|b$が成り立つ。これにより、添数集合$\varLambda_{n}$によって添数づけられたその整域$R$の元の族$\left\{ a_{i} \right\}_{i \in \varLambda_{n}}$についても同様に成り立つ。
\end{proof}
\begin{thm}\label{3.3.4.10}
単項ideal整域$R$の0でない元の列$\left( a_{n} \right)_{n \in \mathbb{N}}$が与えられたとき、$\forall n \in \mathbb{N}$に対し、$a_{n + 1}|a_{n}$が成り立つなら、$\exists n_{0} \in \mathbb{N}\forall n \in \mathbb{N}$に対し、$n_{0} \leq n$が成り立つなら、$a_{n_{0}}Aa_{n}$が成り立つ。
\end{thm}
\begin{proof}
単項ideal整域$R$の0でない元の列$\left( a_{n} \right)_{n \in \mathbb{N}}$が与えられたとき、$\forall n \in \mathbb{N}$に対し、$a_{n + 1}|a_{n}$が成り立つとする。このとき、$\forall a,b \in \bigcup_{n \in \mathbb{N}} {Ra_{n}}$に対し、ある自然数たち$i$、$j$が存在して$a \in Ra_{i}$かつ$b \in Ra_{j}$が成り立つ。ここで、$i \leq j$が成り立つなら、仮定より$a_{j}|a_{i}$が成り立つので、$a_{j}|a$が成り立つ。以上より、$a_{j}|a$かつ$a_{j}|b$が成り立つので、定理\ref{3.3.4.1}より$a_{j}|a + b$が成り立つことになり、したがって、$a + b \in \bigcup_{n \in \mathbb{N}} {Ra_{n}}$が成り立つ。さらに、$\forall a \in \bigcup_{n \in \mathbb{N}} {Ra_{n}}\forall r \in R$に対し、ある自然数$i$が存在して$a \in Ra_{i}$が成り立つ。ここで、その集合$Ra_{i}$はidealであったので、$ra \in Ra_{i}$が成り立つ。これにより、$ra \in \bigcup_{n \in \mathbb{N}} {Ra_{n}}$が成り立つ。以上より、その集合$\bigcup_{n \in \mathbb{N}} {Ra_{n}}$はその整域$R$のidealである。\par
ここで、その整域$R$は単項ideal整域であるから、$Rd = \bigcup_{n \in \mathbb{N}} {Ra_{n}}$なる元$d$がその集合$R$に存在するので、$\forall n \in \mathbb{N}$に対し、$a_{n} \in Rd$が成り立ち、したがって、$d|a_{n}$が成り立つ。一方で、$d \in \bigcup_{n \in \mathbb{N}} {Ra_{n}}$が成り立つので、$\exists n_{0} \in \mathbb{N}$に対し、$d \in Ra_{n_{0}}$、即ち、$a_{n_{0}}|d$が成り立つので、$\forall n \in \mathbb{N}$に対し、$n_{0} \leq n$が成り立つなら、定理\ref{3.3.4.1}より$a_{n}|d$が成り立つ。以上より、$d|a_{n}$かつ$a_{n}|d$が成り立つので、$a_{n}Ad$が成り立つかつ、$a_{n_{0}}Ad$が成り立つ。ここで、その関係$A$は同値関係であるので、$a_{n_{0}}A_{n}$が成り立つ。\par
よって、$\forall n \in \mathbb{N}$に対し、$a_{n + 1}|a_{n}$が成り立つなら、$\exists n_{0} \in \mathbb{N}\forall n \in \mathbb{N}$に対し、$n_{0} \leq n$が成り立つなら、$a_{n_{0}}Aa_{n}$が成り立つ。
\end{proof}
\begin{thm}[素元分解の基本定理]\label{3.3.4.11}
単項ideal整域$R$が与えられたとき、$\forall a \in R$に対し、その元$a$が可逆元でないかつ、$0$でないなら、その整域$R$の素元の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$が存在して$a = \prod_{i \in \varLambda_{n}} p_{i}$が成り立つ。しかも、そのような族が$\left\{ p_{i} \right\}_{i \in \varLambda_{m}}$、$\left\{ q_{i} \right\}_{i \in \varLambda_{n}}$と与えられたとき、$m = n$が成り立ち、$\exists s:\varLambda_{n}\overset{\sim}{\rightarrow}\varLambda_{m}\forall i \in \varLambda_{n}$に対し、$p_{i}Aq_{s(i)}$が成り立つ。\par
この定理を素元分解の基本定理といい、その族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$を求めることをその元$a$を素元分解するという。
\end{thm}
\begin{proof}
単項ideal整域$R$が与えられたとき、$\exists a \in R$に対し、その元$a$が可逆元でないかつ、$0$でないかつ、その整域$R$の素元の任意の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$に対し、$a = \prod_{i \in \varLambda_{n}} p_{i}$が成り立たないと仮定しよう。このとき、仮定よりその元$a$は素元でないことになるので、$\exists b \in R$に対し、$b|a$かつ$\neg bA1$かつ$\neg aAb$が成り立つ。このとき、定理\ref{3.3.4.2}よりその元$b$は可逆元ではなく、$\exists c \in R$に対し、$a = bc$が成り立つかつ、その元$c$は可逆元でない。ゆえに、その元$a$と同伴でない元々$b$、$c$を用いて$a = bc$が成り立つ。ここで、これらの元々$b$、$c$がどちらも素元たちの積で表されることができるとすれば、その元$a$もそうなり仮定に反する。したがって、これらの元々$b$、$c$どちらかは素元たちの積で表されることができないことになる。このとき、その元$b$またはその元$c$は可逆元でないかつ、$0$でないかつ、その整域$R$の素元の任意の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$に対し、$b = \prod_{i \in \varLambda_{n}} p_{i}$が成り立たない。ここで、$a = a_{1}$かつ$b = a_{2}$または$a = a_{1}$かつ$c = a_{2}$とおかれるとし、$\forall k \in \mathbb{N}$に対し、その元$a_{k}$が可逆元でないかつ、$0$でないかつ、その整域$R$の素元の任意の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$に対し、$a_{k} = \prod_{i \in \varLambda_{n}} p_{i}$が成り立たないとすると、同様にして、$a_{k + 1}|a_{k}$かつその元$a_{k + 1}$が可逆元でないかつ、$0$でないかつ、その整域$R$の素元の任意の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$に対し、$a_{k + 1} = \prod_{i \in \varLambda_{n}} p_{i}$が成り立たないようなもの$a_{k + 1}$が存在することが示される。このようにしてその整域$R$の元の列$\left\{ a_{n} \right\}_{n \in \mathbb{N}}$が得られる。このとき、$\forall n \in \mathbb{N}$に対し、$a_{n + 1}|a_{n}$が成り立つかつ、$\forall n_{0} \in \mathbb{N}\exists n \in \mathbb{N}$に対し、$n_{0} \leq n$が成り立つかつ、$a_{n_{0}}Aa_{n}$が成り立たないことになる。しかしながら、これは定理\ref{3.3.4.10}に矛盾する。よって、$\forall a \in R$に対し、その元$a$が可逆元でないかつ、$0$でないなら、その整域$R$の素元の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$が存在して$a = \prod_{i \in \varLambda_{n}} p_{i}$が成り立つ。\par
上記の議論により、$\forall a \in R$に対し、その元$a$が可逆元でないかつ、$0$でないなら、その整域$R$の素元の族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$が存在して$a = \prod_{i \in \varLambda_{n}} p_{i}$が成り立つのであった。このとき、そのような族が$\left\{ p_{i} \right\}_{i \in \varLambda_{m}}$、$\left\{ q_{i} \right\}_{i \in \varLambda_{n}}$と与えられたなら、$p_{1}|\prod_{i \in \varLambda_{n}} q_{i}$が成り立つ。定理\ref{3.3.4.9}より$\exists i' \in \varLambda_{n}$に対し、$p_{1}|q_{i'}$が成り立つ。ここで、$\exists s:\varLambda_{m} \rightarrow \varLambda_{n}$に対し、$s(1) = i'$とすれば、$p_{1}|q_{s(1)}$が成り立ちその元$p_{1}$は可逆元でなく定理\ref{3.3.4.2}、定理\ref{3.3.4.8}より$p_{1}Aq_{s(1)}$が成り立つ。$\exists k + 1 \in \varLambda_{m}$に対し、$p_{k}Aq_{s(k)}$が成り立つようなその族$\left\{ q_{i} \right\}_{i \in \varLambda_{n}}$の元$q_{s(k)}$が存在すると仮定すると、ある可逆元$\varepsilon_{k}$がその整域$R$に存在して$p_{k} = \varepsilon_{k}q_{s(k)}$が成り立つ。したがって、次のようになる。
\begin{align*}
0 &= a - a\\
&= \prod_{i \in \varLambda_{n}} p_{i} - \prod_{i \in \varLambda_{n}} q_{i}\\
&= \prod_{i \in \varLambda_{k}} p_{i}\prod_{i \in \varLambda_{m} \setminus \varLambda_{k}} p_{i} - \prod_{s(i) \in \varLambda_{k}} q_{i}\prod_{s(i) \in \varLambda_{n} \setminus \varLambda_{k}} q_{i}\\
&= \prod_{i \in \varLambda_{k}} p_{i}\prod_{i \in \varLambda_{m} \setminus \varLambda_{k}} p_{i} - \prod_{i \in \varLambda_{k}} {\varepsilon_{i}p_{i}}\prod_{s(i) \in \varLambda_{n} \setminus \varLambda_{k}} q_{i}\\
&= \prod_{i \in \varLambda_{k}} p_{i}\prod_{i \in \varLambda_{m} \setminus \varLambda_{k}} p_{i} - \prod_{i \in \varLambda_{k}} \varepsilon_{i}\prod_{i \in \varLambda_{k}} p_{i}\prod_{s(i) \in \varLambda_{n} \setminus \varLambda_{k}} q_{i}\\
&= \prod_{i \in \varLambda_{k}} p_{i}\left( \prod_{i \in \varLambda_{m} \setminus \varLambda_{k}} p_{i} - \prod_{i \in \varLambda_{k}} \varepsilon_{i}\prod_{s(i) \in \varLambda_{n} \setminus \varLambda_{k}} q_{i} \right)
\end{align*}
ここで、$\prod_{i \in \varLambda_{k}} p_{i} \neq 0$が成り立つので、$\prod_{i \in \varLambda_{m} \setminus \varLambda_{k}} p_{i} = \prod_{i \in \varLambda_{k}} \varepsilon_{i}\prod_{s(i) \in \varLambda_{n} \setminus \varLambda_{k}} q_{i}$が成り立つことになる。ここで、$k \geq n$が成り立つと仮定すると、次式が成り立つことになる。
\begin{align*}
\prod_{i \in \varLambda_{m} \setminus \varLambda_{k}} p_{i} = \prod_{i \in \varLambda_{n}} \varepsilon_{i}
\end{align*}
しかしながら、これは素元の定義に矛盾している。したがって、$k < n$が成り立つことになり、したがって、$p_{k + 1}|\prod_{i \in \varLambda_{k}} \varepsilon_{i}\prod_{s(i) \in \varLambda_{n} \setminus \varLambda_{k}} q_{s(i)}$が成り立つ。定理\ref{3.3.4.9}より$\exists i' \in \varLambda_{n} \setminus \varLambda_{k}$に対し、$p_{k + 1}|q_{i'}$が成り立つ。ここで、$s(k + 1) = i'$とすれば、$p_{k + 1}|q_{s(k + 1)}$が成り立ちその元$p_{k + 1}$は可逆元でなく定理\ref{3.3.4.2}、定理\ref{3.3.4.8}より$p_{k + 1}Aq_{s(k + 1)}$が成り立つ。\par
以上、数学的帰納法により$\forall k \in \varLambda_{m}$に対し、$p_{k}Aq_{s(k)}$が成り立つようなその族$\left\{ q_{i} \right\}_{i \in \varLambda_{n}}$の元$q_{s(k)}$が存在する。このとき、$m \leq n$が成り立つことになる。$m < n$が成り立つと仮定すると、$k = m$のとき、次式が成り立つことになる。
\begin{align*}
1 = \prod_{i \in \varLambda_{n}} \varepsilon_{i}\prod_{i \in \varLambda_{n} \setminus \varLambda_{m}} q_{s(i)}
\end{align*}
しかしながら、これは素元の定義に矛盾している。以上より、$m = n$が成り立つことになる。このとき、その写像$s$は全単射である。\par
よって、そのような族が$\left\{ p_{i} \right\}_{i \in \varLambda_{m}}$、$\left\{ q_{i} \right\}_{i \in \varLambda_{n}}$と与えられたとき、$m = n$が成り立ち、$\exists s:\varLambda_{n}\overset{\sim}{\rightarrow}\varLambda_{m}\forall i \in \varLambda_{n}$に対し、$p_{i}Aq_{s(i)}$が成り立つ。
\end{proof}
\begin{thm}\label{3.3.4.12}
整域$R$が与えられたとき、$\forall a,b \in R$に対し、$a \neq 0$かつ$b \neq 0$が成り立つなら、$b|a$が成り立つならそのときに限り、$Ra \subseteq Rb$が成り立つ。特に、$aAb$が成り立つならそのときに限り、$Ra = Rb$が成り立つ。
\end{thm}
\begin{proof}
整域$R$が与えられたとき、$\forall a,b \in R$に対し、$a \neq 0$かつ$b \neq 0$が成り立つとする。$b|a$が成り立つなら、$\exists q \in R$に対し、$a = bq$が成り立つので、$\forall ra \in Ra$に対し、$ra = rbq = rqb$が成り立つので、$ra \in Rb$が成り立つ。逆に、$Ra \subseteq Rb$が成り立つなら、$a \in Ra$より$a \in Rb$が成り立つことになる。したがって、$\exists q \in R$に対し、$a = qb = bq$が成り立つ。よって、$b|a$が成り立つ。\par
特に、$aAb$が成り立つならそのときに限り、$b|a$かつ$a|b$が成り立つので、これが成り立つならそのときに限り、$Ra \subseteq Rb$かつ$Rb \subseteq Ra$が成り立つ。これが成り立つならそのときに限り、$Ra = Rb$が成り立つ。
\end{proof}
\begin{thm}\label{3.3.4.13}
単項ideal整域$R$が与えられたとき、$\forall p \in R$に対し、$p \neq 0$が成り立つなら、次のことは同値である。
\begin{itemize}
\item
  その元$p$は素元である。
\item
  ideal$Rp$はその整域$R$の素idealである。
\item
  ideal$Rp$はその整域$R$の極大idealである。
\end{itemize}
\end{thm}
\begin{proof}
単項ideal整域$R$が与えられたとき、$\forall p \in R$に対し、$p \neq 0$が成り立つとする。その元$p$は素元であるなら、その元$p$は可逆元でなく$1 \notin Rp$が成り立つので、$Rp \neq R$が成り立つ。さらに、$\forall a,b \in R$に対し、$ab \in Rp$が成り立つなら、$p|ab$が成り立つことになる。ここで、定理\ref{3.3.4.9}より$p|a$または$p|b$が成り立つことになり、したがって、$a \in Rp$または$b \in Rp$が成り立つので、そのideal$Rp$は素idealである。\par
ideal$Rp$がその整域$R$の素idealであるなら、$\forall a,b \in R$に対し、$ab \in Rp$が成り立つなら、$a \in Rp$または$b \in Rp$が成り立つことになる。ここで、$Rp \subseteq J$なる任意のidealに対し、あるその整域$R$の元$q$が存在して$J = Rq$が成り立つ。このとき、定理\ref{3.3.4.12}より$q|p$が成り立つことになるので、$\exists s \in R$に対し、$p = qs$が成り立つ。$\forall rq \in J = Rq$に対し、$rqs = rp$が成り立つので、$rq \in Rp$または$s \in Rp$が成り立つ。ここで、$rq \in Rp$が成り立つなら、$Rq \subseteq Rp$が得られるので、$Rp = J = Rq$が成り立つ。$s \in Rp$が成り立つなら、$\exists t \in R$に対し、$s = tp$が成り立つことになるので、$p = qs = qtp$が成り立つ。したがって、$p(1 - qt) = 0$が成り立ち、$p \neq 0$より$qt = 1$が成り立つことになる。このとき、その元$q$は可逆元であるので、$\forall u \in R$に対し、$u = uq^{-1}q \in Rq$が成り立つことになり、したがって、$J = Rq = R$が成り立つ。これにより、そのideal$Rp$はその整域$R$の極大idealである。\par
ideal$Rp$がその整域$R$の極大idealであるとする。なら、$Rp \subseteq J$なる任意のidealに対し、$J = Rp$または$J = R$が成り立つ。ここで、その元$p$が可逆元であるとすれば、$\forall r \in R$に対し、$r = rp^{-1}p \in Rp$が成り立つので、$Rp = R$が成り立つことになるが、これは極大idealの定義に矛盾する。したがって、その元$p$は可逆元ではない。ここで、$\forall q \in R$に対し、$q|p$が成り立つなら、定理\ref{3.3.4.12}より$Rp \subseteq Rq$が成り立つ。このとき、そのideal$Rp$がその整域$R$の極大idealであるので、$Rq = Rp$または$Rq = R$が成り立つ。$Rq = Rp$が成り立つなら、定理\ref{3.3.4.12}より$qAp$が成り立つ。$Rq = R$が成り立つなら、$1 \in Rq$が成り立つので、その元$q$は可逆元で定理\ref{3.3.4.1}、定理\ref{3.3.4.2}より$qA1$が成り立つ。以上より、その元$p$は可逆元ではなく、$\forall q \in R$に対し、$q|p$が成り立つなら、$qA1$または$qAp$が成り立つ。したがって、この元$p$は素元である。
\end{proof}
\begin{thm}\label{3.3.4.14}
単項ideal整域$R$が与えられたとき、$\forall p \in R$に対し、その元$p$が素元であるなら、商環${R}/{Rp}$は体である。
\end{thm}
\begin{proof}
単項ideal整域$R$が与えられたとき、$\forall p \in R$に対し、その元$p$が素元であるなら、定理\ref{3.3.4.13}よりideal$Rp$はその整域$R$の素idealであり定理\ref{3.3.2.27}より商環${R}/{Rp}$は整域である。さらに、定理\ref{3.3.4.13}よりideal$Rp$はその整域$R$の極大idealであり定理\ref{3.3.2.26}よりその商環${R}/{Rp}$は斜体である。以上より、その商環${R}/{Rp}$は体である。
\end{proof}
%%\hypertarget{euclidux6574ux57df}{%
\subsubsection{Euclid整域}%\label{euclidux6574ux57df}}
\begin{dfn} 整域$R$と次式のような写像$d$が与えられたとき、
\begin{align*}
d:R \setminus \left\{ 0 \right\} \rightarrow \mathbb{N} \cup \left\{ 0 \right\}
\end{align*}
$\forall a,b \in R$に対し、$a \neq 0$かつ$b \neq 0$が成り立つなら、$\exists q,r \in R$に対し、次式が成り立つようなその整域$R$を写像$d$を大きさとするEuclid整域といいその写像$d$をEuclid写像という。このとき、その元$q$をその元$a$をその元$b$で割った商、その元$r$をその元$a$をその元$b$で割った余り、剰余という。
\end{dfn}\par
例えば、集合$\mathbb{Z}$、体$K$上の多項式環$K[ X]$などが挙げられる。
\begin{align*}
a = bq + r \land \left( r = 0 \vee d(r) < d(b) \right)
\end{align*}
\begin{thm}\label{3.3.4.15}
写像$d$を大きさとするEuclid整域$R$は単項ideal整域である。
\end{thm}
\begin{proof}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、その整域$R$の任意のideal$J$に対し、これが零idealであるなら、これは単項idealである。そのideal$J$が零元でないその整域$R$の元に属されるなら、これらのうち、Euclid写像$d$の像が最も小さいもの$a$がとられると、定義より$\forall b \in J$に対し、次式が成り立つようなその整域$R$の元々$q$、$r$が存在する。
\begin{align*}
b = aq + r \land \left( r = 0 \vee d(r) < d(a) \right)
\end{align*}
このとき、$- qa \in J$より$r = b - qa \in J$が成り立つので、$d(r) < d(a)$が成り立つとすれば、その元$a$のおき方に矛盾するので、$r = 0$が成り立つ。したがって、$\forall b \in J$に対し、$b = aq = qa$が成り立つので、$J = Ra$が成り立つ。よって、その整域$R$は単項ideal整域である。
\end{proof}
\begin{thm}\label{3.3.4.16}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、$\forall a,b \in R$に対し、$a \neq 0$かつ$b \neq 0$が成り立つなら、$\exists q,r \in R$に対し、次式が成り立つのであった。
\begin{align*}
a = bq + r \land \left( r = 0 \vee d(r) < d(b) \right)
\end{align*}
このとき、族$\left\{ a,b \right\}$の最大公約元は族$\left\{ b,r \right\}$の最大公約元の同伴である。
\end{thm}
\begin{proof}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、$\forall a,b \in R$に対し、$a \neq 0$かつ$b \neq 0$が成り立つなら、$\exists q,r \in R$に対し、次式が成り立つのであった。
\begin{align*}
a = bq + r \land \left( r = 0 \vee d(r) < d(b) \right)
\end{align*}
このとき、族$\left\{ a,b \right\}$の最大公約元$d$が与えられたとき、$d|a$かつ$d|b$が成り立つのであった。このとき、$d|a - bq$が成り立つので、$d|r$が成り立つことになる。これにより、その元$d$はその族$\left\{ b,r \right\}$の公約元であり、族$\left\{ b,r \right\}$の最大公約元$e$が与えられたとき、最大公約元の定義よりしたがって、$d|e$が成り立つ。一方で、$e|b$かつ$e|r$が成り立ち、したがって、$e|bq + r$が成り立つので、$e|a$が成り立つことになる。これにより、その元$e$はその族$\left\{ a,b \right\}$の公約元であり、最大公約元の定義よりしたがって、$e|d$が成り立つ。以上より、$dAe$が成り立つので、族$\left\{ a,b \right\}$の最大公約元は族$\left\{ b,r \right\}$の最大公約元の同伴である。
\end{proof}
\begin{thm}\label{3.3.4.17}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、$\forall a_{1},a_{2} \in R$に対し、$a_{1} \neq 0$かつ$a_{2} \neq 0$が成り立つなら、その整域$R$の元の列$\left( a_{n} \right)_{n \in \mathbb{N}}$が、$\forall n \in \mathbb{N}$に対し、次式のように与えられると、
\begin{align*}
a_{n} = a_{n + 1}q_{n} + a_{n + 2} \land \left( a_{n + 2} = 0 \vee d\left( a_{n + 2} \right) < d\left( a_{n + 1} \right) \right)
\end{align*}
$\exists n_{0} \in \mathbb{N}$に対し、$a_{n_{0} + 2} = 0$が成り立つ。
\end{thm}
\begin{proof}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、$\forall a_{1},a_{2} \in R$に対し、$a_{1} \neq 0$かつ$a_{2} \neq 0$が成り立つなら、その整域$R$の元の列$\left( a_{n} \right)_{n \in \mathbb{N}}$が、$\forall n \in \mathbb{N}$に対し、次式のように与えられたとする。
\begin{align*}
a_{n} = a_{n + 1}q_{n} + a_{n + 2} \land \left( a_{n + 2} = 0 \vee d\left( a_{n + 2} \right) < d\left( a_{n + 1} \right) \right)
\end{align*}
$\forall n \in \mathbb{N}$に対し、$a_{n + 2} \neq 0$が成り立つと仮定すると、$\forall n \in \mathbb{N}$に対し、$d\left( a_{n + 2} \right) < d\left( a_{n + 1} \right)$が成り立つことになるので、$\forall n \in \mathbb{N}\exists m \in V(d) \subseteq \mathbb{N} \cup \left\{ 0 \right\}$に対し、$m < d\left( a_{n + 1} \right)$が成り立つ、即ち、$\exists n \in \mathbb{N}\forall m \in V(d) \subseteq \mathbb{N} \cup \left\{ 0 \right\}$に対し、$d\left( a_{n + 1} \right) \leq m$が成り立たないことになるが、$\forall N \in \mathfrak{P}\left( \mathbb{N} \cup \left\{ 0 \right\} \right)$に対し、最小元$\min N$がその集合$N$に存在することに矛盾する。したがって、$\exists n_{0} \in \mathbb{N}$に対し、$a_{n_{0} + 2} = 0$が成り立つ。
\end{proof}
\begin{thm}[Euclid互除法]\label{3.3.4.17e}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、$\forall a_{1},a_{2} \in R$に対し、$a_{1} \neq 0$かつ$a_{2} \neq 0$が成り立つなら、その整域$R$の元の列$\left( a_{n} \right)_{n \in \mathbb{N}}$が、$\forall n \in \mathbb{N}$に対し、次式のように与えられると、
\begin{align*}
a_{n} = a_{n + 1}q_{n} + a_{n + 2} \land \left( a_{n + 2} = 0 \vee d\left( a_{n + 2} \right) < d\left( a_{n + 1} \right) \right)
\end{align*}
$\exists n \in \mathbb{N}$に対し、$a_{n + 2} = 0$が成り立つのであった。このような自然数のうち最も小さいものを$n_{0}$とおくと、族$\left\{ a_{1},a_{2} \right\}$の最大公約元は元$a_{n_{0} + 1}$に同伴である。この定理をEuclid互除法という。
\end{thm}
\begin{proof}
写像$d$を大きさとするEuclid整域$R$が与えられたとき、$\forall a_{1},a_{2} \in R$に対し、$a_{1} \neq 0$かつ$a_{2} \neq 0$が成り立つなら、その整域$R$の元の列$\left( a_{n} \right)_{n \in \mathbb{N}}$が、$\forall n \in \mathbb{N}$に対し、次式のように与えられると、
\begin{align*}
a_{n} = a_{n + 1}q_{n} + a_{n + 2} \land \left( a_{n + 2} = 0 \vee d\left( a_{n + 2} \right) < d\left( a_{n + 1} \right) \right)
\end{align*}
$\exists n \in \mathbb{N}$に対し、$a_{n + 2} = 0$が成り立つのであった。このような自然数のうち最も小さいものを$n_{0}$とおく。$\forall n \in \mathbb{N}$に対し、族$\left\{ a_{n},a_{n + 1} \right\}$の最大公約元の1つを$g_{n}$とおくと、定理\ref{3.3.4.16}より族$\left\{ a_{1},a_{2} \right\}$の最大公約元$g_{1}$は族$\left\{ a_{2},a_{3} \right\}$の最大公約元$g_{2}$の同伴であるので、$g_{1}Ag_{2}$が成り立つ。ここで、$n = k \leq n_{0} - 1$のとき、$g_{1}Ag_{k}$が成り立つと仮定すると、$n = k + 1 \leq n_{0}$のとき、$a_{k} = a_{k + 1}q_{k} + a_{k + 2} \land \left( a_{k + 2} = 0 \vee d\left( a_{k + 2} \right) < d\left( a_{k + 1} \right) \right)$が成り立ち、定理\ref{3.3.4.16}より$g_{k}Ag_{k + 1}$が成り立つので、$g_{1}Ag_{k + 1}$が成り立つ。以上、数学的帰納法により$\forall n \in \varLambda_{n_{0}}$に対し、$g_{1}Ag_{n}$が成り立つ。特に、$g_{1}Ag_{n_{0}}$が成り立ち、ここで、$a_{n_{0}} = a_{n_{0} + 1}q_{n_{0}}$が成り立つので、その元$a_{n_{0} + 1}$がその族$\left\{ a_{n_{0}},a_{n_{0} + 1} \right\}$の公約元である。$\exists q \in R$に対し、$a_{n_{0} + 1} = qg_{n_{0}}$が成り立つので、$g_{n_{0}}|a_{n_{0} + 1}$が成り立つことになり、したがって、$g_{n_{0}}Aa_{n_{0} + 1}$が成り立つ。以上より、$g_{1}Aa_{n_{0} + 1}$が成り立つので、族$\left\{ a_{1},a_{2} \right\}$の最大公約元は元$a_{n_{0} + 1}$に同伴である。
\end{proof}
%%\hypertarget{ux65e2ux7d04ux591aux9805ux5f0f}{%
\subsubsection{既約多項式}%\label{ux65e2ux7d04ux591aux9805ux5f0f}}
\begin{dfn}
体$K$上の多項式環$K[ X]$が与えられたとき、これの素元をその多項式環$K[ X]$における既約多項式という。特に、$f \in K[ X]$なる多項式$f$が素元であるなら、その多項式$f$は既約であるという。逆に、$f \in K[ X]$なる多項式$f$が零元でないかつ、素元でないなら、その多項式$f$は可約であるという。
\end{dfn}
\begin{thm}\label{3.3.4.18}
体$K$上の多項式環$K[ X]$が与えられたとき、$\forall p \in K[ X]$に対し、その多項式$p$が既約でないならそのときに限り、$\deg p < 1$が成り立つ、または、$\exists f,g \in K[ X]$に対し、次式が成り立つ。
\begin{align*}
p = fg \land 1 \leq \deg f \land 1 \leq \deg g
\end{align*}
\end{thm}
\begin{proof}
体$K$上の多項式環$K[ X]$が与えられたとき、$\forall p \in K[ X]$に対し、その多項式$p$が既約でないなら、その多項式$p$は零元であるか可逆元である、または、$\exists f \in K[ X]$に対し、$f|p$が成り立つかつ、$fA\overline{1}$が成り立たないかつ、$fAp$が成り立たない。ここで、定理\ref{3.3.3.11}よりその多項式$p$は零元であるか可逆元であるなら、$\deg p < 1$が成り立つ。さらに、$\exists f \in K[ X]$に対し、$f|p$が成り立つかつ、$fA\overline{1}$が成り立たないかつ、$fAp$が成り立たないなら、$\exists g \in K[ X]$に対し、$p = fg$が成り立つかつ、定理\ref{3.3.4.11}より$1 \leq \deg f$が成り立つかつ、その多項式$g$は可逆元でないので、定理\ref{3.3.4.11}より$1 \leq \deg g$が成り立つ。以上より、$\deg p < 1$が成り立つ、または、$\exists f,g \in K[ X]$に対し、次式が成り立つことになる。
\begin{align*}
p = fg \land 1 \leq \deg f \land 1 \leq \deg g
\end{align*}\par
逆に、$\deg p < 1$が成り立つ、または、$\exists f,g \in K[ X]$に対し、次式が成り立つとする。
\begin{align*}
p = fg \land 1 \leq \deg f \land 1 \leq \deg g
\end{align*}
$\deg p < 1$が成り立つなら、定理\ref{3.3.4.11}よりその多項式$p$は$\overline{0}$であるか可逆元である。さらに、多項式たち$f$、$g$は定理\ref{3.3.4.11}より零元でないかつ、可逆元でないので、$fA\overline{1}$が成り立たないかつ、$fAp$が成り立たない。これにより、その多項式$p$は零元であるか可逆元である、または、$f|p$が成り立つかつ、$fA\overline{1}$が成り立たないかつ、$fAp$が成り立たないので、その多項式$p$は既約でない。
\end{proof}
\begin{thm}\label{3.3.4.19}
体$K$上の多項式環$K[ X]$が与えられたとき、$\forall p \in K[ X]$に対し、$\deg p = 1$が成り立つなら、その多項式$p$は既約である。
\end{thm}
\begin{proof}
体$K$上の多項式環$K[ X]$が与えられたとき、$\forall p \in K[ X]$に対し、$\deg p = 1$が成り立つとする。$\exists f,g \in K[ X]$に対し、次式が成り立つと仮定すると、
\begin{align*}
p = fg \land 1 \leq \deg f \land 1 \leq \deg g
\end{align*}
定理\ref{3.3.3.7}より$2 \leq \deg f + \deg g = \deg{fg} = \deg p$が成り立つが、その多項式$p$が$\deg p = 1$を満たすことに矛盾する。したがって、$\deg p < 1$が成り立たないかつ、$\forall f,g \in K[ X]$に対し、次式が成り立たない。
\begin{align*}
p = fg \land 1 \leq \deg f \land 1 \leq \deg g
\end{align*}
定理\ref{3.3.4.18}よりこれが成り立つならそのときに限り、その多項式$p$は既約である。
\end{proof}
\begin{thm}\label{3.3.4.20}
体$K$上の多項式環$K[ X]$が与えられたとき、$\forall f,g,h \in K[ X]$に対し、$f|gh$が成り立つかつ、それらの多項式たち$f$、$g$が互いに素であるなら、$f|h$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の多項式環$K[ X]$が与えられたとき、$\forall f,g,h \in K[ X]$に対し、$f|gh$が成り立つかつ、それらの多項式たち$f$、$g$が互いに素であるなら、定理\ref{3.3.4.7}より$K[ X] = K[ X] f + K[ X] g$が成り立つので、$\exists a,b \in K[ X]$に対し、$af + bg = \overline{1}$が成り立つ。したがって、$\exists a,b,q \in K[ X]$に対し、$gh = fq$かつ$af + bg = \overline{1}$が成り立つことになる。ここで、次のようになるので、
\begin{align*}
\left\{ \begin{matrix}
gh = fq \\
af + bg = \overline{1} \\
\end{matrix} \right.\  &\Rightarrow \left\{ \begin{matrix}
bgh = bfq \\
bg = \overline{1} - af \\
\end{matrix} \right.\ \\
&\Rightarrow \left( \overline{1} - af \right)h = bfq\\
&\Leftrightarrow h - afh = bfq\\
&\Leftrightarrow h = fah + fbq\\
&\Leftrightarrow h = f(ah + bq)\\
&\Rightarrow f|h
\end{align*}
よって、$f|h$が成り立つ。
\end{proof}
\begin{thm}\label{3.3.4.21}
体$K$上の任意の$0$でない有理式$\varphi$が与えられたとき、$\exists f,g \in K[ X]$に対し、これらの多項式たち$f$、$g$は互いに素で$\varphi = \frac{f}{g}$が成り立つ。また、このような多項式たちが$\varphi = \frac{f}{g} = \frac{f'}{g'}$と与えられたとき、$\exists k \in K$に対し、$f = \overline{k}f'$かつ$g = \overline{k}g'$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の任意の$0$でない有理式$\varphi$が与えられたとき、$\exists f,g \in K[ X]$に対し、商の体の定義より$\varphi = \frac{f}{g}$が成り立つ。ここで、それらの多項式たち$f$、$g$を素元分解すると、ある既約多項式たちの族々$\left\{ p_{i} \right\}_{i \in \varLambda_{m}}$、$\left\{ q_{i} \right\}_{i \in \varLambda_{n}}$が存在して次式が成り立つ。
\begin{align*}
f = \prod_{i \in \varLambda_{m}} p_{i},\ \ g = \prod_{i \in \varLambda_{n}} q_{i}
\end{align*}
ここで、$\mathfrak{p}=\left\{ p_{i} \right\}_{i \in \varLambda_{m}} \cap \left\{ q_{i} \right\}_{i \in \varLambda_{n}}$とおかれると、$\prod_{} \mathfrak{p}|f$かつ$\prod_{} \mathfrak{p}|g$が成り立つので、$\exists q,r \in K[ X]$に対し、$f = \prod_{} \mathfrak{p}q$かつ$g = \prod_{} \mathfrak{p}r$が成り立つことになる。ここで、これらの多項式たち$q$、$r$が互いに素でないとすれば、族$\left\{ f,g \right\}$の最大公約元が$\overline{1}$でないことになるので、任意のその族$\left\{ f,g \right\}$の最大公約元$d$に対し、$dA\overline{1}$が成り立つことになる。定理\ref{3.3.4.2}よりその多項式$d$は可逆元でなく定理\ref{3.3.3.11}よりその多項式$d$は$\deg d = 1$を満たさない。ここで、$d = \overline{0}$とすれば、$g = \overline{0}$が成り立つが、これは商の体の定義に反する。したがって、$1 \leq \deg d$が成り立つことになる。その多項式$d$を素元分解すると、ある既約多項式たちの族$\left\{ r_{i} \right\}_{i \in \varLambda_{o}}$が存在して$d = \prod_{i \in \varLambda_{o}} r_{i}$が成り立つ。このとき、$\exists q',r' \in K[ X]$に対し、次式が成り立つ。
\begin{align*}
f &= \prod_{} \mathfrak{p}q = \prod_{} \mathfrak{p}dq' = \prod_{} \mathfrak{p}\prod_{i \in \varLambda_{o}} r_{i}q'\\
g &= \prod_{} \mathfrak{p}r = \prod_{} \mathfrak{p}dr' = \prod_{} \mathfrak{p}\prod_{i \in \varLambda_{o}} r_{i}r'
\end{align*}
しかしながら、これは$\left\{ r_{i} \right\}_{i \in \varLambda_{o}}\subseteq \mathfrak{p} =\left\{ p_{i} \right\}_{i \in \varLambda_{m}} \cap \left\{ q_{i} \right\}_{i \in \varLambda_{n}}$が成り立たないことを意味しておりその族$\mathfrak{p}$の定義に矛盾する。したがって、これらの多項式たち$q$、$r$が互いに素であり次式が成り立つ。
\begin{align*}
\varphi = \frac{f}{g} = \frac{\prod_{} \mathfrak{p}q}{\prod_{} \mathfrak{p}r} = \frac{\prod_{} \mathfrak{p}}{\prod_{} \mathfrak{p}}\frac{q}{r} = \frac{q}{r}
\end{align*}\par
また、このような多項式たちが$\varphi = \frac{f}{g} = \frac{f'}{g'}$と与えられたとき、$\frac{f}{g} = \frac{f'}{g'}$が成り立つならそのときに限り、$fg' = f'g$が成り立つことになり、それらの多項式たち$f$、$g$が互いに素であるなら、定理\ref{3.3.4.7}より$K[ X] = K[ X] f + K[ X] g$が成り立つので、$\exists a,b \in K[ X]$に対し、$af + bg = \overline{1}$が成り立つ。同様にして、$\exists a',b' \in K[ X]$に対し、$a'f' + b'g' = \overline{1}$が成り立つ。このとき、$a'f' = \overline{1} - b'g'$かつ$af = \overline{1} - bg$が成り立つので、次のようになる。
\begin{align*}
g &= g - b'g'g + b'g'g\\
&= \left( \overline{1} - b'g' \right)g + b'g'g\\
&= a'f'g + b'g'g\\
&= a'fg' + b'gg'\\
&= \left( a'f + b'g \right)g'\\
g' &= g' - bgg' + bgg'\\
&= \left( \overline{1} - bg \right)g' + bgg'\\
&= afg' + bgg'\\
&= af'g + bg'g\\
&= \left( af' + bg' \right)g
\end{align*}
したがって、$gg' \neq 0$が成り立つことに注意すれば、次のようになる。
\begin{align*}
\overline{0} &= gg' - gg'\\
&= gg' - \left( a'f + b'g \right)\left( af' + bg' \right)gg'\\
&= \left( \overline{1} - \left( a'f + b'g \right)\left( af' + bg' \right) \right)gg'
\end{align*}
したがって、$\left( a'f + b'g \right)\left( af' + bg' \right) = \overline{1}$が得られる。これにより、多項式たち$a'f + b'g$、$af' + bg'$は可逆元である。ここで、定理\ref{3.3.3.11}より$\deg\left( a'f + b'g \right) = \deg\left( af' + bg' \right) = 1$が成り立つので、$\exists k \in K$に対し、$a'f + b'g = \overline{k}$が成り立ち、したがって、$g = \overline{k}g'$が成り立つ。また、同様にして、$b'g' = \overline{1} - a'f'$が成り立つので、次のようになる。
\begin{align*}
b'fg' &= \left( \overline{1} - a'f' \right)f\\
&= f - a'f'f\\
&= b'f'g
\end{align*}
これが成り立つならそのときに限り、$f = \left( b'g + a'f \right)f' = \overline{k}f'$が成り立つ。よって、$\exists k \in K$に対し、$f = \overline{k}f'$かつ$g = \overline{k}g'$が成り立つ。
\end{proof}
\begin{dfn}
体$K$上の$0$でない有理式$\varphi = \frac{f}{g}$が$\deg f < \deg g$を満たすとき、その有理式$\varphi$を真分数式という。
\end{dfn}
\begin{thm}\label{3.3.4.22}
体$K$上の任意の$0$でない有理式$\varphi = \frac{f}{g}$が与えられたとき、真分数式$\varphi'$とその多項式環$K[ X]$の多項式$h$が一意的に存在して次式が成り立つ\footnote{証明するとき、除法の定理で一発じゃんと思うかもしれませんが(実際、僕も一瞬思いましたが)、$\varphi'$は多項式ではないので、除法の定理が使えないことになることに注意してください…。}。
\begin{align*}
\varphi = \frac{f}{g} = \varphi' + h
\end{align*}
\end{thm}
\begin{proof}
体$K$上の任意の$0$でない有理式$\varphi = \frac{f}{g}$が与えられたとき、定理\ref{3.3.4.21}より$\exists f',g' \in K[ X]$に対し、これらの多項式たち$f'$、$g'$は互いに素で$\varphi = \frac{f'}{g'}$が成り立つ。このとき、$fg' = f'g$が成り立ち、それらの多項式たち$f'$、$g'$が互いに素であるなら、定理\ref{3.3.4.7}より$K[ X] = K[ X] f' + K[ X] g'$が成り立つので、$\exists a',b' \in K[ X]$に対し、$a'f' + b'g' = \overline{1}$が成り立つ。ここで、$a' = \overline{0}$または$b' = \overline{0}$が成り立つなら、$a' = b' = \overline{0}$は成り立たずこの場合、その多項式$f'$が可逆元である、または、その多項式$g'$が可逆元であることになる。その多項式$f'$が可逆元であるなら、定理\ref{3.3.3.11}より$\deg f' < \deg g'$が成り立つので、すでに求める命題が示されている。その多項式$g'$が可逆元であるなら、$\frac{f'}{g'}$は多項式であるから、すでに求める命題が示されている。$a' \neq \overline{0}$かつ$b' \neq \overline{0}$が成り立つとき、$\deg g' = 0$が成り立つなら、$\frac{f'}{g'}$は多項式であるから、すでに求める命題が示されている。最後に、$0 < \deg g'$が成り立つとき、次のようになる。
\begin{align*}
\varphi &= \frac{f}{g} = \frac{f'}{g'} = \frac{a'f'}{a'g'}\\
&= \frac{\overline{1} - b'g'}{a'g'}\\
&= \frac{a'g' - a'g'b'g'}{a'g'a'g'}\\
&= \frac{\overline{1}}{a'g'} - \frac{b'g'}{a'g'}\\
&= \frac{\overline{1}}{a'g'} - \frac{b'}{a'}
\end{align*}
このとき、$- \frac{b'}{a'}$は多項式であり$\deg{a'g'} = \deg a' + \deg g' > \deg\overline{1} = 0$が成り立つので、求める命題が示されている。\par
このとき、真分数式$\varphi' = \frac{f'}{g'}$とその多項式環$K[ X]$の多項式$h$が存在して次式が成り立つとき、
\begin{align*}
\varphi = \frac{f}{g} = \frac{f'}{g'} + h
\end{align*}
$fg' = f'g + gg'h$が成り立つので、除法の定理より多項式$f'$と多項式$gg'h$が一意的に存在することになる。さらに、$gg'h = s$とおくと、除法の定理より多項式$g'h$が一意的に存在する。同様にして、多項式$h$が一意的に存在するので、真分数式$\varphi'$とその多項式環$K[ X]$の多項式$h$が一意的に存在して次式が成り立つ\footnote{この辺りの議論に少し不満があるので、もっといい方法があれば教えてください!}。
\begin{align*}
\varphi = \frac{f}{g} = \varphi' + h
\end{align*}
\end{proof}
\begin{thm}\label{3.3.4.23}
体$K$上の任意の$0$でない有理式$\varphi = \frac{f}{g}$が与えられたとき、これらの多項式たち$f$、$g$が互いに素でその多項式$g$がmonicであり、素元分解の基本定理より、互いに異なる既約なmonicの族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$と自然数の族$\left\{ \alpha_{i} \right\}_{i \in \varLambda_{n}}$が存在して$g = \prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}$が成り立つのであった。このとき、多項式$h$と、$\deg h_{i} < \deg p_{i}^{\alpha_{i}}$が成り立つかつ、$p_{i}|h_{i}$が成り立たない多項式の族$\left\{ h_{i} \right\}_{i \in \varLambda_{n}}$が一意的に存在して次式が成り立つ。
\begin{align*}
\varphi = \sum_{i \in \varLambda_{n}} \frac{h_{i}}{p_{i}^{\alpha_{i}}} + h
\end{align*}
\end{thm}
\begin{proof}
体$K$上の任意の$0$でない有理式$\varphi = \frac{f}{g}$が与えられたとき、これらの多項式たち$f$、$g$が互いに素でその多項式$g$がmonicであり、素元分解の基本定理より、互いに異なる既約なmonicの族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$と自然数の族$\left\{ \alpha_{i} \right\}_{i \in \varLambda_{n}}$が存在して$g = \prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}$が成り立つなら、族$\left\{ \prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}} \right\}_{i' \in \varLambda_{n}}$の最大公約元の1つとして$1$が挙げられるので、定理\ref{3.3.4.7}より次式が成り立つ。
\begin{align*}
K[ X] = \sum_{i' \in \varLambda_{n}} {K[ X]\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}
\end{align*}
このとき、ある体$K$上の多項式たちの族$\left\{ k_{i'} \right\}_{i' \in \varLambda_{n}}$が存在して次式が成り立つ。
\begin{align*}
f = \sum_{i' \in \varLambda_{n}} {k_{i'}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}
\end{align*}
両辺に$g$で割れば次のようになり
\begin{align*}
\varphi &= \frac{f}{g}\\
&= \sum_{i' \in \varLambda_{n}} {\frac{k_{i'}}{g}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}\\
&= \sum_{i' \in \varLambda_{n}} \frac{k_{i'}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \sum_{i' \in \varLambda_{n}} \frac{k_{i'}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}{p_{i'}^{\alpha_{i'}}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}\\
&= \sum_{i' \in \varLambda_{n}} \frac{k_{i'}}{p_{i'}^{\alpha_{i'}}}\\
&= \sum_{i \in \varLambda_{n}} \frac{k_{i}}{p_{i}^{\alpha_{i}}}
\end{align*}
定理\ref{3.3.4.22}より多項式$h$と$\deg h_{i} < \deg p_{i}^{\alpha_{i}}$が成り立つ多項式の族$\left\{ h_{i} \right\}_{i \in \varLambda_{n}}$が一意的に存在して次式が成り立つ。
\begin{align*}
\varphi = \sum_{i \in \varLambda_{n}} \frac{h_{i}}{p_{i}^{\alpha_{i}}} + h
\end{align*}
$\exists i' \in \varLambda_{n}$に対し、$p_{i'}|h_{i'}$が成り立つとすれば、$\exists q \in K[ X]$に対し、$h_{i'} = p_{i'}q$が成り立つことになる。このとき、次のようになるので、
\begin{align*}
\varphi &= \sum_{i \in \varLambda_{n}} \frac{h_{i}}{p_{i}^{\alpha_{i}}} + h\\
&= \sum_{i'' \in \varLambda_{n}} \frac{h_{i''}}{p_{i''}^{\alpha_{i''}}} + h\\
&= \sum_{i'' \in \varLambda_{n}} \frac{h_{i''}\prod_{i \in \varLambda_{n} \setminus \left\{ i'' \right\}} p_{i}^{\alpha_{i}}}{p_{i''}^{\alpha_{i''}}\prod_{i \in \varLambda_{n} \setminus \left\{ i'' \right\}} p_{i}^{\alpha_{i}}} + \frac{h\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \sum_{i'' \in \varLambda_{n}} \frac{h_{i''}\prod_{i \in \varLambda_{n} \setminus \left\{ i'' \right\}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}} + \frac{h\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \sum_{i'' \in \varLambda_{n} \setminus \left\{ i' \right\}} \frac{h_{i''}\prod_{i \in \varLambda_{n} \setminus \left\{ i'' \right\}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}} + \frac{h_{i'}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}} + \frac{h\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \frac{\sum_{i'' \in \varLambda_{n} \setminus \left\{ i' \right\}} {h_{i''}\prod_{i \in \varLambda_{n} \setminus \left\{ i'' \right\}} p_{i}^{\alpha_{i}}} + h_{i'}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}} + h\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \frac{\sum_{i'' \in \varLambda_{n} \setminus \left\{ i' \right\}} {h_{i''}p_{i'}^{\alpha_{i'}}\prod_{i \in \varLambda_{n} \setminus \left\{ i',i'' \right\}} p_{i}^{\alpha_{i}}} + p_{i'}q\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}} + hp_{i'}\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \frac{p_{i'}\left( \sum_{i'' \in \varLambda_{n} \setminus \left\{ i' \right\}} {h_{i''}p_{i'}^{\alpha_{i'} - 1}\prod_{i \in \varLambda_{n} \setminus \left\{ i',i'' \right\}} p_{i}^{\alpha_{i}}} + q\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}} + h\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}} \right)}{g}
\end{align*}
次式のようにおかれると、
\begin{align*}
s = \sum_{i'' \in \varLambda_{n} \setminus \left\{ i' \right\}} {h_{i''}p_{i'}^{\alpha_{i'} - 1}\prod_{i \in \varLambda_{n} \setminus \left\{ i',i'' \right\}} p_{i}^{\alpha_{i}}} + q\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}} + h\prod_{i \in \varLambda_{n} \setminus \left\{ i' \right\}} p_{i}^{\alpha_{i}}
\end{align*}
次式が成り立つ。
\begin{align*}
\varphi = \frac{f}{g} = \frac{p_{i'}s}{g}
\end{align*}
これにより、$fg = p_{i'}sg$が成り立ち、したがって、これが成り立つならそのときに限り、$\left( f - p_{i'}s \right)g = 0$が成り立つ。ここで、$g \neq \overline{0}$より$f = p_{i'}s$が成り立ち、したがって、族$\left\{ f,g \right\}$の公約元の１つが既約多項式$p_{i'}$で定理\ref{3.3.4.18}より$p_{i'}A1$が成り立たない。しかしながら、これはこれらの多項式たち$f$、$g$が互いに素であることに矛盾する。よって、多項式$h$と、$\deg h_{i} < \deg p_{i}^{\alpha_{i}}$が成り立つかつ、$p_{i}|h_{i}$が成り立たない多項式の族$\left\{ h_{i} \right\}_{i \in \varLambda_{n}}$が一意的に存在して次式が成り立つ。
\begin{align*}
\varphi = \sum_{i \in \varLambda_{n}} \frac{h_{i}}{p_{i}^{\alpha_{i}}} + h
\end{align*}
\end{proof}
\begin{thm}[$\psi$進展開]\label{3.3.4.24}
体$K$上の定数でない多項式$\psi$と体$K$上の任意の多項式$f$が与えられたとき、添数集合$\varLambda_{n} \cup \left\{ 0 \right\}$によって添数づけられた$\deg s_{i} < \deg\psi$なる多項式たちの族$\left\{ s_{i} \right\}_{i \in \varLambda_{n} \cup \left\{ 0 \right\}}$が一意的に存在して次式が成り立つ。
\begin{align*}
h = \sum_{i \in \varLambda_{n} \cup \left\{ 0 \right\}} {s_{i}\psi^{i}}
\end{align*}
このように表すことをその多項式$h$の$\psi$進展開という。
\end{thm}\par
これは次のようにして示される。
\begin{enumerate}
\item
  除法の定理より$\deg s_{0} < \deg\psi$かつ$h = q_{1}\psi + s_{0}$なる多項式たち$q_{1}$、$s_{0}$が一意的に存在する。
\item
  数学的帰納法により$\forall n \in \mathbb{N}$に対し、$\deg s_{n} < \deg\psi$かつ$q_{n} = q_{n + 1}\psi + s_{n}$なる多項式たち$q_{n + 1}$、$s_{n}$が一意的に存在するかつ、$\deg q_{n + 1} < \deg q_{n}$かつ$\deg s_{n} < \deg\psi$も成り立つ。
\item
  背理法により$\exists n_{0} \in \mathbb{N}\forall n \in \mathbb{N}$に対し、$q_{n_{0}} = \overline{0}$が成り立つことが示される。
\item
  このようにして、多項式の族々$\left\{ q_{n} \right\}_{n \in \varLambda_{n_{0}}}$、$\left\{ s_{n} \right\}_{n \in \varLambda_{n_{0}} \cup \left\{ 0 \right\}}$が得られる。
\item
  数学的帰納法によりその族$\left\{ q_{n} \right\}_{n \in \varLambda_{n_{0}}}$を消去することで$\forall n \in \varLambda_{n_{0} - 1}$に対し、$q_{n_{0} - k} = \sum_{i \in \varLambda_{k}} {s_{n_{0} - i}\psi^{k - i}}$が成り立つ。
\item
  その多項式$h$に代入することで求める命題が示される。
\end{enumerate}\par
例えば、多項式環$\mathbb{Q}[ x]$において、多項式$x^{4} + x + 1$の$x + 1$進展開を求めよう。
\begin{enumerate}
\item
  除法の定理より次式が成り立つ。
\begin{align*}
x^{4} + x + 1 = (x + 1)\left( x^{3} - x^{2} + x \right) + 1
\end{align*}
\item
  これを繰り返すことで次式が成り立つ。
\begin{align*}
x^{3} - x^{2} + x &= (x + 1)\left( x^{2} - 2x + 3 \right) - 3\\
x^{2} - 2x + 3 &= (x + 1)(x - 3) + 6\\
x - 3 &= (x + 1) - 4
\end{align*}
\item
  このとき、確かに次式が成り立つ。
\begin{align*}
1 = (x + 1)0 + 1
\end{align*}
\item
  このようにして、多項式の族々$\left\{ x^{3} - x^{2} + x,\ \ x^{2} - 2x + 3,\ \ x - 3,\ \ 1,\ \ 0 \right\}$、$\left\{ 1,\  - 3,\ \ 6,\  - 4 \right\}$が得られる。
\item
  したがって、次のようになる。
\begin{align*}
x^{3} - x^{2} + x &= (x + 1)\left( x^{2} - 2x + 3 \right) - 3\\
&= (x + 1)\left( (x + 1)(x - 3) + 6 \right) - 3\\
&= (x + 1)^{2}(x - 3) + 6(x + 1) - 3\\
&= (x + 1)^{2}\left( (x + 1) - 4 \right) + 6(x + 1) - 3\\
&= (x + 1)^{3} - 4(x + 1)^{2} + 6(x + 1) - 3
\end{align*}
\item
  その多項式$x^{4} + x + 1$に代入することで次式が得られる。
\begin{align*}
x^{4} + x + 1 &= (x + 1)\left( (x + 1)^{3} - 4(x + 1)^{2} + 6(x + 1) - 3 \right) + 1\\
&= (x + 1)^{4} - 4(x + 1)^{3} + 6(x + 1)^{2} - 3(x + 1) + 1
\end{align*}
\end{enumerate}
\begin{proof}
体$K$上の定数でない多項式$\psi$と体$K$上の任意の多項式$f$が与えられたとき、除法の定理より$\deg s_{0} < \deg\psi$かつ$h = q_{1}\psi + s_{0}$なる多項式たち$q_{1}$、$s_{0}$が一意的に存在する。$q_{1} = \overline{0}$が成り立つなら、すでに求める命題が示されている。以下、$q_{1} \neq \overline{0}$が成り立つとする。このとき、再び除法の定理より$\deg s_{1} < \deg\psi$かつ$q_{1} = q_{2}\psi + s_{1}$なる多項式たち$q_{2}$、$s_{1}$が一意的に存在する。ここで、$q_{2} = \overline{0}$が成り立つなら、$\deg q_{2} < \deg q_{1}$が成り立つ\footnote{実は、$h = q_{1}\psi + s_{0} = s_{1}\psi + s_{0}$が成り立ちますので、求める命題がもうこれで示されています。}。以下、$q_{1} \neq \overline{0}$が成り立つとするとき、次式が成り立つことから、
\begin{align*}
\deg q_{2} &= \deg q_{2} + \deg\psi - \deg\psi\\
&= \deg{q_{2}\psi} - \deg\psi\\
&= \deg\left( q_{1} - s_{1} \right) - \deg\psi\\
&\leq \deg q_{1} + \deg\left( - s_{1} \right) - \deg\psi\\
&= \deg q_{1} + \deg s_{1} - \deg\psi\\
&< \deg q_{1} + \deg\psi - \deg\psi\\
&= \deg q_{1}
\end{align*}
$\deg q_{2} < \deg q_{1}$が成り立つ。\par
ここで、$n = k$のとき、$\deg s_{k} < \deg\psi$かつ$q_{k} = q_{k + 1}\psi + s_{k}$なる多項式たち$q_{k + 1}$、$s_{k}$が一意的に存在するかつ、$\deg q_{k + 1} < \deg q_{k}$が成り立つと仮定する。$n = k + 1$のとき、$q_{k} \neq \overline{0}$が成り立つことにより、再び除法の定理より$\deg s_{k + 1} < \deg\psi$かつ$q_{k + 1} = q_{k + 2}\psi + s_{k + 1}$なる多項式たち$q_{k + 2}$、$s_{k + 1}$が一意的に存在する。ここで、$q_{k + 2} = \overline{0}$が成り立つなら、$\deg q_{2} < \deg q_{1}$が成り立つ。以下、$q_{k + 2} \neq \overline{0}$が成り立つとすると、次式が成り立つことから、
\begin{align*}
\deg q_{k + 2} &= \deg q_{k + 2} + \deg\psi - \deg\psi\\
&= \deg{q_{k + 2}\psi} - \deg\psi\\
&= \deg\left( q_{k + 1} - s_{k + 1} \right) - \deg\psi\\
&\leq \deg q_{k + 1} + \deg\left( - s_{k + 1} \right) - \deg\psi\\
&= \deg q_{k + 1} + \deg s_{k + 1} - \deg\psi\\
&< \deg q_{k + 1} + \deg\psi - \deg\psi\\
&= \deg q_{k + 1}
\end{align*}
$\deg q_{k + 2} < \deg q_{k + 1}$が成り立つ。\par
以上、数学的帰納法により$\forall n \in \mathbb{N}$に対し、$\deg s_{n} < \deg\psi$かつ$q_{n} = q_{n + 1}\psi + s_{n}$なる多項式たち$q_{n + 1}$、$s_{n}$が一意的に存在するかつ、$\deg q_{n + 1} < \deg q_{n}$が成り立つ。ここで、除法の定理より$\deg s_{n} < \deg\psi$も成り立つ。このとき、$\forall n \in \mathbb{N}$に対し、$\deg q_{n + 1} < \deg q_{n}$が成り立つとすれば、$\deg q_{n} \in \mathbb{N} \cup \left\{ 0 \right\}$が成り立つことに矛盾する。したがって、$\exists n_{0} \in \mathbb{N}\forall n \in \mathbb{N}$に対し、$\deg q_{n_{0}} < \deg q_{n}$が成り立つ、即ち、$q_{n_{0}} = \overline{0}$が成り立つことになる。このようにして、多項式の族々$\left\{ q_{n} \right\}_{n \in \varLambda_{n_{0}}}$、$\left\{ s_{n} \right\}_{n \in \varLambda_{n_{0}} \cup \left\{ 0 \right\}}$が得られる。\par
ここで、$n_{0} = 1$のときはすでに示されてるので、$2 \leq n_{0}$が成り立つとする。このとき、次のようになる。
\begin{align*}
q_{n_{0} - 1} = q_{n_{0}}\psi + s_{n_{0} - 1} = s_{n_{0} - 1}
\end{align*}\par
$n = k$のとき、$q_{n_{0} - k} = \sum_{i \in \varLambda_{k}} {s_{n_{0} - i}\psi^{k - i}}$が成り立つと仮定すると、$n = k + 1$のとき、$q_{n_{0} - k - 1} = q_{n_{0} - k}\psi + s_{n_{0} - k - 1}$なる多項式たち$q_{n_{0} - k - 1}$、$s_{n_{0} - k - 1}$が一意的に存在するので、次のようになる。
\begin{align*}
q_{n_{0} - k - 1} &= q_{n_{0} - k}\psi + s_{n_{0} - k - 1}\\
&= \sum_{i \in \varLambda_{k}} {s_{n_{0} - i}\psi^{k - i}}\psi + s_{n_{0} - k - 1}\\
&= \sum_{i \in \varLambda_{k}} {s_{n_{0} - i}\psi^{k + 1 - i}} + s_{n_{0} - k - 1}\\
&= \sum_{i \in \varLambda_{k}} {s_{n_{0} - i}\psi^{(k + 1) - i}} + s_{n_{0} - (k + 1)}\psi^{(k + 1) - (k + 1)}\\
&= \sum_{i \in \varLambda_{k + 1}} {s_{n_{0} - i}\psi^{(k + 1) - i}}
\end{align*}
これにより、数学的帰納法により$\forall n \in \varLambda_{n_{0} - 1}$に対し、$q_{n_{0} - k} = \sum_{i \in \varLambda_{k}} {s_{n_{0} - i}\psi^{k - i}}$が成り立つことが示された。\par
したがって、次のようになる。
\begin{align*}
h &= q_{1}\psi + s_{0}\\
&= q_{n_{0} - \left( n_{0} - 1 \right)}\psi + s_{0}\\
&= \sum_{i \in \varLambda_{n_{0} - 1}} {s_{n_{0} - i}\psi^{n_{0} - i - 1}}\psi + s_{0}\\
&= \sum_{i \in \varLambda_{n_{0} - 1}} {s_{n_{0} - i}\psi^{n_{0} - i}} + s_{0}\\
&= \sum_{i \in \varLambda_{n_{0} - 1}} {s_{i}\psi^{i}} + s_{0}\\
&= \sum_{i \in \varLambda_{n_{0} - 1} \cup \left\{ 0 \right\}} {s_{i}\psi^{i}}
\end{align*}\par
よって、添数集合$\varLambda_{n_{0}} \cup \left\{ 0 \right\}$によって添数づけられた$\deg s_{i} < \deg\psi$なる多項式たちの族$\left\{ s_{i} \right\}_{i \in \varLambda_{n_{0}} \cup \left\{ 0 \right\}}$が一意的に存在して次式が成り立つ。
\begin{align*}
h = \sum_{i \in \varLambda_{n_{0}} \cup \left\{ 0 \right\}} {s_{i}\psi^{i}}
\end{align*}
\end{proof}
\begin{thm}\label{3.3.4.25}
体$K$上の多項式環$K[ X]$上の既約多項式$p$、自然数$\alpha$が与えられたとき、$\deg h < \deg p^{\alpha}$なる零元でないその多項式環$K[ X]$上の任意の多項式$h$が与えられたとき、次式を満たすような$\deg u_{i} < \deg p$なる添数集合$\varLambda_{\alpha}$によって添数づけられた多項式の族$\left\{ u_{i} \right\}_{i \in \varLambda_{\alpha}}$が一意的に存在する。
\begin{align*}
\frac{h}{p^{\alpha}} = \sum_{i \in \varLambda_{\alpha}} \frac{u_{i}}{p^{i}}
\end{align*}
\end{thm}
\begin{proof}
体$K$上の多項式環$K[ X]$上の既約多項式$p$、自然数$\alpha$が与えられたとき、$\deg h < \deg p^{\alpha}$なる零元でないその多項式環$K[ X]$上の任意の多項式$h$が与えられたとき、その多項式$h$の$p$進展開を求めると、$\deg s_{i} < \deg p$が成り立つかつ、次のようになる。
\begin{align*}
h = \sum_{i \in \varLambda_{n} \cup \left\{ 0 \right\}} {s_{i}p^{i}}
\end{align*}
ここで、$\alpha - 1 < n$が成り立つと仮定すると、次のようになる。
\begin{align*}
\frac{h}{p^{\alpha}} &= \sum_{i \in \varLambda_{n} \cup \left\{ 0 \right\}} \frac{s_{i}p^{i}}{p^{\alpha}}\\
&= \sum_{i \in \varLambda_{\alpha - 1} \cup \left\{ 0 \right\}} \frac{s_{i}p^{i}}{p^{\alpha}} + \frac{s_{\alpha}p^{\alpha}}{p^{\alpha}} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{\alpha}} \frac{s_{i}p^{i}}{p^{\alpha}}\\
&= \sum_{i \in \varLambda_{\alpha - 1} \cup \left\{ 0 \right\}} \frac{s_{i}p^{i}}{p^{\alpha}} + s_{\alpha} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{\alpha}} {s_{i}p^{i - \alpha}}\\
&= \sum_{i \in \varLambda_{\alpha - 1} \cup \left\{ 0 \right\}} \frac{s_{i}p^{i}}{p^{\alpha}} + s_{\alpha} + \sum_{i \in \varLambda_{n - \alpha}} {s_{i + \alpha}p^{i}}\\
&= \frac{\sum_{i \in \varLambda_{\alpha - 1} \cup \left\{ 0 \right\}} {s_{i}p^{i}}}{p^{\alpha}} + s_{\alpha} + \sum_{i \in \varLambda_{n - \alpha}} {s_{i + \alpha}p^{i}}
\end{align*}
しかしながら、有理式$\frac{h}{p^{\alpha}}$は真分数式であることから、これは定理\ref{3.3.4.22}に矛盾している。したがって、$n \leq \alpha - 1$が成り立つことになる。このとき、次のように添数集合$\varLambda_{\alpha}$によって添数づけられた多項式の族$\left\{ u_{i} \right\}_{i \in \varLambda_{\alpha}}$が次式のようにおかれると、
\begin{align*}
u_{i} = \left\{ \begin{matrix}
0 & \mathrm{if} & i \in \varLambda_{\alpha - n - 1} \\
s_{\alpha - i} & \mathrm{if} & i \in \varLambda_{\alpha} \setminus \varLambda_{\alpha - n - 1} \\
\end{matrix} \right.\ 
\end{align*}
次のようになる。
\begin{align*}
\frac{h}{p^{\alpha}} &= \sum_{i \in \varLambda_{n} \cup \left\{ 0 \right\}} \frac{s_{i}p^{i}}{p^{\alpha}}\\
&= \sum_{i \in \varLambda_{n} \cup \left\{ 0 \right\}} \frac{s_{i}}{p^{\alpha - i}}\\
&= \sum_{i \in \varLambda_{\alpha} \setminus \varLambda_{\alpha - n - 1}} \frac{s_{\alpha - i}}{p^{i}}\\
&= \sum_{i \in \varLambda_{\alpha - n - 1}} \frac{0}{p^{i}} + \sum_{i \in \varLambda_{\alpha} \setminus \varLambda_{\alpha - n - 1}} \frac{s_{\alpha - i}}{p^{i}}\\
&= \sum_{i \in \varLambda_{\alpha - n - 1}} \frac{u_{i}}{p^{i}} + \sum_{i \in \varLambda_{\alpha} \setminus \varLambda_{\alpha - n - 1}} \frac{u_{i}}{p^{i}}\\
&= \sum_{i \in \varLambda_{\alpha}} \frac{u_{i}}{p^{i}}
\end{align*}
よって、次式を満たすような$\deg u_{i} < \deg p$なる添数集合$\varLambda_{\alpha}$によって添数づけられた多項式の族$\left\{ u_{i} \right\}_{i \in \varLambda_{\alpha}}$が一意的に存在する。
\begin{align*}
\frac{h}{p^{\alpha}} = \sum_{i \in \varLambda_{\alpha}} \frac{u_{i}}{p^{i}}
\end{align*}
\end{proof}
\begin{thm}[部分分数分解]\label{3.3.4.26}
体$K$上の任意の$0$でない有理式$\varphi = \frac{f}{g}$が与えられたとき、これらの多項式たち$f$、$g$が互いに素であるなら、多項式$h$と、$\deg u_{ij} < \deg p_{i}$なる添数集合$\varLambda_{n} \times \varLambda_{\alpha_{i}}$によって添数づけられた多項式の族$\left\{ u_{ij} \right\}_{(i,j) \in \varLambda_{n} \times \varLambda_{\alpha_{i}}}$が一意的に存在して次式が成り立つ。
\begin{align*}
\varphi = \sum_{i \in \varLambda_{n}} {\sum_{j \in \varLambda_{\alpha_{i}}} \frac{u_{ij}}{p^{j}}} + h
\end{align*}
このように有理式$\varphi$を表すことをその有理式$\varphi$の部分分数分解という。
\end{thm}\par
例えば、$\mathbb{R}$上の有理式$\varphi$が次式のように与えられたとき、
\begin{align*}
\varphi = \frac{x^{8} + 2x^{7} + 3x^{6} + 4x^{5} + 3x^{4} + 2x^{3} + x^{2} + 1}{x^{6} + 2x^{5} + 3x^{4} + 4x^{3} + 3x^{2} + 2x + 1}
\end{align*}
次式が成り立つことから、
\begin{align*}
x^{6} + 2x^{5} + 3x^{4} + 4x^{3} + 3x^{2} + 2x + 1 = (x + 1)^{2}\left( x^{2} + 1 \right)^{2}
\end{align*}
次のようになり、
\begin{align*}
\varphi &= \frac{x^{2}(x + 1)^{2}\left( x^{2} + 1 \right)^{2} + 1}{(x + 1)^{2}\left( x^{2} + 1 \right)^{2}}\\
&= \frac{1}{(x + 1)^{2}\left( x^{2} + 1 \right)^{2}} + x^{2} 
\end{align*}
次のようにおくと、
\begin{align*}
\varphi = \frac{a}{x + 1} + \frac{b}{(x + 1)^{2}} + \frac{cx + d}{x^{2} + 1} + \frac{ex + f}{\left( x^{2} + 1 \right)^{2}} + x^{2}
\end{align*}
あとは、これらの定数たち$a$、$b$、$c$、$d$、$e$、$f$を求めればよく、したがって、次のようになる、
\begin{align*}
1 = (a + c)x^{5} + (a + b + 2c + d)x^{4} + (2a + 2c + 2d + e)x^{3} + (2a + 2b + 2c + 2d + 2e + f)x^{2} + (a + c + 2d + e + 2f)x + (a + b + d + f)
\end{align*}
即ち、次式が成り立つ。
\begin{align*}
\begin{pmatrix}
1 & 0 & 1 & 0 & 0 & 0 & 0 \\
1 & 1 & 2 & 1 & 0 & 0 & 0 \\
2 & 0 & 2 & 2 & 1 & 0 & 0 \\
1 & 0 & 1 & 2 & 1 & 2 & 0 \\
1 & 0 & 1 & 2 & 1 & 2 & 0 \\
1 & 1 & 0 & 1 & 0 & 1 & 1 \\
\end{pmatrix}\begin{pmatrix}
a \\
b \\
c \\
d \\
e \\
f \\
 - 1 \\
\end{pmatrix} = \begin{pmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
\end{pmatrix}
\end{align*}
これを解くと、次のようになるので、
\begin{align*}
\begin{pmatrix}
a \\
b \\
c \\
d \\
e \\
f \\
\end{pmatrix} = \begin{pmatrix}
{1}/{2} \\
{1}/{4} \\
 - {1}/{2} \\
{1}/{4} \\
 - {1}/{2} \\
0 \\
\end{pmatrix}
\end{align*}
したがって、次のようになる。
\begin{align*}
\varphi = \frac{\frac{1}{2}}{x + 1} + \frac{\frac{1}{4}}{(x + 1)^{2}} + \frac{- \frac{1}{2}x + \frac{1}{4}}{x^{2} + 1} + \frac{- \frac{1}{2}x}{\left( x^{2} + 1 \right)^{2}} + x^{2}
\end{align*}
\begin{proof}
体$K$上の任意の$0$でない有理式$\varphi = \frac{f}{g}$が与えられたとき、これらの多項式たち$f$、$g$が互いに素であるなら、素元分解の基本定理より、互いに異なる既約なmonicの族$\left\{ p_{i} \right\}_{i \in \varLambda_{n}}$と自然数の族$\left\{ \alpha_{i} \right\}_{i \in \varLambda_{n}}$が存在して$g = {g}_{\mathrm{l.c.}}\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}$が成り立つのであった。このとき、次のようになり、
\begin{align*}
\varphi &= \frac{f}{g} = \frac{f}{{g}_{\mathrm{l.c.}}\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}\\
&= \frac{1}{{g}_{\mathrm{l.c.}}}\frac{f}{\prod_{i \in \varLambda_{n}} p_{i}^{\alpha_{i}}}
\end{align*}
定理\ref{3.3.4.23}より多項式${g}_{\mathrm{l.c.}}h$と、$\deg h_{i} < \deg p_{i}^{\alpha_{i}}$が成り立つかつ、$p_{i}|h_{i}$が成り立たない多項式の族$\left\{ h_{i} \right\}_{i \in \varLambda_{n}}$が一意的に存在して次式が成り立つ。
\begin{align*}
\varphi &= \frac{1}{{g}_{\mathrm{l.c.}}}\left( \sum_{i \in \varLambda_{n}} \frac{h_{i}}{p_{i}^{\alpha_{i}}} + {g}_{\mathrm{l.c.}}h \right)\\
&= \sum_{i \in \varLambda_{n}} \frac{\frac{h_{i}}{{g}_{\mathrm{l.c.}}}}{p_{i}^{\alpha_{i}}} + h
\end{align*}
ここで、$\deg h_{i} = \deg\frac{h_{i}}{{g}_{\mathrm{l.c.}}} < \deg p_{i}^{\alpha_{i}}$が成り立つので、定理\ref{3.3.4.25}より$\forall i \in \varLambda_{n}$に対し、$\deg u_{ij} < \deg p_{i}$なる添数集合$\varLambda_{\alpha}$によって添数づけられた多項式の族$\left\{ u_{ij} \right\}_{j \in \varLambda_{\alpha_{i}}}$が一意的に存在して次式が成り立つ、
\begin{align*}
\varphi = \sum_{i \in \varLambda_{n}} {\sum_{j \in \varLambda_{\alpha_{i}}} \frac{u_{ij}}{p^{j}}} + h
\end{align*}
即ち、多項式$h$と、$\deg u_{ij} < \deg p_{i}$なる添数集合$\varLambda_{n} \times \varLambda_{\alpha_{i}}$によって添数づけられた多項式の族$\left\{ u_{ij} \right\}_{(i,j) \in \varLambda_{n} \times \varLambda_{\alpha_{i}}}$が一意的に存在して次式が成り立つ。
\begin{align*}
\varphi = \sum_{i \in \varLambda_{n}} {\sum_{j \in \varLambda_{\alpha_{i}}} \frac{u_{ij}}{p^{j}}} + h
\end{align*}
\end{proof}
\begin{thebibliography}{50}
  \bibitem{1}
  松坂和夫, 代数系入門, 岩波書店, 1976. 新装版第2刷 p144-152 ISBN978-4-00-029873-5
\end{thebibliography}
\end{document}
