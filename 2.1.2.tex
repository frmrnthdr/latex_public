\documentclass[dvipdfmx]{jsarticle}
\setcounter{section}{1}
\setcounter{subsection}{1}
\usepackage{xr}
\externaldocument{2.1.1}
\input{macro}
\begin{document}
%\hypertarget{ux7ddaux5f62ux5199ux50cf}{%
\subsection{線形写像}%\label{ux7ddaux5f62ux5199ux50cf}}
%\hypertarget{ux7ddaux5f62ux5199ux50cf-1}{%
\subsubsection{線形写像}%\label{ux7ddaux5f62ux5199ux50cf-1}}
\begin{dfn}\label{線形写像}
体$K$上のvector空間$V$、$W$において写像$f:V \rightarrow W$が、$\forall\mathbf{v},\mathbf{w} \in V\forall k,l \in K$に対し、$f\left( k\mathbf{v} + l\mathbf{w} \right) = kf\left( \mathbf{v} \right) + lf\left( \mathbf{w} \right)$を満たすとき、この写像を体$K$上のvector空間として準同型写像、体$K$上のvector空間$V$から$W$への線形写像、$K$-線形変換、体$K$上で線形的な写像などという。体$K$はvector空間が満たすべき条件が揃っているので、体$K$上のvector空間$V$から体$K$への線形写像を特にvector空間$V$の線形形式、1次形式という。
\end{dfn}
\begin{thm}\label{2.1.2.1}
体$K$上のvector空間$V$から$W$への任意の線形写像$f$に対し、$f\left( \mathbf{0} \right) = \mathbf{0}$が成り立つ。
\end{thm}
\begin{proof}
体$K$上のvector空間$V$から$W$への線形写像$f$について、次のようになる。
\begin{align*}
f\left( \mathbf{0} \right) &= f\left( \mathbf{0} \right) + f\left( \mathbf{0} \right) - f\left( \mathbf{0} \right)\\
&= f\left( \mathbf{0} + \mathbf{0} \right) - f\left( \mathbf{0} \right)\\
&= f\left( \mathbf{0} \right) - f\left( \mathbf{0} \right) = \mathbf{0}
\end{align*}
\end{proof}
\begin{thm}\label{2.1.2.2}
体$K$上の$n$次元vector空間$V$、$W$において、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$が与えられておりそのvector空間$W$の任意の族$\left\{ \mathbf{w}_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$が成り立つような線形写像$f:V \rightarrow W$がただ1つ存在し、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$が成り立つならそのときに限り、次式が成り立つ。
\begin{align*}
f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{w}_{i}}
\end{align*}
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$、$W$において、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$が与えられておりそのvector空間$W$の任意の族$\left\{ \mathbf{w}_{i} \right\}_{i \in \varLambda_{n}}$が与えられたとき、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = f'\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$が成り立つような線形写像たち$f:V \rightarrow W$、$f':V \rightarrow W$を考えよう。それらの写像たちは線形写像であり、$\forall\mathbf{v} \in V$に対し、$\mathbf{v} = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$とおかれれば、次のようになるので、
\begin{align*}
f\left( \mathbf{v} \right) &= f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {k_{i}f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{w}_{i}}\\
&= \sum_{i \in \varLambda_{n}} {k_{i}f'\left( \mathbf{v}_{i} \right)}\\
&= f'\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = f'\left( \mathbf{v} \right)
\end{align*}
$f = f'$が成り立つ。これが成り立つなら、もちろん、その体$K$の任意の族$\left\{ k_{i} \right\}_{i \in \varLambda_{n}}$に対し、次式が成り立つ。
\begin{align*}
f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{w}_{i}}
\end{align*}\par
逆に、次式が成り立つなら、
\begin{align*}
f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{w}_{i}}
\end{align*}
$\forall i \in \varLambda_{n}$に対し、$k_{i'} = \left\{ \begin{matrix}
1 & \mathrm{if} & i = i' \\
0 & \mathrm{if} & i \neq i' \\
\end{matrix} \right.\ $とおかれれば、次式が成り立つので、
\begin{align*}
f\left( \mathbf{v}_{i} \right) &= f\left( \sum_{i' \in \varLambda_{n} \setminus \left\{ i \right\}} {0\mathbf{v}_{i'}} + 1\mathbf{v}_{i} \right)\\
&= f\left( \sum_{i' \in \varLambda_{n}} {k_{i'}\mathbf{v}_{i'}} \right)\\
&= \sum_{i' \in \varLambda_{n}} {k_{i'}\mathbf{w}_{i'}}\\
&= \sum_{i' \in \varLambda_{n} \setminus \left\{ i \right\}} {0\mathbf{w}_{i'}} + 1\mathbf{w}_{i} = \mathbf{w}_{i}
\end{align*}
次式のようになり
\begin{align*}
f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = \sum_{i \in \varLambda_{m}} {k_{i}\mathbf{w}_{i}} = \sum_{i \in \varLambda_{m}} {k_{i}f\left( \mathbf{v}_{i} \right)}
\end{align*}
$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$が成り立つ。それが一意的であることは上で述べられた。
\end{proof}
\begin{thm}\label{2.1.2.3}
体$K$上のvector空間$U$、$V$、$W$が与えられたとき、2つの線形写像$f:U \rightarrow V$、$g:V \rightarrow W$において、その合成写像$g \circ f:U \rightarrow W$もその体$K$上で線形的である。
\end{thm}
\begin{proof}
体$K$上のvector空間$U$、$V$、$W$、2つの線形写像$f:U \rightarrow V$、$g:V \rightarrow W$において$\forall k,l \in K\forall\mathbf{v},\mathbf{w} \in U$に対するその合成写像$g \circ f:U \rightarrow W$を考えよう。したがって、次のようになる。
\begin{align*}
g \circ f\left( k\mathbf{v} + l\mathbf{w} \right) &= g\left( f\left( k\mathbf{v} + l\mathbf{w} \right) \right)\\
&= g\left( kf\left( \mathbf{v} \right) + lf\left( \mathbf{w} \right) \right)\\
&= kg\left( f\left( \mathbf{v} \right) \right) + lg\left( f\left( \mathbf{w} \right) \right)\\
&= kg \circ f\left( \mathbf{v} \right) + lg \circ f\left( \mathbf{w} \right)
\end{align*}
よって、その合成写像$g \circ f:U \rightarrow W$もその体$K$上で線形的である。
\end{proof}
%\hypertarget{ux7ddaux5f62ux540cux578bux5199ux50cf}{%
\subsubsection{線形同型写像}%\label{ux7ddaux5f62ux540cux578bux5199ux50cf}}
\begin{dfn}\label{線形同型写像}
体$K$上の2つのvector空間たち$V$、$W$が与えられたとする。線形写像$f:V \rightarrow W$が全単射であるとき、この写像$f$をその体$K$上のそのvector空間$V$からそのvector空間$W$への線形同型写像、同型写像などといい、その体$K$上のそのvector空間$V$からそのvector空間$W$への線形同型写像が存在するとき、そのvector空間$V$とそのvector空間$W$は線形同型であるなどといい$V \cong W$などと書く。特に、体$K$上のそのvector空間$V$からそのvector空間$V$自身への線形同型写像$f:V\overset{\sim}{\rightarrow}V$を体$K$上の$V$の正則な線形変換、可逆な線形変換、線形自己同型写像、自己同型写像などという。
\end{dfn}\par
もちろん、そのvector空間$V$の恒等写像$I_{V}もV$の線形自己同型写像である。
\begin{thm}\label{2.1.2.4}
体$K$上の3つのvector空間たち$U$、$V$、$W$が与えられたとき、次のことが成り立つ。
\begin{itemize}
\item
  任意の体$K$上のvector空間たち$U$、$V$、$W$に対し、2つのその体$K$上の線形同型写像たち$f:U\overset{\sim}{\rightarrow}V$、$g:V\overset{\sim}{\rightarrow}W$の合成写像$g \circ f:U \rightarrow W$もその体$K$上の線形同型写像$g \circ f:U\overset{\sim}{\rightarrow}W$である。
\item
  任意の体$K$上のvector空間たち$V$、$W$に対し、その体$K$上の線形同型写像$f:V\overset{\sim}{\rightarrow}W$の逆写像$f^{- 1}:W \rightarrow V$も体$K$上の線形同型写像$f^{- 1}:W\overset{\sim}{\rightarrow}V$である。
\end{itemize}
\end{thm}
\begin{proof}
任意の体$K$上のvector空間たち$U$、$V$、$W$に対し、2つのその体$K$上の線形同型写像たち$f:U\overset{\sim}{\rightarrow}V$、$g:V\overset{\sim}{\rightarrow}W$の合成写像$g \circ f:U \rightarrow W$において2つのその体$K$上の線形同型写像たち$f:U\overset{\sim}{\rightarrow}V$、$g:V\overset{\sim}{\rightarrow}W$は線形的であるなら、その合成写像$g \circ f:U \rightarrow W$も線形的であり、2つの体$K$上の線形同型写像たち$f:U\overset{\sim}{\rightarrow}V$、$g:V\overset{\sim}{\rightarrow}W$がいずれも全単射であるので、その合成写像$g \circ f:U\overset{\sim}{\rightarrow}W$も全単射であり線形同型写像の定義よりその合成写像$g \circ f:U \rightarrow W$もその体$K$上の線形同型写像$g \circ f:U\overset{\sim}{\rightarrow}W$である。\par
また、任意の体$K$上のvector空間たち$V$、$W$に対し、1つの体$K$上の線形同型写像$f:V\overset{\sim}{\rightarrow}W$において$\forall k,l \in K\forall\mathbf{v},\mathbf{w} \in W$に対し、次のようになる。
\begin{align*}
f^{- 1}\left( k\mathbf{v} + l\mathbf{w} \right) &= f^{- 1}\left( kf \circ f^{- 1}\left( \mathbf{v} \right) + lf \circ f^{- 1}\left( \mathbf{w} \right) \right)\\
&= f^{- 1}\left( kf\left( f^{- 1}\left( \mathbf{v} \right) \right) + lf\left( f^{- 1}\left( \mathbf{w} \right) \right) \right)\\
&= f^{- 1}\left( f\left( kf^{- 1}\left( \mathbf{v} \right) + lf^{- 1}\left( \mathbf{w} \right) \right) \right)\\
&= f^{- 1} \circ f\left( kf^{- 1}\left( \mathbf{v} \right) + lf^{- 1}\left( \mathbf{w} \right) \right)\\
&= kf^{- 1}\left( \mathbf{v} \right) + lf^{- 1}\left( \mathbf{w} \right)
\end{align*}
したがって、その逆写像$f^{- 1}:W \rightarrow V$も線形的であり、その逆写像$f^{- 1}:W \rightarrow V$も全単射であるので、線形同型写像の定義よりその逆写像$f^{- 1}:W\overset{\sim}{\rightarrow}V$もその体$K$上の線形同型写像である。
\end{proof}
\begin{thm}\label{2.1.2.5}
その関係$\cong$は同値関係となる、即ち、次のことが成り立つ。
\begin{itemize}
\item
  任意の体$K$上のvector空間たち$V$に対し、$V \cong V$が成り立つ。
\item
  任意の体$K$上のvector空間たち$V$、$W$に対し、$V \cong W$が成り立つなら、$W \cong V$が成り立つ。
\item
  任意の体$K$上のvector空間たち$U$、$V$、$W$に対し、$U \cong V$かつ$V \cong W$が成り立つなら、$U \cong W$が成り立つ。
\end{itemize}
\end{thm}
\begin{proof}
定理\ref{2.1.2.4}より明らかである。
\end{proof}
\begin{thm}[線形同型定理]\label{2.1.2.6}
体$K$上の$\dim V = n$なる2つの任意のvector空間たち$V$、$W$に対し、次のことが成り立つ。
\begin{itemize}
\item
  $V \cong W$が成り立つなら、ある線形同型写像$f:V\overset{\sim}{\rightarrow}W$が存在して、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$を用いた組$\left\langle f\left( \mathbf{v}_{i} \right) \right\rangle_{i \in \varLambda_{n}}$がそのvector空間$W$の基底をなし、さらに、$\dim V = \dim W$が成り立つ。
\item
  $\dim V = \dim W$が成り立つなら、それらのvector空間たち$V$、$W$の基底たち$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$、$\left\langle \mathbf{w}_{i} \right\rangle_{i \in \varLambda_{n}}$を用いて、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$なる線形写像$f:V \rightarrow W$が定義されれば、その線形写像$f$は線形同型写像で、さらに、$V \cong W$が成り立つ。
\end{itemize}
この定理を線形同型定理という。
\end{thm}\par
これにより、体$K$上の任意の$n$次元のvector空間$V$において$V \cong K^{n}$が成り立つので、その体$K$上の任意の$m$次元のvector空間$V$から任意の$n$次元vector空間$W$への任意の線形写像$f:V \rightarrow W$は全て線形写像$f':K^{m} \rightarrow K^{n}$へ帰着できる。
\begin{proof}
体$K$上の$\dim V = n$なる2つの任意のvector空間たち$V$、$W$に対し、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$が与えられたとき、$V \cong W$が成り立つならば、ある線形同型写像$f:V\overset{\sim}{\rightarrow}W$が存在し、定理\ref{2.1.2.1}より$\forall\mathbf{v} \in V$に対し、その体$K$の族$\left\{ k_{i} \right\}_{i \in \varLambda_{n}}$を用いて$\mathbf{v} = \sum_{i \in \varLambda_{n}} {v_{i}\mathbf{v}_{i}}$とおかれれば、次式が成り立つ。
\begin{align*}
f\left( \sum_{i \in \varLambda_{n}} {v_{i}\mathbf{v}_{i}} \right) = \sum_{i \in \varLambda_{n}} {v_{i}f\left( \mathbf{v}_{i} \right)}
\end{align*}
この線形写像$f$は全射であるから、そのvector空間$W$はそれらのvectors$f\left( \mathbf{v}_{i} \right)$によって生成されることができる。したがって定理\ref{2.1.1.16}より、そのvector空間$W$の基底が存在し、$\forall i \in \varLambda_{n}$に対しそれらのvectors$f\left( \mathbf{v}_{i} \right)$のうちどれかであるから、$\dim W \leq \dim V = n$が成り立つ。\par
また、その体$K$の元$\left\{ c_{i} \right\}_{i \in \varLambda_{n}}$を用いて$\sum_{i \in \varLambda_{n}} {c_{i}f\left( \mathbf{v}_{i} \right)} = \mathbf{0}$が成り立つなら、次のようになる。
\begin{align*}
\sum_{i \in \varLambda_{n}} {c_{i}\mathbf{v}_{i}} &= \sum_{i \in \varLambda_{n}} {c_{i}f^{- 1} \circ f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {c_{i}f^{- 1}\left( f\left( \mathbf{v}_{i} \right) \right)}\\
&= f^{- 1}\left( \sum_{i \in \varLambda_{n}} {c_{i}f\left( \mathbf{v}_{i} \right)} \right)\\
&= f^{- 1}\left( \mathbf{0} \right) = \mathbf{0}
\end{align*}
$\forall i \in \varLambda_{n}$に対し、それらのvectors$\mathbf{v}_{i}$が線形独立であるので、$\forall i \in \varLambda_{n}$に対し、$c_{i} = 0$が成り立つ。以上より、そのvector空間$W$は、$\forall i \in \varLambda_{n}$に対し、それらのvectors$f\left( \mathbf{v}_{i} \right)$によって生成されることができるかつ、$\forall i \in \varLambda_{n}$に対しそれらのvectors$f\left( \mathbf{v}_{i} \right)$が線形独立であるので、その組$\left\langle f\left( \mathbf{v}_{i} \right) \right\rangle_{i \in \varLambda_{n}}$がそのvector空間$W$の基底である。よって、$V \cong W$が成り立つなら、$\dim V = \dim W$が成り立つ。\par
逆に、$\dim V = \dim W = n$が成り立つなら、そのvector空間$W$の基底$\left\langle \mathbf{w}_{i} \right\rangle_{i \in \varLambda_{n}}$が与えられたとき、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$が成り立つような線形写像$f:V \rightarrow W$を考えよう。このとき、$g\left( \mathbf{w}_{i} \right) = \mathbf{v}_{i}$が成り立つような線形写像$g:W \rightarrow V$が考えられれば、$\forall\mathbf{v} \in V$に対し、$\mathbf{v} = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$とおいて、次のようになるかつ、
\begin{align*}
g \circ f\left( \mathbf{v} \right) &= g \circ f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right)\\
&= g\left( \sum_{i \in \varLambda_{n}} {k_{i}f\left( \mathbf{v}_{i} \right)} \right)\\
&= g\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{w}_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {k_{i}g\left( \mathbf{w}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} = \mathbf{v}
\end{align*}
$\forall\mathbf{w} \in W$に対し、$\mathbf{w} = \sum_{i \in \varLambda_{n}} {l_{i}\mathbf{w}_{i}}$とおいて、次のようになるので、
\begin{align*}
f \circ g\left( \mathbf{w} \right) &= f \circ g\left( \sum_{i \in \varLambda_{n}} {l_{i}\mathbf{w}_{i}} \right)\\
&= f\left( \sum_{i \in \varLambda_{n}} {l_{i}g\left( \mathbf{w}_{i} \right)} \right)\\
&= f\left( \sum_{i \in \varLambda_{n}} {l_{i}\mathbf{v}_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {l_{i}f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {l_{i}\mathbf{w}_{i}} = \mathbf{w}
\end{align*}
その線形写像$f$の逆写像がまさしくその線形写像$g$であることになり$V$から$W$への線形同型写像が存在するので、$V \cong W$である。
\end{proof}
%\hypertarget{ux7ddaux5f62ux5199ux50cfux5168ux4f53ux306eux96c6ux5408}{%
\subsubsection{線形写像全体の集合}%\label{ux7ddaux5f62ux5199ux50cfux5168ux4f53ux306eux96c6ux5408}}
\begin{dfn}\label{線形写像の線形結合の定義}
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、そのvector空間$V$からそのvector空間$W$への線形写像全体の集合を$L(V,W)$とおき、ここで、$\forall k,l \in K\forall\mathbf{v} \in V\forall f,g \in L(V,W)$に対し、次のように定義する。
\begin{align*}
\left( kf + lg \right)\left( \mathbf{v} \right) = kf\left( \mathbf{v} \right) + lg\left( \mathbf{v} \right)
\end{align*}
\end{dfn}
\begin{thm}\label{2.1.2.7}
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、$\forall k,l \in K\forall\mathbf{v} \in V\forall f,g \in L(V,W)$に対し、写像$kf + lg$は線形的である。
\end{thm}
\begin{proof}
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、$\forall k,l,k',l' \in K\forall\mathbf{v},\mathbf{w} \in V\forall f,g \in L(V,W)$に対し、次のようになる。
\begin{align*}
\left( kf + lg \right)\left( k'\mathbf{v} + l'\mathbf{w} \right) &= kf\left( k'\mathbf{v} + l'\mathbf{w} \right) + lg\left( k'\mathbf{v} + l'\mathbf{w} \right)\\
&= kk'f\left( \mathbf{v} \right) + kl'f\left( \mathbf{w} \right) + lk'g\left( \mathbf{v} \right) + ll'g\left( \mathbf{w} \right)\\
&= k'kf\left( \mathbf{v} \right) + k'lg\left( \mathbf{v} \right) + l'kg\left( \mathbf{w} \right) + l'lg\left( \mathbf{w} \right)\\
&= k'\left( kf\left( \mathbf{v} \right) + lg\left( \mathbf{v} \right) \right) + l'\left( kf\left( \mathbf{w} \right) + lg\left( \mathbf{w} \right) \right)\\
&= k'\left( kf + lg \right)\left( \mathbf{v} \right) + l'\left( kf + lg \right)\left( \mathbf{w} \right)
\end{align*}
\end{proof}
\begin{thm}\label{2.1.2.8}
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、その集合$L(V,W)$はその体$K$上のvector空間である。
\end{thm}
\begin{proof}
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、そのvector空間$V$からそのvector空間$W$への線形写像全体の集合を$L(V,W)$とおくと、$0:V \rightarrow W;\mathbf{v} \mapsto \mathbf{0}$とおかれれば、$0 \in L(V,W)$が成り立ち、$\forall f,g \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
(f + g)\left( \mathbf{v} \right) &= f\left( \mathbf{v} \right) + g\left( \mathbf{v} \right)\\
&= g\left( \mathbf{v} \right) + f\left( \mathbf{v} \right)\\
&= (g + f)\left( \mathbf{v} \right)\ \because\ f\left( \mathbf{v} \right),g\left( \mathbf{v} \right) \in W
\end{align*}\par
$\forall f,g,h \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
\left( (f + g) + h \right)\left( \mathbf{v} \right) &= (f + g)\left( \mathbf{v} \right) + h\left( \mathbf{v} \right)\\
&= \left( f\left( \mathbf{v} \right) + g\left( \mathbf{v} \right) \right) + h\left( \mathbf{v} \right)\\
&= f\left( \mathbf{v} \right) + \left( g\left( \mathbf{v} \right) + h\left( \mathbf{v} \right) \right)\\
&= f\left( \mathbf{v} \right) + (g + h)\left( \mathbf{v} \right)\\
&= \left( f + (g + h) \right)\left( \mathbf{v} \right)\ \because\ f\left( \mathbf{v} \right),g\left( \mathbf{v} \right),h\left( \mathbf{v} \right) \in W
\end{align*}\par
$\exists 0 \in L(V,W)\forall f \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
(f + 0)\left( \mathbf{v} \right) &= f\left( \mathbf{v} \right) + 0\left( \mathbf{v} \right)\\
&= f\left( \mathbf{v} \right) + \mathbf{0} = f\left( \mathbf{v} \right)
\end{align*}\par
$\forall f \in L(V,W)\exists - f \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
\left( f + ( - f) \right)\left( \mathbf{v} \right) &= f\left( \mathbf{v} \right) + ( - f)\left( \mathbf{v} \right)\\
&= f\left( \mathbf{v} \right) - f\left( \mathbf{v} \right) = \mathbf{0}
\end{align*}\par
$\forall k \in K\forall f,g \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
\left( k(f + g) \right)\left( \mathbf{v} \right) &= k(f + g)\left( \mathbf{v} \right)\\
&= k\left( f\left( \mathbf{v} \right) + g\left( \mathbf{v} \right) \right)\\
&= kf\left( \mathbf{v} \right) + kg\left( \mathbf{v} \right)\\
&= (kf)\left( \mathbf{v} \right) + (kg)\left( \mathbf{v} \right)
\end{align*}\par
$\forall k,l \in K\forall f \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
\left( (k + l)f \right)\left( \mathbf{v} \right) &= (k + l)f\left( \mathbf{v} \right)\\
&= kf\left( \mathbf{v} \right) + lf\left( \mathbf{v} \right)\\
&= (kf)\left( \mathbf{v} \right) + (lf)\left( \mathbf{v} \right)
\end{align*}\par
$\forall k,l \in K\forall f \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
\left( (kl)f \right)\left( \mathbf{v} \right) &= (kl)f\left( \mathbf{v} \right)\\
&= k\left( lf\left( \mathbf{v} \right) \right)\\
&= k\left( (lf)\left( \mathbf{v} \right) \right)\\
&= \left( k(lf) \right)\left( \mathbf{v} \right)
\end{align*}\par
$\exists 1 \in K\forall f \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
(1f)\left( \mathbf{v} \right) = 1f\left( \mathbf{v} \right) = f\left( \mathbf{v} \right)
\end{align*}
\end{proof}
\begin{thm}\label{2.1.2.9}
体$K$上の$m$次元vector空間$V$、$n$次元vector空間$W$が与えられたとき、$\dim{L(V,W)} = mn$が成り立つ。\par
さらにいえば、これらのvector空間たち$V$、$W$の基底として$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{m}}$、$\left\langle \mathbf{w}_{j} \right\rangle_{j \in \varLambda_{n}}$が与えられたとき、組$\left\langle \varphi_{ij}:V \rightarrow W;\sum_{i' \in \varLambda_{m}} {k_{i'}\mathbf{v}_{i'}} \mapsto k_{i}\mathbf{w}_{j} \right\rangle_{(i,j) \in \varLambda_{m} \times \varLambda_{n}}$がそのvector空間$L(V,W)$の基底をなす。
\end{thm}
\begin{proof}
体$K$上の$m$次元vector空間$V$、$n$次元vector空間$W$が与えられたとき、そのvector空間$V$からそのvector空間$W$への線形写像全体の集合$L(V,W)$はvector空間をなすのであった。ここで、これらのvector空間たち$V$、$W$の基底として$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{m}}$、$\left\langle \mathbf{w}_{j} \right\rangle_{j \in \varLambda_{n}}$が与えられたとき、組$\left\langle \varphi_{ij}:V \rightarrow W;\sum_{i' \in \varLambda_{m}} {k_{i'}\mathbf{v}_{i'}} \mapsto k_{i}\mathbf{w}_{j} \right\rangle_{(i,j) \in \varLambda_{m} \times \varLambda_{n}}$について考えよう。\par
$\forall f \in L(V,W)\forall\mathbf{v} \in V$に対し、$\mathbf{v} = \sum_{i \in \varLambda_{m}} {k_{i}\mathbf{v}_{i}}$、$f\left( \mathbf{v}_{i} \right) = \sum_{j \in \varLambda_{n}} {l_{ij}\mathbf{w}_{j}}$とおくと、次のようになるので、
\begin{align*}
f\left( \mathbf{v} \right) &= f\left( \sum_{i \in \varLambda_{m}} {k_{i}\mathbf{v}_{i}} \right)\\
&= \sum_{i \in \varLambda_{m}} {k_{i}f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{m}} {k_{i}\sum_{j \in \varLambda_{n}} {l_{ij}\mathbf{w}_{j}}}\\
&= \sum_{i \in \varLambda_{m}} {\sum_{j \in \varLambda_{n}} {k_{i}l_{ij}\mathbf{w}_{j}}}\\
&= \sum_{j \in \varLambda_{n}} {l_{ij}\sum_{i \in \varLambda_{m}} {k_{i}\mathbf{w}_{j}}}\\
&= \sum_{j \in \varLambda_{n}} {l_{ij}\sum_{i \in \varLambda_{m}} {\varphi_{ij}\left( \sum_{i' \in \varLambda_{m}} {k_{i'}\mathbf{v}_{i'}} \right)}}\\
&= \sum_{j \in \varLambda_{n}} {l_{ij}\sum_{i \in \varLambda_{m}} {\varphi_{ij}\left( \mathbf{v} \right)}}\\
&= \sum_{i \in \varLambda_{m}} {\sum_{j \in \varLambda_{n}} {l_{ij}\varphi_{ij}\left( \mathbf{v} \right)}}
\end{align*}
$f = \sum_{i \in \varLambda_{m}} {\sum_{j \in \varLambda_{n}} {l_{ij}\varphi_{ij}}}$が成り立つ。これにより、そのvector空間$L(V,W)$はその組$\left\langle \varphi_{ij} \right\rangle_{(i,j) \in \varLambda_{m} \times \varLambda_{n}}$によって生成される。\par
さらに、$0:V \rightarrow W;\mathbf{v} \mapsto \mathbf{0}$が次のようにおかれれば、
\begin{align*}
0 = \sum_{(i,j) \in \varLambda_{m} \times \varLambda_{n}} {c_{ij}\varphi_{ij}}
\end{align*}
$\forall i \in \varLambda_{m}$に対し、次のようになる。
\begin{align*}
\mathbf{0} &= 0\left( \mathbf{v}_{i} \right) = \sum_{\left( i',j \right) \in \varLambda_{m} \times \varLambda_{n}} {c_{i'j}\varphi_{i'j}}\left( \mathbf{v}_{i} \right)\\
&= \sum_{i' \in \varLambda_{m}} {\sum_{j \in \varLambda_{n}} {c_{i'j}\varphi_{i'j}\left( \mathbf{v}_{i} \right)}}\\
&= \sum_{j \in \varLambda_{n}} {\sum_{i' \in \varLambda_{m}} {c_{i'j}\varphi_{i'j}\left( \mathbf{v}_{i} \right)}}\\
&= \sum_{j \in \varLambda_{n}} {c_{ij}\mathbf{w}_{j}}
\end{align*}
ここで、それらのvectors$\mathbf{w}_{j}$は線形独立なので、$\forall j \in \varLambda_{n}$に対し、$c_{ij} = 0$が成り立つ。以上より、$\forall(i,j) \in \varLambda_{m} \times \varLambda_{n}$に対し、$c_{ij} = 0$が成り立つので、それらの線形写像たち$\varphi_{ij}$は線形独立である。\par
以上の議論により、その組$\left\langle \varphi_{ij} \right\rangle_{(i,j) \in \varLambda_{m} \times \varLambda_{n}}$がそのvector空間$L(V,W)$の基底をなすので、$\dim{L(V,W)} = mn$が成り立つ。
\end{proof}
\begin{thm}\label{2.1.2.10}
体$K$上の3つのvector空間たち$U$、$V$、$W$が与えられたとき、次のことが成り立つ。
\begin{itemize}
\item
  $\forall f,g \in L(U,V)\forall h \in L(V,W)$に対し、$h \circ (f + g) = h \circ f + h \circ g$が成り立つ。
\item
  $\forall f \in L(U,V)\forall g,h \in L(V,W)$に対し、$(g + h) \circ f = g \circ f + h \circ f$が成り立つ。
\item
  $\forall k \in K\forall f \in L(U,V)\forall g \in L(V,W)$に対し、$g \circ (kf) = (kg) \circ f = k(g \circ f)$が成り立つ。
\item
  $\exists I_{V} \in L(V,V)\exists I_{W} \in L(W,W)\forall f \in L(V,W)$に対し、$I_{W} \circ f = f \circ I_{V} = f$が成り立つ。
\end{itemize}
これにより、写像の乗法$\cdot$を写像の合成$\circ$とするとき、集合$L(V,V)$は環をなす。
\end{thm}
\begin{proof}
体$K$上の3つのvector空間たち$U$、$V$、$W$において、$\forall f,g \in L(U,V)\forall h \in L(V,W)\forall\mathbf{v} \in U$に対し、次のようになる。
\begin{align*}
h \circ (f + g)\left( \mathbf{v} \right) &= h\left( (f + g)\left( \mathbf{v} \right) \right)\\
&= h\left( f\left( \mathbf{v} \right) + g\left( \mathbf{v} \right) \right)\\
&= h\left( f\left( \mathbf{v} \right) \right) + h\left( g\left( \mathbf{v} \right) \right)\\
&= h \circ f\left( \mathbf{v} \right) + h \circ g\left( \mathbf{v} \right)
\end{align*}\par
$\forall f \in L(U,V)\forall g,h \in L(V,W)\forall\mathbf{v} \in U$に対し、次のようになる。
\begin{align*}
(g + h) \circ f\left( \mathbf{v} \right) &= (g + h)\left( f\left( \mathbf{v} \right) \right)\\
&= g\left( f\left( \mathbf{v} \right) \right) + h\left( f\left( \mathbf{v} \right) \right)\\
&= g \circ f\left( \mathbf{v} \right) + h \circ f\left( \mathbf{v} \right)
\end{align*}\par
$\forall k \in K\forall f \in L(U,V)\forall g \in L(V,W)\forall\mathbf{v} \in U$に対し、次のようになる。
\begin{align*}
g \circ (kf)\left( \mathbf{v} \right) &= g\left( kf\left( \mathbf{v} \right) \right) = kg\left( f\left( \mathbf{v} \right) \right) = k(g \circ f)\left( \mathbf{v} \right)\\
(kg) \circ f\left( \mathbf{v} \right) &= (kg)\left( f\left( \mathbf{v} \right) \right) = kg\left( f\left( \mathbf{v} \right) \right) = k(g \circ f)\left( \mathbf{v} \right)
\end{align*}\par
また、$I_{V} \in L(V,V)$、$I_{W} \in L(W,W)$なる写像たち$I_{V}$、$I_{W}$をそれぞれ$I_{V}\left( \mathbf{v} \right) = \mathbf{v}$、$I_{W}\left( \mathbf{w} \right) = \mathbf{w}$と定義すると、$\forall f \in L(V,W)\forall\mathbf{v} \in V$に対し、次のようになる。
\begin{align*}
I_{W} \circ f\left( \mathbf{v} \right) &= I_{W}\left( f\left( \mathbf{v} \right) \right) = f\left( \mathbf{v} \right)\\
f \circ I_{V}\left( \mathbf{v} \right) &= f\left( I_{V}\left( \mathbf{v} \right) \right) = f\left( \mathbf{v} \right)
\end{align*}
\end{proof}
%\hypertarget{ux7ddaux5f62ux5199ux50cfux306eux50cfux3068ux6838}{%
\subsubsection{線形写像の像と核}%\label{ux7ddaux5f62ux5199ux50cfux306eux50cfux3068ux6838}}
\begin{dfn}\label{線形写像の像と核}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、次式のような集合$V(f)$をその写像$f$の値域、像といい$f(V)$、$\mathrm{Im}f$などと書く。
\begin{align*}
V(f) = \left\{ f\left( \mathbf{v} \right) \in W|\mathbf{v} \in V \right\} \subseteq W
\end{align*}
また、次式のような集合、即ち、$f\left( \mathbf{v} \right) = \mathbf{0}$となるようなvector空間$V$の元$\mathbf{v}$全体の集合で写像$f$を対応とみなしたときの逆対応$f^{- 1}$に$\mathbf{v} = \mathbf{0}$とした像をその写像$f$の核といい、$\ker_{K}f$、$\ker f$などと書く。
\end{dfn}\par
その写像$f$を用いたvector$\mathbf{v}$の式$f\left( \mathbf{v} \right) = \mathbf{0}$が与えられたとき、その式$f\left( \mathbf{v} \right) = \mathbf{0}$を方程式とみなせば、このような$\mathbf{v}$はその方程式$f\left( \mathbf{v} \right) = \mathbf{0}$の解にあたることから、その写像$f$の核$\ker f$はその方程式$f\left( \mathbf{v} \right) = \mathbf{0}$の解空間ともいう。
\begin{align*}
\ker f = \left\{ \mathbf{v} \in V|f\left( \mathbf{v} \right) = \mathbf{0} \right\} \subseteq V
\end{align*}
\begin{thm}\label{2.1.2.11}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、次のことが成り立つ。
\begin{itemize}
\item
  その値域$V(f)$はそのvector空間$W$の部分空間である。
\item
  その核$\ker f$はそのvector空間$V$の部分空間である。
\end{itemize}
\end{thm}
\begin{dfn}\label{線形写像の階数と退化次数}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、その写像$f$の値域$V(f)$の次元$\dim{V(f)}$をその写像$f$の階数、その核$\ker f$の次元$\dim{\ker f}$をその写像$f$の退化次数といいそれぞれ${\mathrm{rank}}f$、${\mathrm{nullity}}f$と書く。
\end{dfn}
\begin{proof}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、$f\left( \mathbf{0} \right) = \mathbf{0}$よりvector空間$W$の零vector$\mathbf{0}$はその値域$V(f)$に含まれる。また、$\forall k,l \in K\forall f\left( \mathbf{v} \right),f\left( \mathbf{w} \right) \in V(f)$に対し、その写像$f$は線形的であるから、$kf\left( \mathbf{v} \right) + lf\left( \mathbf{w} \right) = f\left( k\mathbf{v} + l\mathbf{w} \right)$が成り立つ。したがって、$kf\left( \mathbf{v} \right) + lf\left( \mathbf{w} \right) \in V(f)$が成り立ち、その値域$V(f)$はそのvector空間$W$の部分空間である。\par
前述したとおり、$f\left( \mathbf{0} \right) = \mathbf{0}$が成り立つので、vector空間$V$の零vector$\mathbf{0}$はその核$\ker f$に含まれる。また、$\forall k,l \in K\forall\mathbf{v},\mathbf{w} \in \ker f$に対し、$f\left( \mathbf{v} \right) = f\left( \mathbf{w} \right) = \mathbf{0}$が成り立つかつ、その写像$f$は線形的であるから、次のようになる。
\begin{align*}
f\left( k\mathbf{v} + l\mathbf{w} \right) &= kf\left( \mathbf{v} \right) + lf\left( \mathbf{w} \right)\\
&= k\mathbf{0} + l\mathbf{0}\\
&= \mathbf{0} + \mathbf{0} = \mathbf{0}
\end{align*}
したがって、$k\mathbf{v} + l\mathbf{w} \in \ker f$が成り立つので、その核$\ker f$はそのvector空間$V$の部分空間である。
\end{proof}
\begin{thm}\label{2.1.2.12}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、その写像$f$が単射であるならそのときに限り、$\ker f = \left\{ \mathbf{0} \right\}$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、その写像は線形的であるから、$f\left( \mathbf{0} \right) = \mathbf{0}$が成り立つ。その写像$f$が単射$f:V \rightarrowtail W$であるなら、その核$\ker f$の元が$\mathbf{0}$以外あるとし、これを$\mathbf{v}$とすれば、$f\left( \mathbf{0} \right) = f\left( \mathbf{v} \right) = \mathbf{0}$でありその写像$f$が単射$f:V \rightarrowtail W$であることより$\mathbf{0} = \mathbf{v}$となり仮定に矛盾する。ゆえに、その核$\ker f$の元が$\mathbf{0}$のみとなる。\par
また、$\ker f = \left\{ \mathbf{0} \right\}$が成り立つなら、$\forall\mathbf{v},\mathbf{w} \in V$に対し、$f\left( \mathbf{v} \right) = f\left( \mathbf{w} \right)$が成り立つとき、その写像$f$は線形的であるから、$f\left( \mathbf{v} - \mathbf{w} \right) = f\left( \mathbf{v} \right) - f\left( \mathbf{w} \right) = \mathbf{0}$が成り立つ。ここで、$\ker f = \left\{ \mathbf{v} \in V|f\left( \mathbf{v} \right) = \mathbf{0} \right\} = \left\{ \mathbf{0} \right\}$が成り立つので、$\mathbf{v} - \mathbf{w} = \mathbf{0}$が成り立つ。ゆえに、$\mathbf{v} = \mathbf{w}$が得られる。したがって、その写像$f$が単射$f:V \rightarrowtail W$である。
\end{proof}
\begin{thm}\label{2.1.2.13}
体$K$上の2つのvector空間$V$、$W$を用いた線形写像$f:V \rightarrow W$が与えられたとき、$\dim V = n$、${\mathrm{nullity}}f = r$とおくと、その線形写像の核$\ker f$の基底が$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{r}}$とおかれれば、その核$\ker f$はそのvector空間$V$の部分空間であるので、そのvector空間$V$の基底をなすvectors$\mathbf{v}_{i}$が存在するのであった。このとき、vectorの組$\left\langle f\left( \mathbf{v}_{i} \right) \right\rangle_{i \in \varLambda_{n} \setminus \varLambda_{r}}$はその値域$V(f)$の基底となる。
\end{thm}\par
このことは次のようにして示される。
\begin{enumerate}
\item
  その写像$f$が零写像であれば、$\ker f = V$かつ$V(f) = \left\{ \mathbf{0} \right\}$が成り立つから、明らかに成り立つ。
\item
  その写像$f$が零写像でないとしその核$\ker f$の基底を考える。
\item
  その核$\ker f$はそのvector空間$V$の部分空間でありそのvector空間$V$の基底がその核$\ker f$の基底を含むことができる。
\item
  $\forall\mathbf{v} \in V$に対し、これはそのvector空間$V$の基底をなすvectorsの線形結合で表される。したがって、その像$V(f)$の任意の元$f\left( \mathbf{v} \right)$はそれらのvectors$f\left( \mathbf{v}_{i} \right)$の線形結合で表されることができる。
\item
  $c_{i} \in K$として$\sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}f\left( \mathbf{v}_{i} \right)} = \mathbf{0}$が成り立つときを考えると、このような元に写すそのvector空間$V$の元はその核$\ker f$に属され、そのvector空間$V$のこの元をその核$\ker f$の基底をなすvectorsの線形結合で表す。
\item
  そのvector空間$V$の基底をなすvectorsに注意すると、基底の定義より線形独立性が得られる。
\item
  その組$\left\langle f\left( \mathbf{v}_{i} \right) \right\rangle_{i \in \varLambda_{n} \setminus \varLambda_{r}}$はその像$V(f)$の基底をなす。
\end{enumerate}
\begin{proof}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、$f = 0$が成り立つなら、$\ker f = V$が成り立つかつ、$V(f) = \left\{ \mathbf{0} \right\}$が成り立つので、明らかである。ゆえに、$f \neq 0$が成り立つとし$\dim V = n$、${\mathrm{nullity}}f = \dim{\ker f} = r$とおきその核$\ker f$の基底を$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{r}}$とすれば、その核$\ker f$はそのvector空間$V$の部分空間であり定理\ref{2.1.1.22}よりそのvector空間$V$の基底をなすvectors$\mathbf{v}_{i}$が存在する。\par
$\forall\mathbf{v} \in V$に対し、その組$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$はそのvector空間$V$の基底をなすので、$\exists v_{i} \in K$に対し、$\mathbf{v} = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$が成り立つ。また、その組$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{r}}$はその核$\ker f$の基底をなし、$\forall i \in \varLambda_{r}$に対し、$\mathbf{v}_{i} \in \ker f$が成り立つことにより$f\left( \mathbf{v}_{i} \right) = \mathbf{0}$が成り立つ。したがって次のようになる。
\begin{align*}
f\left( \mathbf{v} \right) &= f\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {k_{i}f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{r}} {k_{i}f\left( \mathbf{v}_{i} \right)} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {k_{i}f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{r}} {k_{i}\mathbf{0}} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {k_{i}f\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {k_{i}f\left( \mathbf{v}_{i} \right)}
\end{align*}
これにより、その値域$V(f)$の任意の元$f\left( \mathbf{v} \right)$はその族$\left\{ f\left( \mathbf{v}_i \right) \right\}_{i \in \varLambda_{n} \setminus \varLambda_{r} } $はの線形結合で表されることができるので、その族$\left\{ f\left( \mathbf{v}_i \right) \right\}_{i \in \varLambda_{n} \setminus \varLambda_{r} } $はその像$V(f)$を生成する。\par
次に、$c_{i} \in K$として$\sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}f\left( \mathbf{v}_{i} \right)} = \mathbf{0}$が成り立つときを考えよう。その写像$f$は線形的であるから、次のようになるので、
\begin{align*}
\sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}f\left( \mathbf{v}_{i} \right)} = f\left( \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}} \right) = \mathbf{0}
\end{align*}
$\sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}} \in \ker f$が成り立ち、$\exists - c_{i} \in K$に対し、その核$\ker f$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{r}}$を用いて$\sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}} = \sum_{i \in \varLambda_{r}} {\left( - c_{i} \right)\mathbf{v}_{i}}$が成り立つ。したがって、次のようになるので、
\begin{align*}
\sum_{i \in \varLambda_{n}} {c_{i}\mathbf{v}_{i}} &= \sum_{i \in \varLambda_{r}} {c_{i}\mathbf{v}_{i}} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}}\\
&= - \sum_{i \in \varLambda_{r}} {\left( - c_{i} \right)\mathbf{v}_{i}} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}}\\
&= - \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}} + \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {c_{i}\mathbf{v}_{i}} = \mathbf{0}
\end{align*}
ここで、その族$\left\{ \mathbf{v}_i \right\}_{i \in \varLambda_{n} } $はそのvector空間$V$の基底をなすので、$\forall i \in \varLambda_{n}$に対し、$c_{i} = 0$が成り立つ。これにより、その族$\left\{ f\left( \mathbf{v}_i \right) \right\}_{i \in \varLambda_{n} \setminus \varLambda_{r} } $は線形独立である。
以上の議論により、その族$\left\{ f\left( \mathbf{v}_i \right) \right\}_{i \in \varLambda_{n} \setminus \varLambda_{r} } $はその像$V(f)$の基底をなす。
\end{proof}
\begin{thm}[次元公式]\label{2.1.2.14}
体$K$上の2つのvector空間$V$、$W$を用いた線形写像$f:V \rightarrow W$が与えられ、そのvector空間$V$が有限次元であるとき、次式が成り立つ。
\begin{align*}
{\mathrm{rank}}f + {\mathrm{nullity}}f = \dim{V(f)} + \dim{\ker f} = \dim V
\end{align*}
この式、または、この定理を次元公式という。
\end{thm}\par
このことは次のようにして示される。
\begin{enumerate}
\item
  その写像$f$が零写像であれば、$\ker f = V$かつ$V(f) = \left\{ \mathbf{0} \right\}$が成り立つから、明らかである。
\item
  その写像$f$が零写像でないとしその核$\ker f$の基底を考える。
\item
  その核$\ker f$はそのvector空間$V$の部分空間であり定理\ref{2.1.1.22}よりそのvector空間$V$の基底がその核$\ker f$の基底を含む。
\item
  そのvector空間$V$の基底をなすvectorsのうちその核$\ker f$の基底をなさないものを$\mathbf{v}_{i}$とする。
\item
  このとき、vectorの組$\left\langle f\left( \mathbf{v}_{i} \right) \right\rangle$はその値域$V(f)$の基底となる。
\item
  このようなvectors$f\left( \mathbf{v}_{i} \right)$は全て$\dim V - \dim{\ker f}$つあることに注意すると、示すべきことは示される。
\end{enumerate}
\begin{proof}
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられ、そのvector空間$V$が有限次元であるとき、$f = 0$が成り立つなら、$\ker f = V$が成り立つかつ、$V(f) = \left\{ \mathbf{0} \right\}$が成り立つので、$\dim{\ker f} = \dim V$が成り立つかつ、$\dim{V(f)} = 0$が成り立つので、明らかである。ゆえに、以下、$f \neq 0$が成り立つとする。\par
次に、$\dim V = n$、$\dim{\ker f} = r$としてその核$\ker f$の基底を$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{r}}$とすれば、その核$\ker f$はそのvector空間$V$の部分空間であり定理\ref{2.1.1.22}よりそのvector空間$V$の基底をなす族$\left\{ \mathbf{v}_i \right\}_{i \in \varLambda_{n} } $が存在する。このとき、定理\ref{2.1.2.13}よりその族$\left\{ f\left( \mathbf{v}_i \right) \right\}_{i \in \varLambda_{n} \setminus \varLambda_{r} } $はその像$V(f)$の基底をなすのであった。このようなvectors$f\left( \mathbf{v}_{j}' \right)$は全て$n - r$つあるので、次式が成り立つ。
\begin{align*}
\dim{V(f)} = \dim V - \dim{\ker f}
\end{align*}\par
よって、次式が成り立つ。
\begin{align*}
{\mathrm{rank}}f + {\mathrm{nullity}}f = \dim{V(f)} + \dim{\ker f} = \dim V
\end{align*}
\end{proof}
\begin{thm}\label{2.1.2.15}
体$K$上の$\dim V = \dim W$なる2つのvector空間$V$、$W$を用いた線形写像$f:V \rightarrow W$が与えられたとき、次のことは同値である。
\begin{itemize}
\item
  その写像$f$は線形同型写像である。
\item
  その写像$f$は全射$f:V \twoheadrightarrow W$である。
\item
  その写像$f$は単射$f:V \rightarrowtail W$である。
\item
  $\dim V = {\mathrm{rank}}f = \dim{V(f)}$が成り立つ。
\item
  ${\mathrm{nullity}}f = \dim{\ker f} = 0$が成り立つ。
\end{itemize}
\end{thm}\par
また、写像$f:V \rightarrow W$において、次のことが成り立つという主張とも関係づけられる。
\begin{itemize}
\item
  その写像$f$が全射であるならそのときに限り、$f \circ g = I_{W}$が成り立つような写像$g:W \rightarrow V$が存在する。
\item
  その写像$f$が単射であるならそのときに限り、$g \circ f = I_{V}$が成り立つような写像$g:W \rightarrow V$が存在する。
\end{itemize}
\begin{proof}
体$K$上の$\dim V = \dim W$なる2つのvector空間$V$、$W$を用いた線形写像$f:V \rightarrow W$が与えられたとき、定理\ref{2.1.2.12}より次のことは同値である。
\begin{itemize}
\item
  その写像$f$は単射$f:V \rightarrowtail W$である。
\item
  ${\mathrm{nullity}}f = \dim{\ker f} = 0$が成り立つ。
\end{itemize}
このとき、次元公式より次のことは同値である。
\begin{itemize}
\item
  ${\mathrm{nullity}}f = \dim{\ker f} = 0$が成り立つ。
\item
  $\dim V = {\mathrm{rank}}f = \dim{V(f)}$が成り立つ。
\end{itemize}
このとき、その値域$V(f)$はそのvector空間$W$の部分空間で$\dim W = \dim V = \dim{V(f)}$が成り立つので、$W = V(f)$が成り立つ。ゆえに、その写像$f$は全射$f:V \twoheadrightarrow W$である。逆に、これが成り立つなら、$W = V(f)$が成り立つので、$\dim{V(f)} = \dim W = \dim V$が成り立つ。以上の議論により、次のことは同値である。
\begin{itemize}
\item
  $\dim V = {\mathrm{rank}}f = \dim{V(f)}$が成り立つ。
\item
  その写像$f$は全射$f:V \twoheadrightarrow W$である。
\end{itemize}
このとき、明らかに次のことも同値である。
\begin{itemize}
\item
  その写像$f$は線形同型写像である。
\item
  その写像$f$は全射$f:V \twoheadrightarrow W$である。
\item
  その写像$f$は単射$f:V \rightarrowtail W$である。
\end{itemize}
\end{proof}
\begin{thm}\label{2.1.2.16}
体$K$上の3つの任意の有限次元なvector空間$U$、$V$、$W$における2つの線形写像たち$f:U \rightarrow V$、$g:V \rightarrow W$が与えられたとき、次式が成り立つ。
\begin{align*}
{\mathrm{rank}}{g \circ f} \leq {\mathrm{rank}}f,\ \ {\mathrm{rank}}{g \circ f} \leq {\mathrm{rank}}g
\end{align*}
\end{thm}
\begin{proof}
体$K$上の3つの任意の有限次元なvector空間$U$、$V$、$W$における2つの線形写像たち$f:U \rightarrow V$、$g:V \rightarrow W$が与えられたとき、写像$g|V(f):V(f) \rightarrow W$において、$\forall\mathbf{w} \in W$に対し、次のようになる。
\begin{align*}
\mathbf{w} \in V\left( g|V(f) \right) &\Leftrightarrow \mathbf{w} \in W \land \exists\mathbf{v} \in V(f)\left\lbrack \mathbf{w} = g|V(f)\left( \mathbf{v} \right) \right\rbrack\\
&\Leftrightarrow \mathbf{w} \in W \land \exists\mathbf{u} \in U\left\lbrack \mathbf{w} = g \circ f\left( \mathbf{u} \right) \right\rbrack\\
&\Leftrightarrow \mathbf{w} \in V(g \circ f)
\end{align*}
したがって、$V\left( g|V(f) \right) = V(g \circ f)$が得られる。また、$V\left( g|V(f) \right) \subseteq V(g)$が成り立つので、次のようになる。
\begin{align*}
{\mathrm{rank}}{g \circ f} &= \dim{V(g \circ f)}\\
&= \dim{V\left( g|V(f) \right)}\\
&\leq \dim{V(g)}\\
&= {\mathrm{rank}}g
\end{align*}
また、その値域$V(f)$がそのvector空間$V$の部分空間をなすことから、その写像$g|V(f)$も線形的であるので、次元公式より次のようになる。
\begin{align*}
{\mathrm{rank}}{g \circ f} &= \dim{V(g \circ f)}\\
&= \dim{V\left( g|V(f) \right)}\\
&= {\mathrm{rank}}{g|V(f)}\\
&\leq {\mathrm{rank}}{g|V(f)} + {\mathrm{nullity}}{g|V(f)}\\
&= \dim{V(f)}\\
&= {\mathrm{rank}}f
\end{align*}
\end{proof}
\begin{thm}\label{2.1.2.17}
体$K$上の3つの任意の有限次元なvector空間$U$、$V$、$W$における2つの線形写像たち$f:U \rightarrow V$、$g:V \rightarrow W$が与えられたとき、$g \circ f = 0$が成り立つなら、${\mathrm{rank}}f + {\mathrm{rank}}g \leq \dim V$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の3つの任意の有限次元なvector空間$U$、$V$、$W$における2つの線形写像たち$f:U \rightarrow V$、$g:V \rightarrow W$が与えられたとき、$g \circ f = 0$が成り立つとする。$\forall\mathbf{v} \in V$に対し、$\mathbf{v} \in V(f)$が成り立つなら、$\exists\mathbf{u} \in U$に対し、$\mathbf{v} = f\left( \mathbf{u} \right)$が成り立つ。このとき、次のようになるので、
\begin{align*}
g\left( \mathbf{v} \right) = g\left( f\left( \mathbf{u} \right) \right) = g \circ f\left( \mathbf{u} \right) = 0\left( \mathbf{u} \right) = \mathbf{0}
\end{align*}
$\mathbf{v} \in \ker g$が成り立つ。これにより、$V(f) \subseteq \ker g$が成り立つので、次元公式よりしたがって、次のようになる。
\begin{align*}
{\mathrm{rank}}f + {\mathrm{rank}}g &= \dim{V(f)} + \dim V - {\mathrm{nullity}}g\\
&\leq \dim{\ker g} + \dim V - \dim{\ker g}\\
&= \dim V
\end{align*}
\end{proof}
\begin{thebibliography}{50}
  \bibitem{1}
    松坂和夫, 線型代数入門, 岩波書店, 1980. 新装版第2刷 p74-113 ISBN978-4-00-029872-8
  \bibitem{2}
    松坂和夫, 代数系入門, 岩波書店, 1976. 新装版第2刷 p182-199 ISBN978-4-00-029873-5
  \bibitem{3}
    対馬龍司, 線形代数学講義, 共立出版, 2007. 改訂版8刷 p146-155 ISBN978-4-320-11097-7
\end{thebibliography}
\end{document}
