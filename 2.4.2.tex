\documentclass[dvipdfmx]{jsarticle}
\setcounter{section}{4}
\setcounter{subsection}{1}
\usepackage{xr}
\externaldocument{2.1.1}
\externaldocument{2.1.2}
\externaldocument{2.1.5}
\input{macro}
\begin{document}
%\hypertarget{ux53ccux5bfeux7a7aux9593}{%
\subsection{双対空間}%\label{ux53ccux5bfeux7a7aux9593}}
%\hypertarget{ux7ddaux5f62ux5199ux50cfux306eux4e3bux306aux5b9aux7406ux305fux3061}{%
\subsubsection{線形写像の主な定理たち}%\label{ux7ddaux5f62ux5199ux50cfux306eux4e3bux306aux5b9aux7406ux305fux3061}}\par
双対空間が述べられる前に代表的な定理が先に挙げておかれよう\footnote{ホントは「双対空間を述べる前に代表的な定理を先に挙げておこう」と言おうとしたけど、主語があやふやだったのが許せなくてきたから、無理やり受動態にしたらこうなった。}。
\begin{thm*}[定理\ref{2.1.2.3}の再掲]
体$K$上のvector空間$U$、$V$、$W$が与えられたとき、2つの線形写像$f:U \rightarrow V$、$g:V \rightarrow W$において、その合成写像$g \circ f:U \rightarrow W$もその体$K$上で線形的である。
\end{thm*}
\begin{thm*}[定理\ref{2.1.2.6}の再掲]
体$K$上の$\dim V = n$なる2つの任意のvector空間たち$V$、$W$に対し、次のことが成り立つ。
\begin{itemize}
\item
  $V \cong W$が成り立つなら、ある線形同型写像$f:V\overset{\sim}{\rightarrow}W$が存在して、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$を用いた組$\left\langle f\left( \mathbf{v}_{i} \right) \right\rangle_{i \in \varLambda_{n}}$がそのvector空間$W$の基底をなし、さらに、$\dim V = \dim W$が成り立つ。
\item
  $\dim V = \dim W$が成り立つなら、それらのvector空間たち$V$、$W$の基底たち$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$、$\left\langle \mathbf{w}_{i} \right\rangle_{i \in \varLambda_{n}}$を用いて、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = \mathbf{w}_{i}$なる線形写像$f:V \rightarrow W$が定義されれば、その線形写像$f$は線形同型写像で、さらに、$V \cong W$が成り立つ。
\end{itemize}\par
これにより、体$K$上の任意の$n$次元のvector空間$V$において$V \cong K^{n}$が成り立つので、その体$K$上の任意の$m$次元のvector空間$V$から任意の$n$次元vector空間$W$への任意の線形写像$f:V \rightarrow W$は全て線形写像$f':K^{m} \rightarrow K^{n}$へ帰着できる。
\end{thm*}
\begin{dfn*}[定義\ref{線形写像の線形結合の定義}の再掲]
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、そのvector空間$V$からそのvector空間$W$への線形写像全体の集合を$L(V,W)$とおき、ここで、$\forall k,l \in K\forall\mathbf{v} \in V\forall f,g \in L(V,W)$に対し、次のように定義する。
\begin{align*}
(kf + lg)\left( \mathbf{v} \right) = kf\left( \mathbf{v} \right) + lg\left( \mathbf{v} \right)
\end{align*}
\end{dfn*}
\begin{thm*}[定理\ref{2.1.2.7}の再掲]
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、$\forall k,l \in K\forall\mathbf{v} \in V\forall f,g \in L(V,W)$に対し、写像$kf + lg$は線形的である。
\end{thm*}
\begin{thm*}[定理\ref{2.1.2.8}の再掲]
体$K$上の任意の2つのvector空間$V$、$W$が与えられたとき、その集合$L(V,W)$はその体$K$上のvector空間である。
\end{thm*}
\begin{thm*}[定理\ref{2.1.2.9}の再掲]
体$K$上の$m$次元vector空間$V$、$n$次元vector空間$W$が与えられたとき、$\dim{L(V,W)} = mn$が成り立つ。\par
さらにいえば、これらのvector空間たち$V$、$W$の基底として$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{m}}$、$\left\langle \mathbf{w}_{j} \right\rangle_{j \in \varLambda_{n}}$が与えられたとき、組$\left\langle \varphi_{ij}:V \rightarrow W;\sum_{i' \in \varLambda_{m}} {k_{i'}\mathbf{v}_{i'}} \mapsto k_{i}\mathbf{w}_{j} \right\rangle_{(i,j) \in \varLambda_{m} \times \varLambda_{n}}$がそのvector空間$L(V,W)$の基底をなす。
\end{thm*}
\begin{thm*}[定理\ref{2.1.2.10}の再掲]
体$K$上の3つのvector空間たち$U$、$V$、$W$が与えられたとき、次のことが成り立つ。
\begin{itemize}
\item
  $\forall f,g \in L(U,V)\forall h \in L(V,W)$に対し、$h \circ (f + g) = h \circ f + h \circ g$が成り立つ。
\item
  $\forall f \in L(U,V)\forall g,h \in L(V,W)$に対し、$(g + h) \circ f = g \circ f + h \circ f$が成り立つ。
\item
  $\forall k \in K\forall f \in L(U,V)\forall g \in L(V,W)$に対し、$g \circ (kf) = (kg) \circ f = k(g \circ f)$が成り立つ。
\item
  $\exists I_{V} \in L(V,V)\exists I_{W} \in L(W,W)\forall f \in L(V,W)$に対し、$I_{W} \circ f = f \circ I_{V} = f$が成り立つ。
\end{itemize}
これにより、写像の乗法$\cdot$を写像の合成$\circ$とするとき、集合$L(V,V)$は環をなす。
\end{thm*}
\begin{thm*}[定理\ref{2.1.2.12}の再掲]
体$K$上の2つのvector空間$V$、$W$を用いて線形写像$f:V \rightarrow W$が与えられたとき、その写像$f$が単射であるならそのときに限り、$\ker f = \left\{ \mathbf{0} \right\}$が成り立つ。
\end{thm*}
\begin{thm*}[定理\ref{2.1.5.16}の再掲]
体$K$上の$n$次元vector空間たち$V$、$W$の基底の1つをそれぞれ$\alpha$、$\beta$とし、それらの基底たち$\alpha 、\beta$に関する線形写像$f:V \rightarrow W$の$[ f]^{\beta}_{\alpha} \in M_{nn}(K)$なる表現行列$[ f]^{\beta}_{\alpha}$を用いて写像$F_{\alpha \rightarrow \beta}$が次式のように定義されれば、
\begin{align*}
F_{\alpha \rightarrow \beta}:L(V,W) \rightarrow M_{nn}(K);f \mapsto [ f]^{\beta}_{\alpha}
\end{align*}
$\forall f \in L(V,W)$に対し、次のことは同値である。
\begin{itemize}
\item
  その写像$f$は線形同型写像である。
\item
  その写像$f$は全射$f:V \twoheadrightarrow W$である。
\item
  その写像$f$は単射$f:V \rightarrowtail W$である。
\item
  $n = \mathrm{rank}f = \dim{V(f)}$が成り立つ。
\item
  $\mathrm{nullity}f = \dim{\ker f} = 0$が成り立つ。
\item
  それらの基底たち$\alpha$、$\beta$に関する線形写像$f:V \rightarrow W$の表現行列$[ f]^{\beta}_{\alpha}$は正則行列である、即ち、$[ f]^{\beta}_{\alpha} \in \mathrm{GL}_{n}(K)$が成り立つ。
\item
  その行列$F_{\alpha \rightarrow \beta}(f)$は正則行列である、即ち、$F_{\alpha \rightarrow \beta}(f) \in \mathrm{GL}_{n}(K)$が成り立つ。
\end{itemize}
このとき、次式が成り立つ。
\begin{align*}
f^{- 1} = F_{\beta \rightarrow \alpha}^{- 1}\left( {F_{\alpha \rightarrow \beta}(f)}^{- 1} \right):W \rightarrow V,\\
\left[ f^{- 1} \right]_{\alpha}^{\beta} = {[ f]^{\beta}_{\alpha}}^{- 1},\ \ F_{\beta \rightarrow \alpha}\left( f^{- 1} \right) = {F_{\alpha \rightarrow \beta}(f)}^{- 1}
\end{align*}
\end{thm*}
%\hypertarget{ux7ddaux5f62ux74b0}{%
\subsubsection{線形環}%\label{ux7ddaux5f62ux74b0}}
\begin{dfn}
体$K$上のvector空間$A$が与えられたとき、積$\cdot :A \times A \rightarrow A;\left( \mathbf{v},\mathbf{w} \right) \mapsto \mathbf{vw}$が定義されていてその集合$A$が環をなすかつ、$\forall k \in K\forall\mathbf{v},\mathbf{w} \in A$に対し、次式が成り立つとき、
\begin{align*}
\left( k\mathbf{v} \right)\mathbf{w} = \mathbf{v}\left( k\mathbf{w} \right) = k\left( \mathbf{vw} \right)
\end{align*}
そのvector空間$A$をその体$K$上の線形環、多元環、代数などという。
\end{dfn}
\begin{thm}\label{2.4.2.1}
体$K$上のvector空間$V$における線形写像$f:V \rightarrow V$全体の集合$L(V,V)$は写像の合成$\circ$を積とすれば、その集合$L(V,V)$はその体$K$上の線形環である。
\end{thm}
\begin{proof}
体$K$上のvector空間$V$における線形写像$f:V \rightarrow V$全体の集合$L(V,V)$は写像の合成$\circ$を積とすれば、定理\ref{2.1.2.8}よりその集合$L(V,V)$はその体$K$上のvector空間であり、さらに、定理\ref{2.1.2.10}よりその集合$L(V,V)$は環でもある。ここで、$\forall k \in K\forall f,g \in L(V,V)\forall\mathbf{v} \in V$に対し、次のようになることから、
\begin{align*}
(kf)g\left( \mathbf{v} \right) &= (kf) \circ g\left( \mathbf{v} \right)\\
&= kf\left( g\left( \mathbf{v} \right) \right)\\
&= f\left( kg\left( \mathbf{v} \right) \right)\\
&= f \circ (kg)\left( \mathbf{v} \right)\\
&= f(kg)\left( \mathbf{v} \right)\\
(kf)g\left( \mathbf{v} \right) &= (kf) \circ g\left( \mathbf{v} \right)\\
&= kf\left( g\left( \mathbf{v} \right) \right)\\
&= k(f \circ g)\left( \mathbf{v} \right)\\
&= k(fg)\left( \mathbf{v} \right)
\end{align*}
$(kf)g = f(kg) = k(fg)$が成り立つ。よって、その集合$L(V,V)$はその体$K$上の線形環である。
\end{proof}
%\hypertarget{ux53ccux5bfeux7a7aux9593-1}{%
\subsubsection{双対空間}%\label{ux53ccux5bfeux7a7aux9593-1}}
\begin{dfn}
体$K$上のvector空間$V$における線形写像$f:V \rightarrow K$全体の集合$L(V,K)$、即ち、線形形式全体の集合をそのvector空間$V$の双対空間といい$V^{*}$と書き、これの元を線形形式、線形汎関数、共変vector、余vector、1次形式などという。
\end{dfn}
\begin{thm}\label{2.4.2.2}
体$K$上のvector空間$V$の双対空間$V^{*}$はその体$K$上のvector空間である。
\end{thm}
\begin{proof}
体$K$上のvector空間$V$が与えられたとき、その体$K$自身もその体$K$上のvector空間であるから、定理\ref{2.1.2.8}よりそのvector空間$V$の双対空間$V^{*}$もその体$K$上のvector空間である。
\end{proof}
\begin{thm}\label{2.4.2.3}
体$K$上の$n$次元vector空間$V$、これの基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$が与えられたとき、$\forall\mathbf{a} \in K^{n}\forall i \in \varLambda_{n}$に対し、$\mathbf{a} = \left( a_{i} \right)_{i \in \varLambda_{n}}$とおくと、$\lambda_{\mathbf{a}}\left( \mathbf{v}_{i} \right) = a_{i}$なる線形形式$\lambda_{\mathbf{a}}:V \rightarrow K$について、次式のような写像$\varPhi$は線形同型写像である。
\begin{align*}
\varPhi:K^{n} \rightarrow V^{*};\mathbf{a} \mapsto \lambda_{\mathbf{a}}
\end{align*}
\end{thm}
\begin{dfn} 定理\ref{2.4.2.3}のような線形同型写像$\varPhi$を、ここでは、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$から誘導される線形同型写像ということにする。
\end{dfn}
\begin{proof}
体$K$上の$n$次元vector空間$V$、これの基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$が与えられたとき、$\forall\mathbf{a} \in K^{n}\forall i \in \varLambda_{n}$に対し、$\lambda_{\mathbf{a}}\left( \mathbf{v}_{i} \right) = a_{i}$なる線形形式$\lambda_{\mathbf{a}}:V \rightarrow K$について、次式のような写像$\varPhi$について、
\begin{align*}
\varPhi:K^{n} \rightarrow V^{*};\mathbf{a} \mapsto \lambda_{\mathbf{a}}
\end{align*}
$\forall k,l \in K\forall\mathbf{a},\mathbf{b} \in K^{n}$に対し、$\mathbf{a} = \left( a_{i} \right)_{i \in \varLambda_{n}}$、$\mathbf{b} = \left( b_{i} \right)_{i \in \varLambda_{n}}$とおくと、次のようになり、
\begin{align*}
\varPhi\left( k\mathbf{a} + l\mathbf{b} \right) = \lambda_{k\mathbf{a} + l\mathbf{b}}
\end{align*}
ここで、$\forall\mathbf{v} \in V$に対し、$\mathbf{v} = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$とおかれると、次のようになることから、
\begin{align*}
\lambda_{k\mathbf{a} + l\mathbf{b}}\left( \mathbf{v} \right) &= \lambda_{k\mathbf{a} + l\mathbf{b}}\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {k_{i}\lambda_{k\mathbf{a} + l\mathbf{b}}\left( \mathbf{v}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {k_{i}\left( ka_{i} + lb_{i} \right)}\\
&= k\sum_{i \in \varLambda_{n}} {k_{i}a_{i}} + l\sum_{i \in \varLambda_{n}} {k_{i}b_{i}}\\
&= k\sum_{i \in \varLambda_{n}} {k_{i}\lambda_{\mathbf{a}}\left( \mathbf{v}_{i} \right)} + l\sum_{i \in \varLambda_{n}} {k_{i}\lambda_{\mathbf{b}}\left( \mathbf{v}_{i} \right)}\\
&= k\lambda_{\mathbf{a}}\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) + l\lambda_{\mathbf{b}}\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right)\\
&= k\lambda_{\mathbf{a}}\left( \mathbf{v} \right) + l\lambda_{\mathbf{b}}\left( \mathbf{v} \right)\\
&= \left( k\lambda_{\mathbf{a}} + l\lambda_{\mathbf{b}} \right)\left( \mathbf{v} \right)
\end{align*}
次のようになる。
\begin{align*}
\varPhi\left( k\mathbf{a} + l\mathbf{b} \right) &= \lambda_{k\mathbf{a} + l\mathbf{b}}\\
&= k\lambda_{\mathbf{a}} + l\lambda_{\mathbf{b}}\\
&= k\varPhi\left( \mathbf{a} \right) + l\varPhi\left( \mathbf{b} \right)
\end{align*}
以上より、その写像$\varPhi$は線形写像である。\par
ここで、$\forall\mathbf{a},\mathbf{b} \in K^{n}$に対し、$\mathbf{a} = \left( a_{i} \right)_{i \in \varLambda_{n}}$、$\mathbf{b} = \left( b_{i} \right)_{i \in \varLambda_{n}}$とおくとき、$\mathbf{a} \neq \mathbf{b}$が成り立つなら、$\exists i \in \varLambda_{n}$に対し、$a_{i} \neq b_{i}$が成り立つ。ここで、このような添数$i$を$i'$とおくと、次のようになる。
\begin{align*}
\varPhi\left( \mathbf{a} \right)\left( \mathbf{v}_{i'} \right) = \lambda_{\mathbf{a}}\left( \mathbf{v}_{i'} \right) = a_{i'} \neq b_{i'} = \lambda_{\mathbf{b}}\left( \mathbf{v}_{i'} \right) = \varPhi\left( \mathbf{b} \right)\left( \mathbf{v}_{i'} \right)
\end{align*}
これにより、$\varPhi\left( \mathbf{a} \right) \neq \varPhi\left( \mathbf{b} \right)$が成り立つので、その写像$\varPhi$は単射である。よって、定理\ref{2.1.5.16}よりその写像$\varPhi$は線形同型写像となる。
\end{proof}
\begin{thm}\label{2.4.2.4}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、$\dim V^{*} = \dim V = n$が成り立つかつ、$V \cong V^{*} \cong K^{n}$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、定理\ref{2.4.2.3}より$V^{*} \cong K^{n}$が成り立つかつ、定理\ref{2.1.2.6}より$\dim V = n = \dim K^{n}$が成り立つので、定理\ref{2.1.2.6}より$\dim V^{*} = \dim V = n$が成り立つかつ、$V \cong V^{*} \cong K^{n}$が成り立つ。
\end{proof}
\begin{thm}\label{2.4.2.5}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、vector空間$K^{n}$の標準直交基底$\left\langle \mathbf{e}_{i} \right\rangle_{i \in \varLambda_{n}}$のそのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$から誘導される線形同型写像$\varPhi$による像$\varPhi\left( \mathbf{e}_{i} \right) = \phi_{i}:V \rightarrow K$の組$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$はその双対空間$V^{*}$の基底となる。
\end{thm}
\begin{dfn}
このような体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$のそのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$から誘導される線形同型写像$\varPhi$による像$\phi_{i}:V \rightarrow K$からなる基底$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$をその基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$の双対基底という。
\end{dfn}
\begin{proof}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、vector空間$K^{n}$の標準直交基底$\left\langle \mathbf{e}_{i} \right\rangle_{i \in \varLambda_{n}}$のそのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$から誘導される線形同型写像$\varPhi$による像$\varPhi\left( \mathbf{e}_{i} \right) = \phi_{i}:V \rightarrow K$の組$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$について、定理\ref{2.4.2.3}より$\forall f \in V^{*}\exists\mathbf{a} \in K^{n}$に対し、$\varPhi\left( \mathbf{a} \right) = f$が成り立つ。ここで、$\mathbf{a} = \sum_{i \in \varLambda_{n}} {a_{i}\mathbf{e}_{i}}$が成り立つので、次のようになる。
\begin{align*}
f &= \varPhi\left( \mathbf{a} \right)\\
&= \varPhi\left( \sum_{i \in \varLambda_{n}} {a_{i}\mathbf{e}_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {a_{i}\varPhi\left( \mathbf{e}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {a_{i}\phi_{i}}
\end{align*}
その双対空間$V^{*}$は$i \in \varLambda_{n}$なるvectors$\phi_{i}$から生成される。\par
ここで、$0 = \sum_{i \in \varLambda_{n}} {c_{i}\phi_{i}} \in V^{*}$について、定理\ref{2.4.2.3}より逆写像$\varPhi^{- 1}:V^{*} \rightarrow K^{n}$が存在して線形同型写像でもあるので、次のようになる。
\begin{align*}
\mathbf{0} &= \varPhi^{- 1}(0)\\
&= \varPhi^{- 1}\left( \sum_{i \in \varLambda_{n}} {c_{i}\phi_{i}} \right)\\
&= \sum_{i \in \varLambda_{n}} {c_{i}\varPhi^{- 1}\left( \phi_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {c_{i}\varPhi^{- 1} \circ \varPhi\left( \mathbf{e}_{i} \right)}\\
&= \sum_{i \in \varLambda_{n}} {c_{i}\mathbf{e}_{i}}
\end{align*}
このとき、$i \in \varLambda_{n}$なるvectors$\mathbf{e}_{i}$は線形独立なので、$\forall i \in \varLambda_{n}$に対し、$c_{i} = 0$が成り立つ。これにより、$i \in \varLambda_{n}$なるvectors$\lambda_{\mathbf{e}_{i}}$は互いに線形独立である。\par
以上より、vector空間$K^{n}$の標準直交基底$\left\langle \mathbf{e}_{i} \right\rangle_{i \in \varLambda_{n}}$のそのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$から誘導される線形同型写像$\varPhi$による像$\phi_{i}:V \rightarrow K$の組$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$はその双対空間$V^{*}$の基底となる。
\end{proof}
\begin{thm}\label{2.4.2.6}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、$\forall i \in \varLambda_{n}$に対し、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$の双対基底$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$をなすvector$\phi_{i}$によるそのvector空間$V$の任意の元$\sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$の像は$\phi_{i}\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = k_{i}$を満たす。特に、$\forall j \in \varLambda_{n}$に対し、$\phi_{i}\left( \mathbf{v}_{j} \right) = \delta_{ij}$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、$\forall i \in \varLambda_{n}$に対し、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$の双対基底$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$をなすvector$\phi_{i}$によるそのvector空間$V$の任意の元$\sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$の像について、定義よりしたがって、次のようになる。
\begin{align*}
\phi_{i}\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) &= \sum_{i' \in \varLambda_{n}} {k_{i'}\phi_{i}\left( \mathbf{v}_{i'} \right)}\\
&= \sum_{i' \in \varLambda_{n} \setminus \left\{ i \right\}} {k_{i'}\phi_{i}\left( \mathbf{v}_{i'} \right)} + k_{i}\phi_{i}\left( \mathbf{v}_{i} \right)\\
&= \sum_{i' \in \varLambda_{n} \setminus \left\{ i \right\}} {k_{i'}\lambda_{\mathbf{e}_{i}}\left( \mathbf{v}_{i'} \right)} + k_{i}\lambda_{\mathbf{e}_{i}}\left( \mathbf{v}_{i} \right)\\
&= \sum_{i' \in \varLambda_{n} \setminus \left\{ i \right\}} {k_{i'}0} + k_{i}1 = k_{i}
\end{align*}
特に、$\forall j \in \varLambda_{n}$に対し、$\phi_{i}\left( \mathbf{v}_{j} \right) = \lambda_{\mathbf{e}_{i}}\left( \mathbf{v}_{j} \right) = \delta_{ij}$が成り立つ。
\end{proof}
\begin{thm}\label{2.4.2.7}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、$\forall\mathbf{v} \in V$に対し、$\forall f \in V^{*}$に対し、$f\left( \mathbf{v} \right) = 0$が成り立つならそのときに限り、$\mathbf{v} = \mathbf{0}$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$が与えられたとき、$\forall\mathbf{v} \in V$に対し、$\mathbf{v} \neq \mathbf{0}$が成り立つなら、そのvector空間$V$の基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$の双対基底$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$を用いて$\mathbf{v} = \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}}$とおかれると、$k_{i} \neq 0$なる添数$i$が存在するので、このような添数を$i'$とおくと、次のようになる。
\begin{align*}
\phi_{i'}\left( \mathbf{v} \right) = \phi_{i'}\left( \sum_{i \in \varLambda_{n}} {k_{i}\mathbf{v}_{i}} \right) = k_{i'} \neq 0
\end{align*}
これにより、$\exists f \in V^{*}$に対し、$f\left( \mathbf{v} \right) \neq 0$が成り立つ。対偶律より、$\forall f \in V^{*}$に対し、$f\left( \mathbf{v} \right) = 0$が成り立つなら、$\mathbf{v} = \mathbf{0}$が成り立つ。逆に、$\mathbf{v} = \mathbf{0}$が成り立つなら、$\forall f \in V^{*}$に対し、その写像$f$は線形的なので、$f\left( \mathbf{v} \right) = f\left( \mathbf{0} \right) = 0$が成り立つ。よって、$\forall\mathbf{v} \in V$に対し、$\forall f \in V^{*}$に対し、$f\left( \mathbf{v} \right) = 0$が成り立つならそのときに限り、$\mathbf{v} = \mathbf{0}$が成り立つ。
\end{proof}
%\hypertarget{ux518dux53ccux5bfeux7a7aux9593}{%
\subsubsection{再双対空間}%\label{ux518dux53ccux5bfeux7a7aux9593}}
\begin{dfn}
体$K$上のvector空間$V$の双対空間$V^{*}$の双対空間$V^{**}$をそのvector空間$V$の再双対空間という。
\end{dfn}
\begin{thm}\label{2.4.2.8}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$、再双対空間$V^{**}$について、$\dim V = \dim V^{*} = \dim V^{**} = n$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$、再双対空間$V^{**}$について、定理\ref{2.4.2.4}より$\dim V = \dim V^{*} = n$が成り立つかつ、$\dim V^{*} = \dim V^{**}$が成り立つので、$\dim V = \dim V^{*} = \dim V^{**} = n$が成り立つ。
\end{proof}
\begin{thm}\label{2.4.2.9}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$、再双対空間$V^{**}$について、$\forall\mathbf{v} \in V$に対し、次式のような写像$\widehat{\mathbf{v}}$が定義されるとき、
\begin{align*}
\widehat{\mathbf{v}}:V^{*} \rightarrow K;f \mapsto f\left( \mathbf{v} \right)
\end{align*}
次式のような写像$\varphi$が考えられると、
\begin{align*}
\varphi:V \rightarrow V^{**};\mathbf{v} \mapsto \widehat{\mathbf{v}}
\end{align*}
その写像$\varphi$は線形同型写像である\footnote{この定理によりしばしば$V = V^{**}$が成り立つものとみなされるときもあります。}。
\end{thm}
\begin{dfn}
このような線形同型写像$\varphi$を再双対空間での自然な線形同型写像、再双対空間での標準的線形同型写像という\footnote{ここでいう自然とはその線形写像が特徴づけられるとき、あらかじめ始終集合となすvector空間の基底を選んでおく必要がないような意味だと思っていただければいいかと思います。}。
\end{dfn}
\begin{proof}
体$K$上の$n$次元vector空間$V$の双対空間$V^{*}$、再双対空間$V^{**}$について、$\forall\mathbf{v} \in V$に対し、次式のような写像$\widehat{\mathbf{v}}$が定義されるとき、
\begin{align*}
\widehat{\mathbf{v}}:V^{*} \rightarrow K;f \mapsto f\left( \mathbf{v} \right)
\end{align*}
次式のような写像$\varphi$が考えられると、
\begin{align*}
\varphi:V \rightarrow V^{**};\mathbf{v} \mapsto \widehat{\mathbf{v}}
\end{align*}
$\forall k,l \in K\forall\mathbf{v},\mathbf{w} \in V\forall f \in V^{*}$に対し、次のようになるので、
\begin{align*}
\varphi\left( k\mathbf{v} + l\mathbf{w} \right)(f) &= \widehat{k\mathbf{v} + l\mathbf{w}}(f)\\
&= f\left( k\mathbf{v} + l\mathbf{w} \right)\\
&= kf\left( \mathbf{v} \right) + lf\left( \mathbf{w} \right)\\
&= k\widehat{\mathbf{v}}(f) + l\widehat{\mathbf{w}}(f)\\
&= k\varphi\left( \mathbf{v} \right)(f) + l\varphi\left( \mathbf{w} \right)(f)\\
&= \left( k\varphi\left( \mathbf{v} \right) + l\varphi\left( \mathbf{w} \right) \right)(f)
\end{align*}
$\varphi\left( k\mathbf{v} + l\mathbf{w} \right) = k\varphi\left( \mathbf{v} \right) + l\varphi\left( \mathbf{w} \right)$が成り立つ。ゆえに、その写像$\varphi$は線形的である。\par
ここで、$\forall f \in V^{*}$に対し、次のようになるので、
\begin{align*}
\varphi\left( \mathbf{0} \right)(f) = \widehat{\mathbf{0}}(f) = f\left( \mathbf{0} \right) = 0
\end{align*}
$\left\{ \mathbf{0} \right\} \subseteq \ker\varphi$が成り立つ。一方で、$\forall\mathbf{v} \in \ker\varphi$に対し、$\varphi\left( \mathbf{v} \right) = 0$が成り立つので、$\forall f \in V^{*}$に対し、次のようになる。
\begin{align*}
\varphi\left( \mathbf{v} \right)(f) = \widehat{\mathbf{v}}(f) = f\left( \mathbf{v} \right) = 0
\end{align*}
定理\ref{2.4.2.7}より$\mathbf{v} = \mathbf{0}$が成り立つ。これにより、$\left\{ \mathbf{0} \right\} = \ker\varphi$が成り立つ。このとき、定理\ref{2.1.2.12}よりその線形写像$\varphi$は単射である。ここで、定理\ref{2.1.5.16}よりその線形写像$\varphi$は線形同型写像である。
\end{proof}
%\hypertarget{ux76f4ux4ea4ux7a7aux9593}{%
\subsubsection{直交空間}%\label{ux76f4ux4ea4ux7a7aux9593}}
\begin{dfn}
体$K$上の$n$次元vector空間$V$の部分空間$W$、双対空間$V^{*}$について、$\forall\mathbf{w} \in W$に対し、$f\left( \mathbf{w} \right) = 0$なるその線形形式$f$全体の集合をその部分空間$W$の直交空間といい$W^{\bot}$と書く。
\end{dfn}
\begin{thm}\label{2.4.2.10}
体$K$上の$n$次元vector空間$V$の部分空間$W$について、この部分空間$W$の直交空間$W^{\bot}$はその双対空間$V^{*}$の部分空間である。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の部分空間$W$について、この部分空間$W$の直交空間$W^{\bot}$が与えられたとき、もちろん、$\forall\mathbf{w} \in W$に対し、$0\left( \mathbf{w} \right) = 0$が成り立つので、$0 \in W^{\bot}$が成り立つ。さらに、$\forall k,l \in K\forall f,g \in W^{\bot}\forall\mathbf{w} \in W$に対し、次のようになるので、
\begin{align*}
(kf + lg)\left( \mathbf{w} \right) = kf\left( \mathbf{w} \right) + lg\left( \mathbf{w} \right) = k0 + l0 = 0
\end{align*}
$kf + lg \in W^{\bot}$が成り立つ。以上、定理\ref{2.1.1.9}よりその直交空間$W^{\bot}$はその双対空間$V^{*}$の部分空間である。
\end{proof}
\begin{thm}\label{2.4.2.11}
体$K$上の$n$次元vector空間$V$の部分空間たち$U$、$W$について、$U \subseteq W$が成り立つなら、$W^{\bot} \subseteq U^{\bot}$が成り立つ。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の部分空間たち$U$、$W$について、$U \subseteq W$が成り立つなら、そのvector空間$V$の双対空間$V^{*}$を用いて、$\forall f \in V^{*}$に対し、$f \in W^{\bot}$が成り立つなら、$\forall\mathbf{w} \in W$に対し、$f\left( \mathbf{w} \right) = 0$が成り立つことになる。そこで、$\forall\mathbf{u} \in U$に対し、$\mathbf{u} \in U \subseteq W$が成り立つので、$f\left( \mathbf{u} \right) = 0$が成り立つ。よって、$f \in U^{\bot}$が成り立つので、$W^{\bot} \subseteq U^{\bot}$が得られる。
\end{proof}
\begin{thm}\label{2.4.2.12}
体$K$上の$n$次元vector空間$V$の部分空間$W$が与えられたとき、次式が成り立つ。
\begin{align*}
\dim V = \dim W + \dim W^{\bot}
\end{align*}
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の部分空間$W$が与えられたとき、$r = \dim W$としてそのvector空間$W$の基底を$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{r}}$とおかれれば、定理\ref{2.1.1.22}よりそのvector空間$V$の基底として$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$とおくことができる。この基底$\left\langle \mathbf{v}_{i} \right\rangle_{i \in \varLambda_{n}}$の双対基底$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n}}$を用いて、$\forall f \in V^{*}$に対し、$f = \sum_{i \in \varLambda_{n}} {k_{i}\phi_{i}}$とおくと、$f \in W^{\bot}$が成り立つならそのときに限り、$\forall\mathbf{w} \in W$に対し、$f\left( \mathbf{w} \right) = 0$が成り立つ。もちろん、これが成り立つなら、$\forall i \in \varLambda_{r}$に対し、$f\left( \mathbf{v}_{i} \right) = 0$が成り立つ。逆に、$\mathbf{w} = \sum_{i \in \varLambda_{r}} {l_{i}\mathbf{v}_{i}}$とおかれれば、$\forall i \in \varLambda_{n}$に対し、$f\left( \mathbf{v}_{i} \right) = 0$が成り立つなら、次のようになる。
\begin{align*}
f\left( \mathbf{w} \right) = f\left( \sum_{i \in \varLambda_{r}} {l_{i}\mathbf{v}_{i}} \right) = \sum_{i \in \varLambda_{r}} {l_{i}f\left( \mathbf{v}_{i} \right)} = \sum_{i \in \varLambda_{r}} {l_{i}0} = 0
\end{align*}
ゆえに、$\forall\mathbf{w} \in W$に対し、$f\left( \mathbf{w} \right) = 0$が成り立つことと、$\forall i \in \varLambda_{r}$に対し、$f\left( \mathbf{v}_{i} \right) = 0$が成り立つことは同値である。そこで、$\forall i \in \varLambda_{r}$に対し、$f\left( \mathbf{v}_{i} \right) = 0$が成り立つならそのときに限り、次のようになる。
\begin{align*}
f\left( \mathbf{v}_{i} \right) = \left( \sum_{i' \in \varLambda_{n}} {k_{i'}\phi_{i'}} \right)\left( \mathbf{v}_{i} \right) = \sum_{i' \in \varLambda_{n}} {k_{i'}\phi_{i'}\left( \mathbf{v}_{i} \right)} = k_{i}\phi_{i}\left( \mathbf{v}_{i} \right) = k_{i} = 0
\end{align*}
これにより、これが成り立つならそのときに限り、次式が成り立つ。
\begin{align*}
f = \sum_{i \in \varLambda_{n}} {k_{i}\phi_{i}} = \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {k_{i}\phi_{i}} + \sum_{i \in \varLambda_{r}} {k_{i}\phi_{i}} = \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} {k_{i}\phi_{i}} \in \mathrm{span}\left\{ \phi_{i} \right\}_{i \in \varLambda_{n} \setminus \varLambda_{r}}
\end{align*}
ゆえに、その直交空間$W^{\bot}$の基底として$\left\langle \phi_{i} \right\rangle_{i \in \varLambda_{n} \setminus \varLambda_{r}}$があげられるので、$\dim W^{\bot} = n - r$が得られる。よって、$\dim V = \dim W + \dim W^{\bot}$が成り立つ。
\end{proof}
\begin{thm}\label{2.4.2.13}
体$K$上の$n$次元vector空間$V$の部分空間$W$が与えられたとき、$W^{**} = W^{\bot\bot}$が成り立つ\footnote{この定理により定理\ref{2.4.2.9}と合わせて、$W = W^{**} = W^{\bot\bot}$が成り立つとみなされるときもあります。}。
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の部分空間$W$が与えられたとき、定義より$W^{\bot\bot} \subseteq W^{**}$が成り立つ。あとは、$\dim W^{\bot\bot} = \dim W^{**}$が成り立つことを示せばよくて、実際、定理\ref{2.4.2.4}、定理\ref{2.4.2.13}より次のようになる。
\begin{align*}
\dim W^{\bot\bot} &= \dim V^{*} - \dim W^{\bot}\\
&= \dim V^{*} - \left( \dim V - \dim W \right)\\
&= \dim V - \dim V + \dim W\\
&= \dim W\\
&= \dim W^{*}\\
&= \dim W^{**}
\end{align*}
定理\ref{2.1.1.22}より、よって、$W^{**} = W^{\bot\bot}$が成り立つ。
\end{proof}
\begin{thm}\label{2.4.2.14}
体$K$上の$n$次元vector空間$V$の部分空間たち$U$、$W$が与えられたとき、次式が成り立つ\footnote{定理\ref{2.4.2.13}に従えば、次式が成り立つとみなされるときもあります。
\begin{align*}
(U \cap W)^{\bot} = U^{\bot} + W^{\bot}
\end{align*}}。
\begin{align*}
(U + W)^{\bot} &= U^{\bot} \cap W^{\bot}\\
\left( U^{**} \cap W^{**} \right)^{\bot} &= \left( U^{\bot} + W^{\bot} \right)^{**}
\end{align*}
\end{thm}
\begin{proof}
体$K$上の$n$次元vector空間$V$の部分空間たち$U$、$W$が与えられたとき、もちろん、$U \subseteq U + W$が成り立つので、定理\ref{2.4.2.11}より$(U + W)^{\bot} \subseteq U^{\bot}$が成り立つ。同様にして、$(U + W)^{\bot} \subseteq W^{\bot}$が得られるので、次のようになる。
\begin{align*}
(U + W)^{\bot} = (U + W)^{\bot} \cap (U + W)^{\bot} \subseteq U^{\bot} \cap W^{\bot}
\end{align*}
逆に、$\forall f \in V^{*}$に対し、$f \in U^{\bot} \cap W^{\bot}$が成り立つなら、$\mathbf{u} \in U$、$\mathbf{w} \in W$として、$\forall\mathbf{u} + \mathbf{w} \in U + W$に対し、$f\left( \mathbf{u} \right) = f\left( \mathbf{w} \right) = 0$が成り立つので、次のようになる。
\begin{align*}
f\left( \mathbf{u} + \mathbf{w} \right) = f\left( \mathbf{u} \right) + f\left( \mathbf{w} \right) = 0 + 0 = 0
\end{align*}
ゆえに、$f \in (U + W)^{\bot}$が成り立つので、$(U + W)^{\bot} = U^{\bot} \cap W^{\bot}$が得られる。\par
また、上記の議論により、$\left( U^{\bot} + W^{\bot} \right)^{\bot} = U^{\bot\bot} \cap W^{\bot\bot}$が成り立つので、定理\ref{2.4.2.13}より$\left( U^{**} \cap W^{**} \right)^{\bot} = \left( U^{\bot} + W^{\bot} \right)^{**}$が得られる。
\end{proof}
\begin{thebibliography}{50}
  \bibitem{1}
  松坂和夫, 集合・位相入門, 岩波書店, 1968. 新装版第2刷 p52-59 ISBN978-4-00-029871-1
  \bibitem{2}
  松坂和夫, 代数系入門, 岩波書店, 1976. 新装版第1刷 p182-191 ISBN978-4-00-029873-5
  \bibitem{3}
  佐武一郎, 線型代数学, 裳華房, 1958. 第53版 p193-197 ISBN4-7853-1301-3
\end{thebibliography}
\end{document}
