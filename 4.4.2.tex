\documentclass[dvipdfmx]{jsarticle}
\setcounter{section}{4}
\setcounter{subsection}{1}
\usepackage{xr}
\externaldocument{4.2.6}
\input{macro}
\begin{document}
%\hypertarget{ux9006ux95a2ux6570ux5b9aux7406}{%
\subsection{逆関数定理}%\label{ux9006ux95a2ux6570ux5b9aux7406}}
%\hypertarget{ux9006ux95a2ux6570ux5b9aux7406-1}{%
\subsubsection{逆関数定理}%\label{ux9006ux95a2ux6570ux5b9aux7406-1}}
\begin{thm*}[逆関数定理\ref{4.2.6.14}の再掲]
開集合たち$U$、$V$を用いた$U \subseteq \mathbb{R}^{n}$かつ$V \subseteq \mathbb{R}^{n}$なる関数$f:U \rightarrow V$がその集合$UでC^{1}$級であるかつ、行列$J_{f}\left( \mathbf{x} \right)$の逆行列が存在するかつ、その関数$f$は全単射であるとき、次のことが成り立つ。
\begin{itemize}
\item
  次式が成り立つ\footnote{$J_{f^{- 1}} = \left( J_{f} \circ f^{- 1} \right)^{- 1}$での$- 1$について、1つ目と2つ目が逆関数を表す$- 1$で3つ目が逆行列を表す$- 1$となっていることに注意しよう。}。
\begin{align*}
J_{f^{- 1}} = \left( J_{f} \circ f^{- 1} \right)^{- 1}:V \rightarrow U
\end{align*}
\item
  その逆関数$f^{- 1}$はその集合$V$上で$C^{1}$級である。
\end{itemize}
この定理を逆関数定理などという。
\end{thm*}
%\hypertarget{ux3088ux308aux3088ux3044ux9006ux95a2ux6570ux5b9aux7406}{%
\subsubsection{よりよい逆関数定理}%\label{ux3088ux308aux3088ux3044ux9006ux95a2ux6570ux5b9aux7406}}\par
ここでは、この逆関数定理の一般化を述べていこう。
\begin{thm}[よりよい逆関数定理]\label{4.4.2.1}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n}$がその開集合$U$で$C^{1}$級であるかつ、$\exists\mathbf{a} \in U$に対し、行列$J_{f}\left( \mathbf{a} \right)$の逆行列が存在する、即ち、$\det{J_{f}\left( \mathbf{a} \right)} \neq 0$が成り立つとき、次のことが成り立つ。
\begin{itemize}
\item
  $V \subseteq U$なるそれらの点々$\mathbf{a}$、$f\left( \mathbf{a} \right)$の開近傍$V$、$W$が存在して、関数$f|V:V \rightarrow W$は全単射である。
\item
  その逆関数$\left( f|V \right)^{- 1}$はその開集合$W$で$C^{1}$級であり次式が成り立つ。
\begin{align*}
J_{\left( f|V \right)^{- 1}} = \left( J_{f} \circ \left( f|V \right)^{- 1} \right)^{- 1}:W \rightarrow V
\end{align*}
\item
  その関数$f$がその開集合$V$で$C^{r}$級なら逆関数$\left( f|V \right)^{- 1}$もその開集合$W$で$C^{r}$級である。
\end{itemize}
この定理をここではよりよい逆関数定理ということにする。
\end{thm}\par
なお、上の1つ目の主張から、その逆関数$\left( f|V \right)^{- 1}$がその開集合$W$で$C^{1}$級であることが実は2つ目、3つ目の主張がなくても分かる。実際、関数$f|V$は全単射であり、もちろん、その関数$f|V$はその開近傍$V$で$C^{1}$級であるかつ、行列$J_{f|V}\left( \mathbf{x} \right)$の逆行列が存在するかつ、その関数$f|V$は全単射であるので、定理\ref{4.2.6.14}、即ち、逆関数定理よりその逆関数$\left( f|V \right)^{- 1}$はその開集合$W$で$C^{1}$級である。
\begin{proof}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n};\mathbf{x} \mapsto f\left( \mathbf{x} \right)$がその集合$U$で$C^{1}$級であるかつ、$\exists\mathbf{a} \in U$に対し、行列$J_{f}\left( \mathbf{a} \right)$の逆行列が存在する、即ち、$\det{J_{f}\left( \mathbf{a} \right)} \neq 0$が成り立つとき、関数$F$が次式のように定義されれば、
\begin{align*}
F = \left( F_{i} \right)_{i \in \varLambda_{n}}:\mathbb{R}^{n} \times U \rightarrow \mathbb{R}^{n};\begin{pmatrix}
\mathbf{y} \\
\mathbf{x} \\
\end{pmatrix} \mapsto f\left( \mathbf{x} \right) - \mathbf{y}
\end{align*}
この関数$F$は明らかに$C^{1}$級である。また、次のことが成り立つかつ、
\begin{align*}
F\begin{pmatrix}
f\left( \mathbf{a} \right) \\
\mathbf{a} \\
\end{pmatrix} = f\left( \mathbf{a} \right) - f\left( \mathbf{a} \right) = \mathbf{0}
\end{align*}
$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$、$\nabla^{*} = \left( \partial_{i} \right)_{i \in \varLambda_{n}}$、$\nabla_{*} = \left( \partial_{i} \right)_{i \in \varLambda_{2n} \setminus \varLambda_{n}}$としたとき、${}^{t}\left( \nabla^{*}{}^{t}F \right)\begin{pmatrix}
\mathbf{y} \\
\mathbf{x} \\
\end{pmatrix} = J_{f}\left( \mathbf{x} \right)$のようになることから、$\det{{}^{t}\left( \nabla^{*}{}^{t}F \right)} \neq 0$が成り立つので、$\det{{}^{t}\left( \nabla^{*}{}^{t}F \right)}\begin{pmatrix}
f\left( \mathbf{a} \right) \\
\mathbf{a} \\
\end{pmatrix} \neq 0$が成り立つ。これにより、よりよい陰関数定理より、$V \subseteq U$なるそれらの点々$\mathbf{a}$、$f\left( \mathbf{a} \right)$の開近傍$V$、$W$と関数$g:W \rightarrow V$が存在して、次のことが成り立つ。
\begin{itemize}
\item
  $g \circ f\left( \mathbf{a} \right) = \mathbf{a}$が成り立つ。
\item
  $\forall\begin{pmatrix}
  \mathbf{y} \\
  \mathbf{x} \\
  \end{pmatrix} \in W \times V$に対し、$F\begin{pmatrix}
  \mathbf{y} \\
  \mathbf{x} \\
  \end{pmatrix} = 0$が成り立つならそのときに限り、$\mathbf{x} = g\left( \mathbf{y} \right)$が成り立つ。
\end{itemize}
ここで、$F\begin{pmatrix}
\mathbf{y} \\
\mathbf{x} \\
\end{pmatrix} = 0$が成り立つならそのときに限り、$f\left( \mathbf{x} \right) = \mathbf{y}$が成り立つので、$g \circ f = I_{V}$かつ$f \circ g = I_{W}$が成り立ちその関数$g$はその関数$f|V$の逆関数である。\par
また、その開集合$W$で$f \circ g = f \circ \left( f|V \right)^{- 1} = I_{W}$が成り立つので、この式$f \circ \left( f|V \right)^{- 1} = I_{W}$の両辺に微分すれば、次のようになる。
\begin{align*}
I_{n} = J_{I_{W}} = J_{f \circ \left( f|V \right)^{- 1}} = \left( J_{f} \circ \left( f|V \right)^{- 1} \right)J_{\left( f|V \right)^{- 1}}
\end{align*}
$\forall\mathbf{y} \in W$に対し、$\mathbf{x} = \left( f|V \right)^{- 1}\left( \mathbf{y} \right) = g\left( \mathbf{y} \right)$とおかれれば、その逆関数$\left( f|V \right)^{- 1}$は$C^{1}$級で次式が成り立つ。
\begin{align*}
J_{\left( f|V \right)^{- 1}} = \left( J_{f} \circ \left( f|V \right)^{- 1} \right)^{- 1}:W \rightarrow V
\end{align*}\par
$r = 1$のときはすでに示されている。$r = k$のとき、その関数$f$が$C^{k}$級なら逆関数$\left( f|V \right)^{- 1}$も$C^{k}$級であると仮定すると、$r = k + 1$のとき、その関数$f$が$C^{k + 1}$級なら、次のようになることから、
\begin{align*}
J_{\left( f|V \right)^{- 1}} = \left( J_{f} \circ \left( f|V \right)^{- 1} \right)^{- 1} = \frac{\widetilde{J_{f} \circ \left( f|V \right)^{- 1}}}{\det\left( J_{f} \circ \left( f|V \right)^{- 1} \right)} = \frac{\widetilde{J_{f}}}{\det J_{f}} \circ \left( f|V \right)^{- 1}
\end{align*}
定理\ref{4.2.6.4}よりその行列$J_{\left( f|V \right)^{- 1}}$の各成分は$\mathbf{x}$の関数とみたときその開近傍$V$で$C^{k}$級である。ここで、数学的帰納法の仮定よりその逆関数$\left( f|V \right)^{- 1}$は$C^{k}$級であるから、その関数$J_{\left( f|V \right)^{- 1}}$は$C^{k}$級の関数たちの合成関数であり、したがって、$C^{k}$級である。よって、逆関数$\left( f|V \right)^{- 1}$も$C^{k + 1}$級である。以上より、その関数$f$が$C^{r}$級なら逆関数$\left( f|V \right)^{- 1}$も$C^{r}$級であることが示された。
\end{proof}
%\hypertarget{crux7d1aux540cux76f8}{%
\subsubsection{$C^{r}$級同相}%\label{crux7d1aux540cux76f8}}
\begin{dfn}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた微分可能な関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、その開集合$U$の点$\mathbf{a}$で$\det J_{f} \neq 0$なる点をその関数$f$の通常点、$\det J_{f} = 0$なる点をその関数$f$の臨界点といい、その関数$f$の臨界点全体の集合$C_{f}$によるその値域$V\left( f|C_{f} \right)$をその関数$f$の臨界値集合、折り目、ひだなどという。
\end{dfn}\par
例えば、次のような場合で考えよう。
\begin{align*}
U = \left\{ \begin{pmatrix}
x \\
y \\
\end{pmatrix} \in \mathbb{R}^{2} \middle| x^{2} + y^{2} < 1 \right\},\ \ f:U \rightarrow \mathbb{R}^{2};\begin{pmatrix}
x \\
y \\
\end{pmatrix} \mapsto \begin{pmatrix}
x + y \\
xy \\
\end{pmatrix} = \begin{pmatrix}
u \\
v \\
\end{pmatrix}
\end{align*}
このとき、次のようになるので、
\begin{align*}
\det J_{f} = \left| \begin{matrix}
\frac{\partial}{\partial x}(x + y) & \frac{\partial}{\partial y}(x + y) \\
\frac{\partial}{\partial x}(xy) & \frac{\partial}{\partial y}(xy) \\
\end{matrix} \right| = \left| \begin{matrix}
1 & 1 \\
y & x \\
\end{matrix} \right| = x - y
\end{align*}
その関数$f$の臨界点全体の集合$C_{f}$は次のようになる。
\begin{align*}
C_{f} = \left\{ \begin{pmatrix}
x \\
y \\
\end{pmatrix} \in \mathbb{R}^{2} \middle| y = x \right\}
\end{align*}
このとき、詳しい計算によってその関数$f$の値域$V(f)$は次のようになる。
\begin{align*}
V(f) = \left\{ \begin{pmatrix}
u \\
v \\
\end{pmatrix} \in \mathbb{R}^{2} \middle| \frac{1}{2}u^{2} - \frac{1}{2} < v \leq \frac{1}{4}u^{2} \right\}
\end{align*}
また、その関数$f$のひだ$V\left( f|C_{f} \right)$は次式のように与えられる。
\begin{align*}
V\left( f|C_{f} \right) = \left\{ \begin{pmatrix}
u \\
v \\
\end{pmatrix} \in \mathbb{R}^{2} \middle| v = \frac{1}{4}u^{2} \right\}
\end{align*}
\begin{dfn}
$V \subseteq \mathbb{R}^{m}$かつ$W \subseteq \mathbb{R}^{n}$なる開集合たち$V$、$W$を用いた全単射な関数$f:V \rightarrow W$のうち、さらに、その関数$f$、および、その逆関数$f^{- 1}$がともに$C^{r}$級であるとき、その関数$f$をその開集合$V$からその開集合$W$への$C^{r}$級同相写像という。また、$V \subseteq \mathbb{R}^{m}$かつ$W \subseteq \mathbb{R}^{n}$なる開集合たち$V$、$W$の間にその開集合$V$からその開集合$W$への$C^{r}$級同相写像が存在するとき、これらの開集合たち$V$、$W$は$C^{r}$級同相であるといい$V \cong_{C^{r}}W$と書くことにする。
\end{dfn}\par
もちろん、$r = 0$のとき、その開集合$V$からその開集合$W$への$C^{r}$級同相写像はその部分位相空間$\left( V,\left( \mathfrak{O}_{d_{E^{m}}} \right)_{V} \right)$からその部分位相空間$\left( W,\left( \mathfrak{O}_{d_{E^{n}}} \right)_{W} \right)$への同相写像のことである。
\begin{thm}\label{4.4.2.2}
上記の関係$\cong_{C^{r}}$は同値関係となる、即ち、次のことが成り立つ。
\begin{itemize}
\item
  $U \subseteq \mathbb{R}^{m}$なる開集合$U$に対し、$U \cong_{C^{r}}U$が成り立つ。
\item
  $U \subseteq \mathbb{R}^{m}$かつ$V \subseteq \mathbb{R}^{n}$なる開集合たち$U$、$V$に対し、$U \cong_{C^{r}}V$が成り立つなら、$V \cong_{C^{r}}U$が成り立つ。
\item
  $U \subseteq \mathbb{R}^{m}$かつ$V \subseteq \mathbb{R}^{n}$かつ$W \subseteq \mathbb{R}^{o}$なる開集合たち$U$、$V$、$W$に対し、$U \cong_{C^{r}}V$かつ$V \cong_{C^{r}}W$が成り立つなら、$V \cong_{C^{r}}W$が成り立つ。
\end{itemize}
\end{thm}
\begin{proof}
1つ目の性質は関数$I_{U}:U \rightarrow U;\mathbf{a} \mapsto \mathbf{a}$を考えればよい。2つ目の性質は定義より明らかである。3つ目の性質は定理\ref{4.2.6.8}から従う。
\end{proof}
\begin{dfn}
$\mathbf{a} \in \mathbb{R}^{m}$なる点$\mathbf{a}$の近傍$V$、即ち、$\mathbf{a} \in \mathrm{int}V$なるその$m$次元数空間$\mathbb{R}^{m}$の部分集合$V$を用いた関数$f:V \rightarrow \mathbb{R}^{n}$が次のことを満たすとき、その関数$f$はその点$\mathbf{a}$における局所$C^{r}$級同相写像という。
\begin{itemize}
\item
  $\mathbf{a} \in U \subseteq V$なる開集合$U$が存在して値域$V\left( f|U \right)$は$n$次元数空間$\mathbb{R}^{n}$における開集合である。
\item
  写像$f|U:U \rightarrow V\left( f|U \right)$は$C^{r}$級同相写像である。
\end{itemize}
\end{dfn}
\begin{thm}\label{4.4.2.3}
$1 \leq r$のとき、$\mathbf{a} \in \mathbb{R}^{m}$なる点$\mathbf{a}$の近傍$V$を用いた$C^{r}$級関数$f:V \rightarrow \mathbb{R}^{n}$について、次のことは同値である。
\begin{itemize}
\item
  その関数$f$はその点$\mathbf{a}$において局所$C^{r}$級同相写像である。
\item
  $m = n$かつ$\det J_{f}\left( \mathbf{a} \right) \neq 0$が成り立つ。
\end{itemize}
\end{thm}
\begin{proof}
$1 \leq r$のとき、$\mathbf{a} \in \mathbb{R}^{m}$なる点$\mathbf{a}$の近傍$V$を用いた$C^{r}$級関数$f:V \rightarrow \mathbb{R}^{n}$について、その関数$f$がその点$\mathbf{a}$において局所$C^{r}$級同相写像であるなら、定義より$\mathbf{a} \in U \subseteq V$なる開集合$U$が存在して、$\left( f|U \right)^{- 1} \circ f|U = I_{V}$かつ$f|U \circ \left( f|U \right)^{- 1} = I_{V\left( f|U \right)}$が成り立つので、連鎖律より次のようになる。
\begin{align*}
I_{m} &= J_{I_{V}}\left( \mathbf{a} \right) = J_{\left( f|U \right)^{- 1} \circ f|U}\left( \mathbf{a} \right) = J_{\left( f|U \right)^{- 1}}\left( f\left( \mathbf{a} \right) \right)J_{f|U}\left( \mathbf{a} \right)\\
I_{n} &= J_{I_{V\left( f|U \right)}}\left( f\left( \mathbf{a} \right) \right) = J_{f|U \circ \left( f|U \right)^{- 1}}\left( f\left( \mathbf{a} \right) \right) = J_{f|U}\left( \mathbf{a} \right)J_{\left( f|U \right)^{- 1}}\left( f\left( \mathbf{a} \right) \right)
\end{align*}
これにより、行列たち$J_{f|U}\left( \mathbf{a} \right)$、$J_{\left( f|U \right)^{- 1}}\left( f\left( \mathbf{a} \right) \right)$は正則行列となるので、$m = n$が成り立つかつ、$\det J_{f}\left( \mathbf{a} \right) \neq 0$が成り立つ。\par
逆に、$m = n$かつ$\det J_{f}\left( \mathbf{a} \right) \neq 0$が成り立つなら、定理\ref{4.4.2.1}、即ち、よりよい逆関数定理よりその関数$f$はその点$\mathbf{a}$において局所$C^{r}$級同相写像である。
\end{proof}
%\hypertarget{ux9818ux57dfux4fddux5b58ux5b9aux7406}{%
\subsubsection{領域保存定理}%\label{ux9818ux57dfux4fddux5b58ux5b9aux7406}}
\begin{thm}[領域保存定理]\label{4.4.2.4}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$\det J_{f} \neq 0$が成り立つなら、その値域$V(f)$も開集合である。特に、その開集合$U$が領域であるなら、その値域$V(f)$も領域である。この定理を領域保存定理という。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{n}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$\det J_{f} \neq 0$が成り立つなら、定理\ref{4.4.2.1}、即ち、よりよい逆関数定理より$\forall\mathbf{a} \in U$に対し、$V \subseteq U$なるそれらの点々$\mathbf{a}$、$f\left( \mathbf{a} \right)$の開近傍$V$、$W$が存在して、関数$f|V:V \rightarrow W;\mathbf{x} \mapsto f\left( \mathbf{x} \right)$は全単射である。ここで、$V\left( f|V \right) = W \subseteq V(f)$が成り立つので、点$f\left( \mathbf{a} \right)$はその値域$V(f)$の内点である。ここで、$\alpha \in V(f)$かつその値域$V(f)$の内点でない点$\alpha$は存在しえない\footnote{上記の議論を用いて背理法で容易に分かります。}。ゆえに、その値域$V(f)$の全ての点は内点であるから、$V(f) = \mathrm{int}{V(f)}$が成り立つ。ゆえに、その値域$V(f)$は開集合である。\par
特に、その開集合$U$が領域であるなら、その値域$V(f)$は上記の議論により開集合となる。さらに、その値域$V(f)$が連結でないなら、2つの空集合でない開集合たち$V$、$W$が存在して、$V(f) = V \sqcup W$が成り立つ。このとき、その関数$f$はその開集合$U$で連続であるから、値域たち$V\left( f^{- 1}|V \right)$、$V\left( f^{- 1}|W \right)$は開集合たちであり、さらに、対応$f$は写像であるから、$U = V\left( f^{- 1}|V \right) \sqcup V\left( f^{- 1}|W \right)$が成り立つ。ゆえに、その開集合$U$は連結でないことになり、あとは対偶律により、その開集合$U$が領域であるなら、その値域$V(f)$も領域である。
\end{proof}
%\hypertarget{jacobiux884cux5217ux306eux968eux6570}{%
\subsubsection{Jacobi行列の階数}%\label{jacobiux884cux5217ux306eux968eux6570}}
\begin{thm}\label{4.4.2.5}
開集合たち$U$、$V$を用いた$U \subseteq \mathbb{R}^{n}$かつ$V \subseteq \mathbb{R}^{n}$なる関数$f:U \rightarrow V$が次のことを満たすとき、その関数$f$は$C^{r}$級同相写像である。
\begin{itemize}
\item
  $1 \leq r$としてその関数$f$は$C^{r}$級である。
\item
  $\det J_{f} \neq 0$が成り立つ。
\item
  その関数$f$は全単射である。
\end{itemize}
\end{thm}
\begin{proof}
開集合たち$U$、$V$を用いた$U \subseteq \mathbb{R}^{n}$かつ$V \subseteq \mathbb{R}^{n}$なる関数$f:U \rightarrow V$が次のことを満たすとき、
\begin{itemize}
\item
  $1 \leq r$としてその関数$f$は$C^{r}$級である。
\item
  $\det J_{f} \neq 0$が成り立つ。
\item
  その関数$f$は全単射である。
\end{itemize}
その関数$f$の逆関数$f^{- 1}$が存在する。ここで、定理\ref{4.4.2.3}よりその関数$f$は局所$C^{r}$級同相写像であるので、定義よりその逆関数$f^{- 1}$は$C^{r}$級である。したがって、定義よりその関数$f$はその開集合$U$からその開集合$V$への$C^{r}$級同相写像となる。
\end{proof}
\begin{thm}\label{4.4.2.6}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$\mathbf{a} \in U$なる点$a$で$\mathrm{rank}J_{f}\left( \mathbf{a} \right) = n$が成り立つなら、その点$f(a)$のある開近傍$V$が存在して、$V \subseteq V(f)$が成り立つ。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた$C^{1}$級関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$\mathbf{a} \in U$なる点$\mathbf{a}$で$\mathrm{rank}J_{f}\left( \mathbf{a} \right) = n$が成り立つなら、その行列$J_{f}\left( \mathbf{a} \right)$は$(n,m)$型行列であるから、$\mathrm{rank}J_{f}\left( \mathbf{a} \right) = n \leq m$が成り立つ。ここで、$\mathbf{x} = \left( x_{i} \right)_{i \in \varLambda_{m}}$、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$、$1_{*} = \left( \mathrm{pr}_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{n} }= \left( 1_{i}:U \rightarrow \mathbb{R} ;\mathbf{x} \mapsto x_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{n} }$とおき、次式のように関数たち$F$が定義されると、
\begin{align*}
F=\begin{pmatrix} f \\ 1_{*} \\ \end{pmatrix} :U \rightarrow \mathbb{R}^{n};\mathbf{x} \mapsto \begin{pmatrix}
f\left( \mathbf{x} \right) \\
1_{*} \left( \mathbf{x} \right) \\
\end{pmatrix} = \begin{pmatrix}
f_{1}\left( \mathbf{x} \right) \\
f_{2}\left( \mathbf{x} \right) \\
 \vdots \\
f_{n}\left( \mathbf{x} \right) \\
x_{n + 1} \\
x_{n + 2} \\
 \vdots \\
x_{m} \\
\end{pmatrix}
\end{align*}
$\nabla^{*} =\left( \partial_{i} \right)_{i\in \varLambda_{n} } $、$\nabla_{*} =\left( \partial_{i} \right)_{i\in \varLambda_{m} \setminus \varLambda_{n} } $として次のようになる。
\begin{align*}
J_{F} &= {}^{t} \begin{pmatrix}
 \begin{pmatrix}
  \nabla^{*} \\
  \nabla_{*} \\
 \end{pmatrix} {}^{t}f & \begin{matrix}
  \nabla^{*} {}^{t} 1_{*} \\
  \nabla_{*} {}^{t} 1_{*} \\
 \end{matrix} \\
\end{pmatrix}\\
&= \begin{pmatrix} {}^{t} \left( 
 \begin{pmatrix}
  \nabla^{*} \\
  \nabla_{*} \\
 \end{pmatrix} {}^{t}f \right) \\
\begin{matrix}
  {}^{t} \left( \nabla^{*} {}^{t} 1_{*} \right) & {}^{t} \left( \nabla_{*} {}^{t} 1_{*} \right) \\
\end{matrix} \\
\end{pmatrix} \\
&= \begin{pmatrix} J_{f} \\
\begin{matrix}
  O & {I}_{m - n} \\
\end{matrix} \\
\end{pmatrix} \\
\end{align*}
\begin{comment}
\begin{align*}
J_{F} &= \begin{pmatrix}
\partial_{1}f_{1} & \partial_{2}f_{1} & \cdots & \partial_{n}f_{1} & \partial_{n + 1}f_{1} & \partial_{n + 2}f_{1} & \cdots & \partial_{m}f_{1} \\
\partial_{1}f_{2} & \partial_{2}f_{2} & \cdots & \partial_{n}f_{2} & \partial_{n + 1}f_{2} & \partial_{n + 2}f_{2} & \cdots & \partial_{m}f_{2} \\
 \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
\partial_{1}f_{n} & \partial_{2}f_{n} & \cdots & \partial_{n}f_{n} & \partial_{n + 1}f_{n} & \partial_{n + 2}f_{n} & \cdots & \partial_{m}f_{n} \\
\partial_{1}x_{n + 1} & \partial_{2}x_{n + 1} & \cdots & \partial_{n}x_{n + 1} & \partial_{n + 1}x_{n + 1} & \partial_{n + 2}x_{n + 1} & \cdots & \partial_{m}x_{n + 1} \\
\partial_{1}x_{n + 2} & \partial_{2}x_{n + 2} & \cdots & \partial_{n}x_{n + 2} & \partial_{n + 1}x_{n + 2} & \partial_{n + 2}x_{n + 2} & \cdots & \partial_{m}x_{n + 2} \\
 \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
\partial_{1}x_{m} & \partial_{2}x_{m} & \cdots & \partial_{n}x_{m} & \partial_{n + 1}x_{m} & \partial_{n + 2}x_{m} & \cdots & \partial_{m}x_{m} \\
\end{pmatrix}\\
&= \begin{pmatrix}
\partial_{1}f_{1} & \partial_{2}f_{1} & \cdots & \partial_{n}f_{1} & \partial_{n + 1}f_{1} & \partial_{n + 2}f_{1} & \cdots & \partial_{m}f_{1} \\
\partial_{1}f_{2} & \partial_{2}f_{2} & \cdots & \partial_{n}f_{2} & \partial_{n + 1}f_{2} & \partial_{n + 2}f_{2} & \cdots & \partial_{m}f_{2} \\
 \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
\partial_{1}f_{n} & \partial_{2}f_{n} & \cdots & \partial_{n}f_{n} & \partial_{n + 1}f_{n} & \partial_{n + 2}f_{n} & \cdots & \partial_{m}f_{n} \\
0 & \  & \  & O & 1 & \  & \  & O \\
\  & 0 & \  & \  & \  & 1 & \  & \  \\
\  & \  & \ddots & \  & \  & \  & \ddots & \  \\
O & \  & \  & 0 & O & \  & \  & 1 \\
\end{pmatrix}\\
&= \begin{pmatrix}
J_{f} \\
\begin{matrix}
O & I_{m - n} \\
\end{matrix} \\
\end{pmatrix}
\end{align*}
\end{comment}
特に、次式が成り立つ。
\begin{align*}
J_{F}\left( \mathbf{a} \right) = \begin{pmatrix}
J_{f}\left( \mathbf{a} \right) \\
\begin{matrix}
O & I_{m - n} \\
\end{matrix} \\
\end{pmatrix}
\end{align*}
ここで、仮定の$\mathrm{rank}J_{f}\left( \mathbf{a} \right) = n$が成り立つことにより、その行列$J_{f}\left( \mathbf{a} \right)$の列vector$J_{j}\left( \mathbf{a} \right)$のうち、線形独立な$n$つのものが存在する。ここで、添数を付け替えることにより$J_{f} = \left( J_{j} \right)_{j \in \varLambda_{m}}$とおかれれば、$j \in \varLambda_{n}$なるvectors$J_{j}\left( \mathbf{a} \right)$が線形独立としてもよい。このとき、次のようになり、
\begin{align*}
\det{J_{F}} &= \left| \begin{matrix}
J_{f}\left( \mathbf{a} \right) \\
\begin{matrix}
O & I_{m - n} \\
\end{matrix} \\
\end{matrix} \right|\\
&= \left| \begin{matrix}
{}^{t} \left( \begin{pmatrix} \nabla^{*} \\ \nabla_{*} \end{pmatrix} {}^{t} f \right) \\
\begin{matrix}
O & I_{m - n} \\
\end{matrix} \\
\end{matrix} \right|\\
&= \left| \begin{matrix}
{}^{t} \begin{pmatrix} \nabla^{*} {}^{t} f \\ \nabla_{*} {}^{t} f \end{pmatrix} \\
\begin{matrix}
O & I_{m - n} \\
\end{matrix} \\
\end{matrix} \right|\\
&= \left| \begin{matrix}
{}^{t} \left( \nabla^{*} {}^{t} f \right) & {}^{t} \left( \nabla_{*} {}^{t} f \right) \\
O & I_{m - n} \\
\end{matrix} \right|\\
&= \left| {}^{t} \left( \nabla^{*} {}^{t} f \right) \right|\\
\end{align*}
したがって、次のようになるので、
\begin{align*}
\det{J_{F}} \left( \mathbf{a} \right) &= \left| {}^{t} \left( \nabla^{*} {}^{t} f \right) \right| \left( \mathbf{a} \right) \\
&= \left| \begin{matrix}
J_{1}\left( \mathbf{a} \right) & J_{2}\left( \mathbf{a} \right) & \cdots & J_{n}\left( \mathbf{a} \right) \\
\end{matrix} \right| \neq 0
\end{align*}
定理\ref{4.4.2.3}よりその関数$f$はその点$a$において局所$C^{1}$級同相写像である。これにより、次のことがいえる。
\begin{itemize}
\item
  $\mathbf{a} \in V \subseteq U$なる開集合$V$が存在して値域$V\left( F|V \right)$は$n$次元数空間$\mathbb{R}^{n}$における開集合である。
\item
  写像$F|V:V \rightarrow V\left( F|V \right)$は$C^{1}$級同相写像である。
\end{itemize}
このとき、ある実数たち$c_{i}$、$d_{i}$が存在して、$F\left( \mathbf{a} \right) \in \prod_{i \in \varLambda_{m}} \left( c_{i},\ \ d_{i} \right) \subseteq V\left( F|V \right)$が成り立つ。したがって、次のようになる。
\begin{align*}
\prod_{i \in \varLambda_{n}} \left( c_{i},d_{i} \right) \times \prod_{i \in \varLambda_{m} \setminus \varLambda_{n}} \left( c_{i},d_{i} \right) = \prod_{i \in \varLambda_{m}} \left( c_{i},d_{i} \right) \subseteq V\left( F|V \right) \subseteq V(F)
\end{align*}
ここで、その関数$F$の定義より次式が成り立つ。
\begin{align*}
f\left( \mathbf{a} \right) \in \prod_{i \in \varLambda_{n}} \left( c_{i},d_{i} \right) \subseteq V(f)
\end{align*}
その集合$\prod_{i \in \varLambda_{n}} \left( c_{i},d_{i} \right)$がまさしくその点$f\left( \mathbf{a} \right)$のある開近傍$V$が存在して、$V \subseteq V(f)$が成り立つようなその開近傍$V$である。
\end{proof}
\begin{dfn}
$D \subseteq \mathbb{R}^{m}$なる空集合でない部分集合$D$を用いた関数$f:D \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、$V(f) \subseteq V \subseteq \mathbb{R}^{n}$なる連結な開集合$V$を用いた$C^{k}$級関数$F:V \rightarrow \mathbb{R}$が存在して、次のことを満たすとき、
\begin{itemize}
\item
  その関数$F$はその開集合$V$に含まれるどのような開集合$V'$上でも$F|V' = 0$が成り立つことはない。
\item
  $F \circ f = 0$が成り立つ。
\end{itemize}
$i \in \varLambda_{n}$なる関数たち$f_{i}$はその集合$D$上で$C^{k}$級函数関係にあるといい、そうでないとき、函数関係の意味で独立であるという。なお、その関数$F$を$i \in \varLambda_{n}$なる関数たち$f_{i}$の間に$C^{k}$級函数関係を与える疎零函数という。
\end{dfn}\par
例えば、$f = \begin{pmatrix}
\cos \\
\sin \\
\end{pmatrix}:\mathbb{R} \rightarrow \mathbb{R}^{2}$とおくと、関数$F:\mathbb{R}^{2} \rightarrow \mathbb{R};\begin{pmatrix}
x \\
y \\
\end{pmatrix} \mapsto x^{2} + y^{2} - 1$を用いれば、次式が成り立つ。
\begin{align*}
F \circ f = F\begin{pmatrix}
\cos \\
\sin \\
\end{pmatrix} = \cos^{2} + \sin^{2} - 1 = 1 - 1 = 0
\end{align*}
ゆえに、関数たち$\cos$、$\sin$はその集合$\mathbb{R}$上で函数関係にある。
\begin{thm}\label{4.4.2.7}
$V \subseteq \mathbb{R}^{n}$なる開集合$V$を用いた関数$F:V \rightarrow \mathbb{R}$が与えられたとき、次のことは同値である。
\begin{itemize}
\item
  その関数$F$がその開集合$V$に含まれるどのような開集合$V'$上でも$F|V' = 0$が成り立つことはない。
\item
  $\mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)} = \emptyset$が成り立つ。
\end{itemize}
\end{thm}
\begin{proof}
$V \subseteq \mathbb{R}^{n}$なる開集合$V$を用いた関数$F:V \rightarrow \mathbb{R}$が与えられたとき、その関数$F$がその開集合$V$に含まれるどのような開集合$V'$上でも$F|V' = 0$が成り立つことはないかつ、$\mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)} \supset \emptyset$が成り立つと仮定すると、$I = \mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)}$とおけば、その集合$I$は開集合であるかつ、その集合$I$の定義より$I \subseteq V\left( F^{- 1}|\left\{ 0 \right\} \right)$が成り立つので、次式が成り立つ。
\begin{align*}
\emptyset \subset V\left( F|I \right) \subseteq V\left( F|V\left( F^{- 1}|\left\{ 0 \right\} \right) \right) \subseteq \left\{ 0 \right\}
\end{align*}
ゆえに、$F|I = 0$が成り立つことになるが、これは矛盾している。したがって、その関数$F$がその開集合$V$に含まれるどのような開集合$V'$上でも$F|V' = 0$が成り立つことはないなら、$\mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)} = \emptyset$が成り立つ。\par
一方で、その関数$F$がその開集合$V$に含まれるある開集合$V'$が存在して、$F|V' = 0$が成り立つなら、関数の定義よりその開集合$V'$は空集合でないと考えられるので、$V\left( F|V' \right) = \left\{ 0 \right\}$が成り立つことになり、したがって、次のようになる。
\begin{align*}
\emptyset \subset V' \subseteq V\left( F^{- 1}|V\left( F|V' \right) \right) = V\left( F^{- 1}|\left\{ 0 \right\} \right)
\end{align*}
両辺に開核作用子がとられれば、次のようになる。
\begin{align*}
\emptyset \subset V' = \mathrm{int}V' \subseteq \mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)}
\end{align*}
あとは、対偶律により$\mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)} = \emptyset$が成り立つなら、その関数$F$がその開集合$V$に含まれるどのような開集合$V'$上でも$F|V' = 0$が成り立つことはない。
\end{proof}
\begin{thm}\label{4.4.2.8}
$D \subseteq \mathbb{R}^{m}$なる空集合でない部分集合$D$を用いた関数$f:D \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、ある空集合でない$n$次元数空間$\mathbb{R}^{n}$の開集合$W$が存在して、$W \subseteq V(f)$が成り立つなら、$i \in \varLambda_{n}$なる関数たち$f_{i}$はその集合$D$上で函数関係の意味で独立である。
\end{thm}
\begin{proof}
$D \subseteq \mathbb{R}^{m}$なる空集合でない部分集合$D$を用いた関数$f:D \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、ある空集合でない$n$次元数空間$\mathbb{R}^{n}$の開集合$W$が存在して、$W \subseteq V(f)$が成り立つなら、任意の$V(f) \subseteq V \subseteq \mathbb{R}^{n}$なる連結な開集合$V$を用いた$C^{k}$級関数$F:V \rightarrow \mathbb{R}$に対し、$F \circ f = 0$が成り立つとすれば、$V\left( F|V(f) \right) = \left\{ 0 \right\}$が成り立つ。したがって、次式が成り立つことになり、
\begin{align*}
\emptyset \subset W \subseteq V(f) \subseteq V\left( F^{- 1}|V\left( F|V(f) \right) \right) = V\left( F^{- 1}|\left\{ 0 \right\} \right)
\end{align*}
両辺に開核作用子がとられれば、次のようになる。
\begin{align*}
\emptyset \subset W = \mathrm{int}W \subseteq \mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)}
\end{align*}
これにより、$\mathrm{int}{V\left( F^{- 1}|\left\{ 0 \right\} \right)} \neq \emptyset$が成り立つことになり、定理\ref{4.4.2.7}よりその関数$F$がその開集合$V$に含まれるある開集合$V'$が存在して、$F|V' = 0$が成り立つ。\par
その関数$F$がその開集合$V$に含まれるどのような開集合$V'$上でも$F|V' = 0$が成り立つことはないなら、直ちに、$F \circ f = 0$が成り立つことはないことが分かる。\par
よって、定義より$i \in \varLambda_{n}$なる関数たち$f_{i}$はその集合$D$上で函数関係にあることはない、即ち、函数関係の意味で独立である。
\end{proof}
\begin{thm}\label{4.4.2.9}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、$i \in \varLambda_{n}$なる関数たち$f_{i}$にその開集合$U$上で$C^{0}$級函数関係があれば、$\mathrm{rank}J_{f} < n$が成り立つ。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、$i \in \varLambda_{n}$なる関数たち$f_{i}$にその開集合$U$上で$C^{0}$級函数関係があれば、その行列$J_{f}$は$(n,m)$型行列であるから、$\mathrm{rank}J_{f} \leq \min\left\{ m,n \right\} \leq n$が成り立つ。ここで、$\mathrm{rank}J_{f} < n$がが成り立たない、即ち、$\exists\mathbf{a} \in U$に対し、$\mathrm{rank}J_{f}\left( \mathbf{a} \right) = n$が成り立つなら、定理\ref{4.4.2.6}よりその点$f\left( \mathbf{a} \right)$のある開近傍$V$が存在して、$V \subseteq V(f)$が成り立つ。もちろん、その開近傍$V$は空集合でないので、定理\ref{4.4.2.8}より$i \in \varLambda_{n}$なる関数たち$f_{i}$はその集合$U$上で$C^{0}$級函数関係にあることはない。しかしながら、これは仮定に矛盾する。よって、$\mathrm{rank}J_{f} < n$が成り立つ。
\end{proof}
\begin{thm}\label{4.4.2.10}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、$\mathrm{rank}J_{f} = n$が成り立つなら、$i \in \varLambda_{n}$なる関数たち$f_{i}$がその開集合$U$上で函数関係の意味で独立である。
\end{thm}
\begin{proof} 定理\ref{4.4.2.9}の対偶をとればよい。
\end{proof}
%\hypertarget{ux5c40ux6240ux95a2ux9023ux5b9aux7406}{%
\subsubsection{局所関連定理}%\label{ux5c40ux6240ux95a2ux9023ux5b9aux7406}}
\begin{thm}\label{4.4.2.11}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$\exists r \in \varLambda_{\min\left\{ m,n \right\} - 1}\exists\mathbf{a} \in U$に対し、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$、$f^{*} = \left( f_{i} \right)_{i \in \varLambda_{r}}$、$\nabla^{*} = \left( \partial_{i} \right)_{i \in \varLambda_{r}}$、$\nabla_{*} = \left( \partial_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{r}}$とおくと、その点$\mathbf{a}$の$V \subseteq U$なる近傍$V$が存在して、その近傍$V$上で次式が成り立つかつ\footnote{つまり、次式が成り立つかつ
\begin{align*}
\left| \begin{matrix}
\partial_{1}f_{1} & \partial_{2}f_{1} & \cdots & \partial_{r}f_{1} \\
\partial_{1}f_{2} & \partial_{2}f_{2} & \cdots & \partial_{r}f_{2} \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{1}f_{r} & \partial_{2}f_{r} & \cdots & \partial_{r}f_{r} \\
\end{matrix} \right| \neq 0
\end{align*}}、
\begin{align*}
\det{{}^{t}\left( \nabla^{*}{}^{t}f^{*} \right)} \neq 0
\end{align*}
$\forall p \in \varLambda_{m} \setminus \varLambda_{r}\forall q \in \varLambda_{n} \setminus \varLambda_{r}$に対し、次式が成り立つなら\footnote{つまり、次式が成り立つなら、
\begin{align*}
  \left| \begin{matrix}
  \partial_{1}f_{1} & \partial_{2}f_{1} & \cdots & \partial_{r}f_{1} & \partial_{q}f_{1} \\
  \partial_{1}f_{2} & \partial_{2}f_{2} & \cdots & \partial_{r}f_{2} & \partial_{q}f_{2} \\
   \vdots & \vdots & \ddots & \vdots & \vdots \\
  \partial_{1}f_{r} & \partial_{2}f_{r} & \cdots & \partial_{r}f_{r} & \partial_{q}f_{r} \\
  \partial_{1}f_{p} & \partial_{2}f_{p} & \cdots & \partial_{r}f_{p} & \partial_{q}f_{p} \\
  \end{matrix} \right| = 0
\end{align*} }、
\begin{align*}
\det\begin{pmatrix}
{}^{t}\left( \nabla^{*}{}^{t}f^{*} \right) & \partial_{q}f^{*} \\
{}^{t}\nabla^{*}f_{p} & \partial_{q}f_{p} \\
\end{pmatrix} = 0
\end{align*}
$i \in \varLambda_{r}$なる関数たち$f_{i}$はその集合$U$上で函数関係の意味で独立である。また、その点$\mathbf{a}$のある近傍$W$上で、$i \in \varLambda_{n} \setminus \varLambda_{r}$なる関数たち$f_{i}$は$i \in \varLambda_{r}$なる関数たち$f_{i}$の関数として表される。さらに、$i \in \varLambda_{n}$なる関数たち$f_{i}$にその近傍$V$上で$C^{1}$級函数関係がある。
\end{thm}
\begin{proof}
$U \subseteq \mathbb{R}^{m}$なる開集合$U$を用いた関数$f:U \rightarrow \mathbb{R}^{n}$が与えられたとき、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$とおくと、$\exists r \in \varLambda_{\min\left\{ m,n \right\} - 1}\exists\mathbf{a} \in U$に対し、$f = \left( f_{i} \right)_{i \in \varLambda_{n}}$、$f^{*} = \left( f_{i} \right)_{i \in \varLambda_{r}}$、$\nabla^{*} = \left( \partial_{i} \right)_{i \in \varLambda_{r}}$、$\nabla_{*} = \left( \partial_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{r}}$とおくと、その点$\mathbf{a}$の$V \subseteq U$なる近傍$V$が存在して、その近傍$V$上で次式が成り立つかつ、
\begin{align*}
\det{{}^{t}\left( \nabla^{*}{}^{t}f^{*} \right)} \neq 0
\end{align*}
$\forall p \in \varLambda_{m} \setminus \varLambda_{r}\forall q \in \varLambda_{n} \setminus \varLambda_{r}$に対し、次式が成り立つとする。
\begin{align*}
\det\begin{pmatrix}
{}^{t}\left( \nabla^{*}{}^{t}f^{*} \right) & \partial_{q}f^{*} \\
{}^{t}\nabla^{*}f_{p} & \partial_{q}f_{p} \\
\end{pmatrix} = 0
\end{align*}
このとき、$f\left( \mathbf{a} \right) = \mathbf{b} \in \mathbb{R}^{n}$とおかれ、さらに、次式のように$\varphi $なる関数$\varphi$が定義されると、
\begin{align*}
\varphi = f^{*} \circ 1^{*} - 1_{*} :U \times \mathbb{R}^{r} &\rightarrow \mathbb{R}^{r};\begin{pmatrix} 
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} \mapsto f^{*}\left( \mathbf{x} \right) - \mathbf{y}, \\
1^{*} :U \times \mathbb{R}^{r} \rightarrow \mathbb{R}^{m};\begin{pmatrix} 
  \mathbf{x} \\
  \mathbf{y} \\
\end{pmatrix} \mapsto \mathbf{x} &,\ \ 1_{*} :U \times \mathbb{R}^{r} \rightarrow \mathbb{R}^{r};\begin{pmatrix} 
  \mathbf{x} \\
  \mathbf{y} \\
\end{pmatrix} \mapsto \mathbf{y} ,\\
\varphi = \left( \varphi_{i} \right)_{i \in \varLambda_{r}} &,\ \ \begin{pmatrix} 1^{*} \\ 1_{*} \end{pmatrix} = \left( 1_{i} \right)_{i \in \varLambda_{m + r}} 
\end{align*}
その関数$\varphi$は明らかに$C^{1}$級関数でありその近傍$V$上で次のようになることから\footnote{ここでもEinstein縮約記法を用いれば、$\forall i,j\in \varLambda_r $に対し、$k\in \varLambda_m $として次のようになる。
\begin{align*}
\partial_j \varphi_i &= \partial_j \left( f_i \circ 1^* - 1_{m + i} \right) \\
&= \partial_j \left( f_i \circ 1^* \right) -\partial_j 1_{m + i} \\
&= \left(\partial_k f_i \circ 1^* \right) \partial_j 1_k -\partial_j 1_{m + i} \\
&= \left(\partial_k f_i \circ 1^* \right) \delta_{jk} -\partial_{j,m+i} \\
&= \partial_j f_i \circ 1^*
\end{align*} }、
\begin{align*}
{}^{t}\left( \nabla^{*}{}^{t}\varphi \right) &= {}^{t} \left( \nabla^{*} {}^{t} \left( f^* \circ 1^* -1_* \right)\right) \\
&= {}^{t} \left( \nabla^{*} {}^{t} \left( f^* \circ 1^* \right)\right) - {}^{t} \left( \nabla^{*} {}^{t} 1_* \right) \\
&= {}^{t} \left( \begin{pmatrix} \nabla^* \\ \nabla_* \end{pmatrix} {}^{t} f^* \circ 1^* \right) {}^{t} \left( \nabla^* {}^{t} 1_* \right) - {}^{t} \left( \nabla^{*} {}^{t} 1_* \right) \\
&= \begin{pmatrix} {}^t \left( \nabla^* {}^t f^* \right) \circ 1^* & {}^t \left( \nabla_* {}^t f^* \right) \circ 1^* \end{pmatrix} \begin{pmatrix} I_r \\ O \end{pmatrix} -O \\
&= {}^t \left( \nabla^* {}^t f^* \right) \circ 1^* I_r + {}^t \left( \nabla_* {}^t f^* \right) \circ 1^* O \\
&= {}^t \left( \nabla^* {}^t f^* \right) \circ 1^*
\end{align*}
したがって、$\exists\begin{pmatrix}
\mathbf{a} \\
\mathbf{b} \\
\end{pmatrix} \in \mathbb{R}^{m} \times \mathbb{R}^{n}$に対し、$\varphi\begin{pmatrix}
\mathbf{a} \\
\mathbf{b} \\
\end{pmatrix} = \mathbf{0}$かつ、その関数$\varphi$を変数$\mathbf{x}$の関数とみたとき、$\det{{}^{t}\left( \nabla^{*}{}^{t}\varphi \right)}\begin{pmatrix}
\mathbf{a} \\
\mathbf{b} \\
\end{pmatrix} = \det{{}^{t}\left( \nabla^{*}{}^{t}f^{*} \right)}\begin{pmatrix}
\mathbf{a} \\
\mathbf{b} \\
\end{pmatrix} \neq 0$が成り立つので、よりよい陰関数定理より$i \in \varLambda_{r}$なる$C^{1}$級関数$g_{i}$が存在して、うまく近傍をとることで、$g^{*} = \left( g_{i} \right)_{i \in \varLambda_{r}}$、$\mathbf{y}^{*} = \left( y_{i} \right)_{i \in \varLambda_{r}}$、$\mathbf{x}_{*} = \left( x_{i} \right)_{i \in \varLambda_{m} \setminus \varLambda_{r}}$とおくと、次式が成り立つようにすることができる。
\begin{align*}
x_{i} = g_{i}\begin{pmatrix}
\mathbf{y}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix}
\end{align*}
これを用いて$\forall i \in \varLambda_{n} \setminus \varLambda_{r}$に対し、次のようにおく。
\begin{align*}
h_{i}\begin{pmatrix}
\mathbf{y}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} = f_{i}\begin{pmatrix}
g^{*}\begin{pmatrix}
\mathbf{y}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} \\
\mathbf{x}_{*} \\
\end{pmatrix}
\end{align*}\par
そこで、うまく近傍をとることで、$\varphi\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} = \mathbf{0}$が成り立つことに注意すれば、次のようになることから、
\begin{align*}
d1_{m + i} = \sum_{j \in \varLambda_{m}} {\partial_{j}f_{i}d1_{j}}
\end{align*}
複素数の族$\left\{ c_{i} \right\}_{i \in \varLambda_{m}}$を用いて、$\sum_{i \in \varLambda_{r}} {c_{i}d1_{m + i}} + \sum_{i \in \varLambda_{m - r}} {c_{r + i}d1_{r + i}} = 0$が成り立つなら、次のようになる。
\begin{align*}
0&= \sum_{i \in \varLambda_{r}} {c_{i}d1_{m + i}} + \sum_{i \in \varLambda_{m - r}} {c_{r + i}d1_{r + i}} \\
&= \sum_{i \in \varLambda_{r}} {\sum_{j \in \varLambda_{m}} {c_{i}\partial_{j}f_{i}d1_{j}}} + \sum_{i \in \varLambda_{m - r}} {c_{r + i}d1_{r + i}} \\
&= \sum_{j \in \varLambda_{r}} {\sum_{i \in \varLambda_{r}} {c_{i}\partial_{j}f_{i}}d1_{j}} + \sum_{j \in \varLambda_{m} \setminus \varLambda_{r}} {\sum_{i \in \varLambda_{r}} {c_{i}\partial_{j}f_{i}}d1_{j}} + \sum_{i \in \varLambda_{m - r}} {c_{r + i}d1_{r + i}} \\
&= \sum_{j \in \varLambda_{r}} {\sum_{i \in \varLambda_{r}} {c_{i}\partial_{j}f_{i}}d1_{j}} + \sum_{j \in \varLambda_{m} \setminus \varLambda_{r}} {\left( \sum_{i \in \varLambda_{r}} {c_{i}\partial_{j}f_{i}} + c_{j} \right)d1_{j}} 
\end{align*}
そこで、$i \in \varLambda_{n}$なる1次形式たち$d1_{i}$は線形独立で\footnote{これについては次のようにして示される。\par
$\forall \mathbf{a} \in U$に対し、次式が成り立つとしよう。
\begin{align*}
\sum_{i\in \varLambda_n } c_i \left(d1_i \right)_{\mathbf{a} } =0
\end{align*}
このとき、$\forall i'\in \varLambda_n $に対し、$\mathbf{e}_{i'} =\left( \delta_{ii'} \right)_{i\in \varLambda_{m+r}} $としEinstein縮約記法を用いれば、$i\in \varLambda_n $、$j\in \varLambda_{m+r} $、$j^* \in \varLambda_{n} $、$j_* \in \varLambda_{m+r} \setminus \varLambda_{n} $として次のようになる。
\begin{align*}
0&= \sum_{i\in \varLambda_n } c_i \left(d1_i \right)_{\mathbf{a} } \left( \mathbf{e}_{i'} \right) \\
&= c_i \left(d1_i \right)_{\mathbf{a} } \left( \mathbf{e}_{i'} \right) \\
&= c_i \partial_j 1_i \left( \mathbf{a} \right) \delta_{i'j} \\
&= c_i \partial_{j^*} 1_i \left( \mathbf{a} \right) \delta_{i'j^*} + c_i \partial_{j_*} 1_i \left( \mathbf{a} \right) \delta_{i'j_*} \\
&= c_i \partial_{j^*} 1_i \left( \mathbf{a} \right) \delta_{i'j^*} \\
&= c_{i'} 
\end{align*}
ゆえに、$i \in \varLambda_{n}$なる1次形式たち$d1_{i}$は線形独立である。}、$\forall j \in \varLambda_{r}$に対し、$\sum_{i \in \varLambda_{r}} {c_{i}\partial_{j}f_{i}} = 0$が成り立つかつ、$\forall j \in \varLambda_{m} \setminus \varLambda_{r}$に対し、$\sum_{i \in \varLambda_{r}} {c_{i}\partial_{j}f_{i}} + c_{j} = 0$が成り立つので、次のようになる。
\begin{align*}
\begin{pmatrix}
\partial_{1}f_{1} & \partial_{1}f_{2} & \cdots & \partial_{1}f_{r} & 0 & \  & \  & O \\
\partial_{2}f_{1} & \partial_{2}f_{2} & \cdots & \partial_{2}f_{r} & \  & 0 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{r}f_{1} & \partial_{r}f_{2} & \cdots & \partial_{r}f_{r} & O & \  & \  & 0 \\
\partial_{r + 1}f_{1} & \partial_{r + 1}f_{2} & \cdots & \partial_{r + 1}f_{r} & 1 & \  & \  & O \\
\partial_{r + 2}f_{1} & \partial_{r + 2}f_{2} & \cdots & \partial_{r + 2}f_{r} & \  & 1 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{m}f_{1} & \partial_{m}f_{2} & \cdots & \partial_{m}f_{r} & O & \  & \  & 1 \\
\end{pmatrix}\begin{pmatrix}
c_{1} \\
c_{2} \\
 \vdots \\
c_{r} \\
c_{r + 1} \\
c_{r + 2} \\
 \vdots \\
c_{m} \\
\end{pmatrix} = \begin{pmatrix}
0 \\
0 \\
 \vdots \\
0 \\
0 \\
0 \\
 \vdots \\
0 \\
\end{pmatrix}
\end{align*}
そこで、仮定よりその近傍$V$では$\mathrm{rank}J_{f} = r$が成り立つので、その近傍$V$でその行列$J_{f}$の最初の$r$つの行vectorたちが線形独立としてもよい。このとき、残りの行vectorたちは先ほどの$r$つのそれらの行vectorたちの線形結合となっている。したがって、$\forall i \in \varLambda_{m} \setminus \varLambda_{r}$に対し、次のようにおかれる。ただし、係数たち$k_{ij}$は$\mathbf{x}$の関数となっている。
\begin{align*}
\begin{pmatrix}
  \partial_{i}f_{1} \\
  \partial_{i}f_{2} \\
   \vdots \\
  \partial_{i}f_{n} \\
\end{pmatrix} = k_{i1} \begin{pmatrix}
  \partial_{j}f_{1} \\
  \partial_{j}f_{2} \\
   \vdots \\
  \partial_{j}f_{n} \\
\end{pmatrix} + k_{i2} \begin{pmatrix}
  \partial_{j}f_{1} \\
  \partial_{j}f_{2} \\
   \vdots \\
  \partial_{j}f_{n} \\
\end{pmatrix} + \cdots + k_{ir} \begin{pmatrix}
  \partial_{j}f_{1} \\
  \partial_{j}f_{2} \\
   \vdots \\
  \partial_{j}f_{n} \\
\end{pmatrix}
\end{align*}
特に、次式が成り立つ。
\begin{align*}
\begin{pmatrix}
  \partial_{i}f_{1} \\
  \partial_{i}f_{2} \\
   \vdots \\
  \partial_{i}f_{r} \\
\end{pmatrix} = k_{i1} \begin{pmatrix}
  \partial_{j}f_{1} \\
  \partial_{j}f_{2} \\
   \vdots \\
  \partial_{j}f_{r} \\
\end{pmatrix} + k_{i2} \begin{pmatrix}
  \partial_{j}f_{1} \\
  \partial_{j}f_{2} \\
   \vdots \\
  \partial_{j}f_{r} \\
\end{pmatrix} + \cdots + k_{ir} \begin{pmatrix}
  \partial_{j}f_{1} \\
  \partial_{j}f_{2} \\
   \vdots \\
  \partial_{j}f_{r} \\
\end{pmatrix}
\end{align*}
これにより、次の行列式は掃き出し法によって次のようになるので、
\begin{align*}
\left| \begin{matrix}
\partial_{1}f_{1} & \partial_{1}f_{2} & \cdots & \partial_{1}f_{r} & 0 & \  & \  & O \\
\partial_{2}f_{1} & \partial_{2}f_{2} & \cdots & \partial_{2}f_{r} & \  & 0 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{r}f_{1} & \partial_{r}f_{2} & \cdots & \partial_{r}f_{r} & O & \  & \  & 0 \\
\partial_{r + 1}f_{1} & \partial_{r + 1}f_{2} & \cdots & \partial_{r + 1}f_{r} & 1 & \  & \  & O \\
\partial_{r + 2}f_{1} & \partial_{r + 2}f_{2} & \cdots & \partial_{r + 2}f_{r} & \  & 1 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{m}f_{1} & \partial_{m}f_{2} & \cdots & \partial_{m}f_{r} & O & \  & \  & 1 \\
\end{matrix} \right| &= \left| \begin{matrix}
\partial_{1}f_{1} & \partial_{1}f_{2} & \cdots & \partial_{1}f_{r} & 0 & \  & \  & O \\
\partial_{2}f_{1} & \partial_{2}f_{2} & \cdots & \partial_{2}f_{r} & \  & 0 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{r}f_{1} & \partial_{r}f_{2} & \cdots & \partial_{r}f_{r} & O & \  & \  & 0 \\
0 & \  & \  & O & 1 & \  & \  & O \\
\  & 0 & \  & \  & \  & 1 & \  & \  \\
\  & \  & \ddots & \  & \  & \  & \ddots & \  \\
O & \  & \  & 0 & O & \  & \  & 1 \\
\end{matrix} \right| \\
&= \left| \begin{matrix}
\partial_{1}f_{1} & \partial_{1}f_{2} & \cdots & \partial_{1}f_{r} \\
\partial_{2}f_{1} & \partial_{2}f_{2} & \cdots & \partial_{2}f_{r} \\
 \vdots & \vdots & \ddots & \vdots \\
\partial_{r}f_{1} & \partial_{r}f_{2} & \cdots & \partial_{r}f_{r} \\
\end{matrix} \right| \neq 0
\end{align*}
その行列
\begin{align*}
\begin{pmatrix}
\partial_{1}f_{1} & \partial_{1}f_{2} & \cdots & \partial_{1}f_{r} & 0 & \  & \  & O \\
\partial_{2}f_{1} & \partial_{2}f_{2} & \cdots & \partial_{2}f_{r} & \  & 0 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{r}f_{1} & \partial_{r}f_{2} & \cdots & \partial_{r}f_{r} & O & \  & \  & 0 \\
\partial_{r + 1}f_{1} & \partial_{r + 1}f_{2} & \cdots & \partial_{r + 1}f_{r} & 1 & \  & \  & O \\
\partial_{r + 2}f_{1} & \partial_{r + 2}f_{2} & \cdots & \partial_{r + 2}f_{r} & \  & 1 & \  & \  \\
 \vdots & \vdots & \ddots & \vdots & \  & \  & \ddots & \  \\
\partial_{m}f_{1} & \partial_{m}f_{2} & \cdots & \partial_{m}f_{r} & O & \  & \  & 1 \\
\end{pmatrix}
\end{align*}
は正則行列である、即ち、この行列を係数行列とする連立方程式は自明な解しかもたないので、次式が成り立つ。
\begin{align*}
\begin{pmatrix}
c_{1} \\
c_{2} \\
 \vdots \\
c_{r} \\
c_{r + 1} \\
c_{r + 2} \\
 \vdots \\
c_{m} \\
\end{pmatrix} = \begin{pmatrix}
0 \\
0 \\
 \vdots \\
0 \\
0 \\
0 \\
 \vdots \\
0 \\
\end{pmatrix}
\end{align*}
ゆえに、$i \in \varLambda_{m}$なる1次形式たち$d1_{i}$は線形独立となる。\par
一方で、$\forall i \in \varLambda_{n} \setminus \varLambda_{r}$に対し、次式が成り立つので、
\begin{align*}
h_{i}\begin{pmatrix}
\mathbf{y}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} = f_{i}\begin{pmatrix}
g^{*}\begin{pmatrix}
\mathbf{y}^{*} \\
\mathbf{x}_{*} \\
\end{pmatrix} \\
\mathbf{x}_{*} \\
\end{pmatrix}
\end{align*}
次のようになる。
\begin{align*}
df_{i} = \sum_{j \in \varLambda_{r}} {\partial_{j}h_{i}d1_{m + j}} + \sum_{j \in \varLambda_{m} \setminus \varLambda_{r}} {\partial_{j}h_{i}d1_{j}}
\end{align*}
ここで、$\psi = \begin{pmatrix}
f^{*} \\
\widetilde{1}_{*} \\
\end{pmatrix}$、$\widetilde{1}_{*}:U \rightarrow \mathbb{R}^{m - r};\mathbf{x} \mapsto \mathbf{x}_* $、$\mathbf{x} = \left( x_{i} \right)_{i \in \varLambda_{m}}$とおかれると、$\varphi\begin{pmatrix}
\mathbf{x} \\
\mathbf{y} \\
\end{pmatrix} = \mathbf{0}$が成り立つことに注意すれば、その近傍$V$上で次式が成り立ち、
\begin{align*}
\det J_{\psi} &= \det {}^t \left( \begin{pmatrix} \nabla^* \\ \nabla_* \end{pmatrix} {}^t \psi \right) \\
&= \det {}^t \left( \begin{pmatrix} \nabla^* \\ \nabla_* \end{pmatrix} \begin{pmatrix} {}^t f^* & {}^t \widetilde{1}_* \end{pmatrix} \right) \\
&= \left| \begin{matrix}
{}^t \left( \nabla^* {}^t f^* \right) & {}^t \left( \nabla_* {}^t f^* \right) \\
{}^t \left( \nabla^* {}^t \widetilde{1}_* \right) & {}^t \left( \nabla_* {}^t \widetilde{1}_* \right) \\
\end{matrix}\right| \\
&= \left| \begin{matrix}
{}^t \left( \nabla^* {}^t f^* \right) & {}^t \left( \nabla_* {}^t f^* \right) \\
O & I_{m - r} \\
\end{matrix}\right| \\
&= \det{{}^{t}\left( \nabla^{*}{}^{t}f^{*} \right)} \neq 0
\end{align*}
$\mathbf{a} \in V$が成り立つので、もちろん、$\det{J_{\psi}\left( \mathbf{a} \right)} \neq 0$が成り立つ、即ち、$\mathrm{rank}{J_{\psi}\left( \mathbf{a} \right)} = m$が成り立つので、定理\ref{4.4.2.10}より$i \in \varLambda_{r}$なる関数たち$f_{i}$はその集合$U$上で函数関係の意味で独立である。\par
上記の議論により、$i \in \varLambda_{r}$なる関数たち$f_{i}$と$i \in \varLambda_{m} \setminus \varLambda_{r}$なる変数たち$x_{i}$は線形独立でもある。したがって、次式の係数を比較することができるので、そうすると、
\begin{align*}
df_{i} = \sum_{j \in \varLambda_{r}} {c_{ij}d1_{m + j}} = \sum_{j \in \varLambda_{r}} {\partial_{j}h_{i}d1_{m + j}} + \sum_{j \in \varLambda_{m} \setminus \varLambda_{r}} {\partial_{j}h_{i}d1_{j}}
\end{align*}
$\forall i \in \varLambda_{n} \setminus \varLambda_{r}\forall j \in \varLambda_{m} \setminus \varLambda_{r}$に対し、$\partial_{j}h_{i} = 0$が成り立つ。したがって、$i \in \varLambda_{n} \setminus \varLambda_{r}$なる関数たち$h_{i}$は$i \in \varLambda_{r}$なる変数たち$y_{i}$だけによる。したがって、次式が成り立つことにより、
\begin{align*}
f_{i} = h_{i}\begin{pmatrix}
\mathbf{y}^{*} \\
* \\
\end{pmatrix} = h_{i}\begin{pmatrix}
f^{*} \\
* \\
\end{pmatrix}
\end{align*}
その点$\mathbf{a}$のある近傍$W$上で、$i \in \varLambda_{n} \setminus \varLambda_{r}$なる関数たち$f_{i}$は$i \in \varLambda_{r}$なる関数たち$f_{i}$の関数として表される。\par
さらに、次式のように関数$F$が定義されれば、
\begin{align*}
F:\mathrm{int}{V\left( f|W \right)} \rightarrow \mathbb{R};\mathbf{y} = \left( y_{i} \right)_{i \in \varLambda_{n}} \mapsto \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} \left( h_{i}\begin{pmatrix}
\mathbf{y}^{*} \\
* \\
\end{pmatrix} - y_{i} \right)
\end{align*}
その関数$F$の定義域の任意の部分集合に制限されても$F \neq 0$が成り立つかつ、その開集合$W$で次式が成り立つ。
\begin{align*}
F \circ f = \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} \left( h_{i}\begin{pmatrix}
f^{*} \\
* \\
\end{pmatrix} - f_{i} \right) = \sum_{i \in \varLambda_{n} \setminus \varLambda_{r}} \left( f_{i} - f_{i} \right) = 0
\end{align*}
よって、$i \in \varLambda_{n}$なる関数たち$f_{i}$にその近傍$V$上で$C^{1}$級函数関係がある。
\end{proof}
\begin{thebibliography}{50}
  \bibitem{1}
  杉浦光夫, 解析入門II, 東京大学出版社, 1985. 第22刷 p16-30 ISBN978-4-13-062006-2
\end{thebibliography}
\end{document}